cat << EOF
===== [U-32] Prevent end-user Sendmail execution              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-32 ì¼ë°˜ì‚¬ìš©ìžì˜ Sendmail ì‹¤í–‰ ë°©ì§€              " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : ì¼ë°˜ì‚¬ìš©ìžì˜ q ì˜µì…˜ì„ ì œí•œí•˜ì—¬ Sendmail ì„¤ì • ë° ë©”ì¼íë¥¼ ê°•ì œì ìœ¼ë¡œ drop ì‹œí‚¬ ìˆ˜ ì—†ê²Œ í•˜ì—¬ ë¹„ì¸ê°€ìžì— ì˜í•œ SMTP ì„œë¹„ìŠ¤ ì˜¤ë¥˜ ë°©ì§€" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : ì¼ë°˜ ì‚¬ìš©ìžê°€ q ì˜µì…˜ì„ ì´ìš©í•´ì„œ ë©”ì¼í, Sendmail ì„¤ì •ì„ ë³´ê±°ë‚˜ ë©”ì¼íë¥¼ ê°•ì œì ìœ¼ë¡œ drop ì‹œí‚¬ ìˆ˜ ìžˆì–´ ì•…ì˜ì ìœ¼ë¡œ SMTP ì„œë²„ì˜ ì˜¤ë¥˜ë¥¼ ë°œìƒì‹œí‚¬ ìˆ˜ ìžˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜: SMTP ì„œë¹„ìŠ¤ ë¯¸ì‚¬ìš© ë˜ëŠ”, ì¼ë°˜ ì‚¬ìš©ìžì˜ Sendmail ì‹¤í–‰ ë°©ì§€ê°€ ì„¤ì •ëœ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: SMTP ì„œë¹„ìŠ¤ ì‚¬ìš© ë° ì¼ë°˜ ì‚¬ìš©ìžì˜ Sendmail ì‹¤í–‰ ë°©ì§€ê°€ ì„¤ì •ë˜ì–´ ìžˆì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
u32=0
u32_Service_Management=0
u32_safe_check=0
u32_service=("sendmail" "postfix" "exim" "sendmail.service" "postfix.service" "exim.service")
u32_ports=("25" "465" "587")

check_service_status "${u32_ports}" "${u32_service[@]}"
if [[ $? -eq 1 ]]; then
    echo "sendmail ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìžˆìŠµë‹ˆë‹¤." >> $target
    u32_sendmail_conf=$(grep -vE "^\s*#" "/etc/mail/sendmail.cf" | grep -i "PrivacyOptions")
    if grep -vE "^\s*#" "/etc/mail/sendmail.cf" | grep -i "PrivacyOptions" | grep -qi "restrictqrun";then
        echo "ë©”ì¼ í(queue)ì— ëŒ€í•œ ì¼ë°˜ ì‚¬ìš©ìžì˜ ì ‘ê·¼ì„ ì œí•œí•˜ê³  ìžˆìŠµë‹ˆë‹¤." >> $target
        echo "í˜„ìž¬ ì„¤ì •ëœ ê°’ : $u32_sendmail_conf" >> $target
    else
        echo "ë©”ì¼ í(queue)ì— ëŒ€í•œ ì¼ë°˜ ì‚¬ìš©ìžì˜ ì ‘ê·¼ì„ ì œí•œí•˜ê³  ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        echo "í˜„ìž¬ ì„¤ì •ëœ ê°’ : $u32_sendmail_conf" >> $target
        u32_safe_check=$((u32_safe_check+1))
    fi
    u32_safe_check=$((u32_safe_check+1))
else
    echo "sendmail ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    u32_sendmail_conf=$(grep -vE "^\s*#" "/etc/mail/sendmail.cf" | grep -i "PrivacyOptions")
    if grep -vE "^\s*#" "/etc/mail/sendmail.cf" | grep -i "PrivacyOptions" | grep -qi "restrictqrun";then
        echo "ë©”ì¼ í(queue)ì— ëŒ€í•œ ì¼ë°˜ ì‚¬ìš©ìžì˜ ì ‘ê·¼ì„ ì œí•œí•˜ê³  ìžˆìŠµë‹ˆë‹¤." >> $target
        echo "í˜„ìž¬ ì„¤ì •ëœ ê°’ : $u32_sendmail_conf" >> $target
    else
        echo "ë©”ì¼ í(queue)ì— ëŒ€í•œ ì¼ë°˜ ì‚¬ìš©ìžì˜ ì ‘ê·¼ì„ ì œí•œí•˜ê³  ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        echo "í˜„ìž¬ ì„¤ì •ëœ ê°’ : $u32_sendmail_conf" >> $target
        u32_safe_check=$((u32_safe_check+1))
    fi
fi

if [[ $u32_safe_check -ge 1 ]];then
    u32=$((u32+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u32 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u32_Service_Management=1
fi