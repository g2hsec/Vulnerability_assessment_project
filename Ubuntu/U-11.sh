cat << EOF
===== [U-11] /etc/syslog.conf file owner and permission settings               =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-11   /etc/syslog.conf íŒŒì¼ ì†Œìœ ìž ë° ê¶Œí•œ ì„¤ì •                        " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : /etc/syslog.conf íŒŒì¼ì˜ ê¶Œí•œ ì ì ˆì„±ì„ ì ê²€í•˜ì—¬, ê´€ë¦¬ìž ì™¸ ë¹„ì¸ê°€ìžì˜ ìž„ì˜ì ì¸ syslog.conf íŒŒì¼ ë³€ì¡°ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : syslog.conf íŒŒì¼ì˜ ì„¤ì •ë‚´ìš©ì„ ì°¸ì¡°í•˜ì—¬ ë¡œê·¸ì˜ ì €ìž¥ìœ„ì¹˜ê°€ ë…¸ì¶œë˜ë©° ë¡œê·¸ì„ ê¸°ë¡í•˜ì§€ ì•Šë„ë¡ ì„¤ì •í•˜ê±°ë‚˜ ëŒ€ëŸ‰ì˜ ë¡œê·¸ë¥¼ ê¸°ë¡í•˜ê²Œ í•˜ì—¬ ì‹œìŠ¤í…œ ê³¼ë¶€í•˜ë¥¼ ìœ ë„í•  ìˆ˜ ìžˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜: /etc/syslog.conf íŒŒì¼ì˜ ì†Œìœ ìžê°€ root(ë˜ëŠ” bin, sys)ì´ê³ , ê¶Œí•œì´ 640 ì´í•˜ì¸ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: /etc/syslog.conf íŒŒì¼ì˜ ì†Œìœ ìžê°€ root(ë˜ëŠ” bin, sys)ê°€ ì•„ë‹ˆê±°ë‚˜, ê¶Œí•œì´ 640 ì´í•˜ê°€ ì•„ë‹Œ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-11 ì ê²€ ê²°ê³¼" >> $result
# CentOS7 ì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ rsyslogê°€ ê¸°ë³¸ ë¡œê·¸ ì‹œìŠ¤í…œìœ¼ë¡œ ì‚¬ìš©ë¨
u11=0
u11_syslog_files=("/etc/syslog.conf" "/etc/rsyslog.conf")
u11_Files_Directory_Management=0
u11_safe_check=0

for u11_syslog_file in "${u11_syslog_files[@]}";do
    echo "$u11_syslog_file Checking..." >> $target
    if [[ -e "$u11_syslog_file" ]];then
        echo "$u11_syslog_file íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤." >> $target
        u11_file_owner_user=$(stat -c "%U" "$u11_syslog_file" 2> /dev/null)
        u11_file_owner=$(stat -c "%a" "$u11_syslog_file"  2> /dev/null| cut -c1)
        u11_file_group=$(stat -c "%a" "$u11_syslog_file"  2> /dev/null| cut -c2)
        u11_file_other=$(stat -c "%a" "$u11_syslog_file"  2> /dev/null| cut -c3)
        u11_check_suid=$(stat -c "%a" "$u11_syslog_file"  2> /dev/null| tr -d '\n' | wc -c)
        if [[ $u11_check_suid -ge 4 ]];then
            echo "$u11_file íŒŒì¼ì— SUID ê°€ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤. [ìž˜ëª»ëœ SUID ì„¤ì •]" >> $target
            u11_safe_check=$((u11_safe_check+1))
        else
            if [[ $u11_file_owner_user == "root" || $u11_file_owner_user == "bin" || $u11_file_owner_user == "sys" ]];then
                echo "$syslog_file íŒŒì¼ì˜ ì†Œìœ ìžê°€ root, bin, sysë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                if [ $u11_file_owner -le 6 ];then
                    echo "$u11_syslog_file íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                    if [ $u11_file_group -le 4 ];then
                        echo "$u11_syslog_file íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 4ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                        if [ $u11_file_other -eq 0 ];then
                            echo "$u11_syslog_file íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ìž(Other) ê¶Œí•œì´ 0ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                        else
                            echo "$u11_syslog_file íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ìž(Other) ê¶Œí•œì´ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                            u11_safe_check=$((u11_safe_check+1))
                        fi
                    else
                        echo "$u11_syslog_file íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 4ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                        u11_safe_check=$((u11_safe_check+1))
                    fi
                else
                    echo "$u11_syslog_file íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                    u11_safe_check=$((u11_safe_check+1)) 
                fi
            else
                echo "$u11_syslog_file íŒŒì¼ì˜ ì†Œìœ ìžê°€ root, bin, sysê°€ ì•„ë‹Œ ë‹¤ë¥¸ ì‚¬ìš©ìžë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                u11_safe_check=$((u11_safe_check+1))
            fi 
        fi
    else
        echo "$u11_syslog_file íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        u11=$((u11+1))
    fi
done


if [[ $u11_safe_check -ge 1 ]];then
    u11=$((u11+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u11 -ge 1 ]];then
    High=$((High+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u11_Files_Directory_Management=1
fi