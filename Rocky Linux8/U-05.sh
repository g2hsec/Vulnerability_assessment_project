
cat << EOF
===== [U-05] root home, pass directory permissions, and pass settings               =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-05  rootí™ˆ, íŒ¨ìŠ¤ ë””ë ‰í„°ë¦¬ ê¶Œí•œ ë° íŒ¨ìŠ¤ ì„¤ì •                        " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ë¹„ì¸ê°€ìžê°€ ë¶ˆë²•ì ìœ¼ë¡œ ìƒì„±í•œ ë””ë ‰í„°ë¦¬ ë° ëª…ë ¹ì–´ë¥¼ ìš°ì„ ìœ¼ë¡œ ì‹¤í–‰ë˜ì§€ ì•Šë„ë¡ ì„¤ì •í•˜ê¸° ìœ„í•´ í™˜ê²½ë³€ìˆ˜ ì ê²€ì´ í•„ìš”í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : root ê³„ì •ì˜ PATH(í™˜ê²½ë³€ìˆ˜)ì— ì •ìƒì ì¸ ê´€ë¦¬ìž ëª…ë ¹ì–´(ì˜ˆ: ls, mv, cpë“±)ì˜ ë””ë ‰í„°ë¦¬ ê²½ë¡œ ë³´ë‹¤ í˜„ìž¬ ë””ë ‰í„°ë¦¬ë¥¼ ì§€ì¹­í•˜ëŠ” â€œ.â€ í‘œì‹œê°€ ìš°ì„ í•˜ë©´ í˜„ìž¬ ë””ë ‰í„°ë¦¬ì— ë³€ì¡°ëœ ëª…ë ¹ì–´ë¥¼ ì‚½ìž…í•˜ì—¬ ê´€ë¦¬ìž ëª…ë ¹ì–´ ìž…ë ¥ ì‹œ ì•…ì˜ì ì¸ ê¸°ëŠ¥ì´ ì‹¤í–‰ ë  ìˆ˜ ìžˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜: PATH í™˜ê²½ë³€ìˆ˜ì— â€œ.â€ ì´ ë§¨ ì•žì´ë‚˜ ì¤‘ê°„ì— í¬í•¨ë˜ì§€ ì•Šì€ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: PATH í™˜ê²½ë³€ìˆ˜ì— â€œ.â€ ì´ ë§¨ ì•žì´ë‚˜ ì¤‘ê°„ì— í¬í•¨ë˜ì–´ ìžˆëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-5 ì ê²€ ê²°ê³¼" >> $result
u5=0
u5_safe_check=0
u5_Account_Management=0

u5_etc_configure_files=(
    "/etc/profile"
    "/etc/.login"
    "/etc/bashrc"
)

u5_home_configure_files=(
    ".profile"
    ".cshrc"
    ".login"
    "kshrc"
    ".bash_profile"
)

if [[ $PATH =~ (^|:)(\.|::)(:|$) ]]; then 
    echo "PATH í™˜ê²½ë³€ìˆ˜ì— . ë° :: ë¬¸ìžê°€ PATH ë³€ìˆ˜ì˜ ë§¨ ì•ž í˜¹ì€ ì¤‘ê°„ì— ìœ„ì¹˜í•˜ê³  ìžˆìŠµë‹ˆë‹¤. í•´ë‹¹ ë¬¸ìžë¥¼ ë§¨ ë§ˆì§€ë§‰ìœ¼ë¡œ ì´ë™í•˜ì‹­ì‹œì˜¤." >> $target
    u5_safe_check=$((u5_safe_check+1))
    u5_Account_Management=$((u5_Account_Management+1))
else
    echo "PATH í™˜ê²½ë³€ìˆ˜ì— . ë° :: ë¬¸ìžê°€ ì˜¬ë°”ë¥¸ ìœ„ì¹˜ì— ì¡´ìž¬í•©ë‹ˆë‹¤." >> $target
fi


for u5_etc_configure_file in "${u5_etc_configure_files[@]}"; do
    echo -e "${RED}Checking file: $u5_etc_configure_file${NC}" >> $target
    if [ -e "$u5_etc_configure_file" ]; then
        # íŒŒì¼ì´ ì¡´ìž¬í•˜ë©´ ê¶Œí•œì„ í™•ì¸í•˜ëŠ” êµ¬ë¬¸ ì¶”ê°€í•˜ê¸°
        #ls -l "$etc_configure_file"
        if grep -qiE "^#\s*PATH\s*=" "$u5_etc_configure_file"; then  
            echo "PATH ì„¤ì • êµ¬ë¬¸ì´ ì£¼ì„ì²˜ë¦¬ë˜ì–´ ë¹„í™œì„±í™” ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
            echo "--------------------------------------" >> $target
        else
            if grep -qiE "^\s*PATH\s*=" "$u5_etc_configure_file"; then
                grep -iE "^\s*PATH\s*=" "$u5_etc_configure_file" | while read -r line ; do
                    echo "PATH setting found: $u5_line" >> $target
                    # PATH ì„¤ì •ì—ì„œ . ë˜ëŠ” :: ë¬¸ìžê°€ ë§¨ ì•žì´ë‚˜ ì¤‘ê°„ì— í¬í•¨ë˜ì–´ ìžˆëŠ”ì§€ í™•ì¸
                    if echo "$u5_line" | grep -iqE "(^|:)(\.|::)(:|$)"; then
                        echo "PATH ì„¤ì • ê°’ì— â€œ.â€, â€œ::â€ì´ ë§¨ ì•ž í˜¹ì€ ì¤‘ê°„ì— ìœ„ì¹˜í•˜ê³  ìžˆìŠµë‹ˆë‹¤.- ì·¨ì•½" >> $target
                        echo "--------------------------------------" >> $target
                        u5_safe_check=$((u5_safe_check+1))
                        u5_Account_Management=$((u5_Account_Management+1))
                    else
                        echo "PATH ê´€ë ¨ ì„¤ì •ì´ ì•ˆì „í•˜ê²Œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                        echo "--------------------------------------" >> $target
                    fi
                done
            else
                echo "PATH ê´€ë ¨ ì„¤ì •ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                echo "--------------------------------------" >> $target
            fi
        fi

        #if 

        #fi
    else
        # íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•Šìœ¼ë©´ ë©”ì‹œì§€ ì¶œë ¥
        echo "$u5_configure_file íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.." >> $target
        echo "--------------------------------------" >> $target
    fi
done

u5_check_users=($(cat /etc/passwd | egrep -v '/sbin|sync|false' | awk -F':' '{print $1}'))
for u5_check_user in "${u5_check_users[@]}";do
    u5_user_home=($(getent passwd "$u5_check_user" | awk -F':' '{print$6}'))
    if [ -d "$u5_user_home" ];then
        echo "--------------------------------------" >> $target
        echo "$u5_check_user ì˜ í™ˆ ë””ë ‰í„°ë¦¬ê°€ ì¡´ìž¬í•©ë‹ˆë‹¤." >> $target
        for u5_home_configure_file in "${u5_home_configure_files[@]}";do
            echo -e "${RED}Checking file: $u5_user_home/$u5_home_configure_file${NC}" >> $target
            if [ -e "$u5_user_home/$u5_home_configure_file" ];then
                echo "$u5_user_home/$u5_home_configure_file íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤." >> $target

                if grep -qiE "^#\s*PATH\s*=" "$u5_user_home/$u5_home_configure_file"; then  
                    echo "PATH ì„¤ì • êµ¬ë¬¸ì´ ì£¼ì„ì²˜ë¦¬ë˜ì–´ ë¹„í™œì„±í™” ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                    echo "--------------------------------------" >> $target
                else
                    if grep -qiE "^\s*PATH\s*=" "$u5_user_home/$u5_home_configure_file"; then
                        grep -iE "^\s*PATH\s*=" "$u5_user_home/$u5_home_configure_file" | while read -r line ; do
                            echo "PATH setting found: $line" >> $target
                            # PATH ì„¤ì •ì—ì„œ . ë˜ëŠ” :: ë¬¸ìžê°€ ë§¨ ì•žì´ë‚˜ ì¤‘ê°„ì— í¬í•¨ë˜ì–´ ìžˆëŠ”ì§€ í™•ì¸
                            if echo "$u5_line" | grep -qiE "(^|:)(\.|::)(:|$)"; then
                                echo "PATH ì„¤ì • ê°’ì— â€œ.â€, â€œ::â€ì´ ë§¨ ì•ž í˜¹ì€ ì¤‘ê°„ì— ìœ„ì¹˜í•˜ê³  ìžˆìŠµë‹ˆë‹¤.- ì·¨ì•½" >> $target
                                echo "--------------------------------------" >> $target
                                u5_safe_check=$((u5_safe_check+1))
                                u5_Account_Management=$((u5_Account_Management+1))
                            else
                                echo "PATH ê´€ë ¨ ì„¤ì •ì´ ì•ˆì „í•˜ê²Œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                                echo "--------------------------------------" >> $target
                            fi
                        done
                    else
                        echo "PATH ê´€ë ¨ ì„¤ì •ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                        echo "--------------------------------------" >> $target
                    fi
                fi

            else
                echo "$u5_user_home/$u5_home_configure_file íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                echo "--------------------------------------" >> $target
            fi
        done
    else
        echo "$u5_check_user ì˜ í™ˆ ë””ë ‰í„±ë¦¬ê°€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        echo "--------------------------------------" >> $target
    fi
done


if [ $u5_safe_check -ge 1 ];then
    u5=$((u5+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u5 -ge 1 ]];then
    High=$((High+1))
    Account_Management=$((Account_Management+1))
    u5_Account_Management=1
fi