cat << EOF
===== [U-20] Disable Finger Service              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-20  Anonymous FTP ë¹„í™œì„±í™”             " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ì‹¤í–‰ì¤‘ì¸ FTP ì„œë¹„ìŠ¤ì— ìµëª… FTP ì ‘ì†ì´ í—ˆìš©ë˜ê³  ìžˆëŠ”ì§€ í™•ì¸í•˜ì—¬ ì ‘ì†í—ˆìš©ì„ ì°¨ë‹¨í•˜ëŠ” ê²ƒì„ ëª©ì ìœ¼ë¡œ í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : Anonymous FTP(ìµëª… FTP)ë¥¼ ì‚¬ìš© ì‹œ anonymous ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ í›„ ë””ë ‰í„°ë¦¬ì— ì“°ê¸° ê¶Œí•œì´ ì„¤ì •ë˜ì–´ ìžˆë‹¤ë©´ ì•…ì˜ì ì¸ ì‚¬ìš©ìžê°€ local exploitì„ ì‚¬ìš©í•˜ì—¬ ì‹œìŠ¤í…œì— ëŒ€í•œ ê³µê²©ì„ ê°€ëŠ¥í•˜ê²Œ í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜: Anonymous FTP (ìµëª… ftp) ì ‘ì†ì„ ì°¨ë‹¨í•œ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: Anonymous FTP (ìµëª… ftp) ì ‘ì†ì„ ì°¨ë‹¨í•˜ì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-20 ì ê²€ ê²°ê³¼" >> $result
u20_Service_Management=0
u20_safe_check=0
u20=0
u20_ftpusers=("ftp" "anonymous")
u20_safe_check=0
for u20_ftpuser in "${u20_ftpusers[@]}";do
    if grep -q "$u20_ftpuser" "/etc/passwd";then
        u20_shellcheck_ftp=$(cat /etc/passwd | grep "$u20_ftpuser" | awk -F':' '{print $7}' | awk -F'/' '{print $3}')
        if [[ $u20_shellcheck == "nologin" ]];then
            echo "$u20_ftpuser ê³„ì •ì´ ì¡´ìž¬í•˜ë©°, ì‰˜ ì„¤ì •ì´ nologin ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ftp ê³„ì¦ìœ¼ë¡œì˜ ë¡œê·¸ì¸ì„ ì œí•œí•˜ê³  ìžˆìŠµë‹ˆë‹¤." >> $target
        else
            echo "$u20_ftpuser ê³„ì •ì´ ì¡´ìž¬í•˜ë©°, ì‰˜ ì„¤ì •ì´ nologinì´ ì•„ë‹™ë‹ˆë‹¤. í•´ë‹¹ ê³„ì •ì— ëŒ€í•œ ì‚­ì œì¡°ì¹˜ê°€ ì´ë£¨ì–´ì ¸ì•¼ í•©ë‹ˆë‹¤." >> $target
            u20_safe_check=$((u20_safe_check+1))
        fi
    else
        echo "$u20_ftpuser ê³„ì •ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
done

u20_vsftpd_files=("/etc/vsftpd/vsftpd.conf" "/etc/vsftpd.conf")

for u20_vsftpd_file in "${u20_vsftpd_files[@]}";do
    if [ -f "$u20_vsftpd_file" ];then
        echo "$u20_vsftpd_file ì´ ì¡´ìž¬í•©ë‹ˆë‹¤." >> $target
        u20_ftpoption=$(grep "anonymous_enable" $u20_vsftpd_file | grep -v "^\s*#" | awk -F'=' '{print $2}' | tr -d ' ')
        u20_lower_vsftpd=$(echo "$u20_ftpoption" | tr '[:upper:]' '[:lower:]')
        if [[ $u20_lower_vsftpd == "no" ]];then
            echo "$u20_vsftpd_file íŒŒì¼ì— Anonymous ì„¤ì •ì´ ì ì ˆí•˜ê²Œ ë¹„í™œì„±í™” ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
        else
            echo "$u20_vsftpd_file íŒŒì¼ì— Anonymous ì„¤ì •ì´ í™œì„±í™” ë˜ì–´ ìžˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤."  >> $target
            u20_safe_check=$((u20_safe_check+1))
        fi
    else
        echo "$u20_vsftpd_file ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
done

u20_proftpd_files=("/etc/proftpd/proftpd.conf" "/etc/proftpd.conf")
for u20_proftpd_file in "${u20_proftpd_files[@]}"; do
    if [ -f "$u20_proftpd_file" ]; then
        echo "$u20_proftpd_file íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤" >> $target
        u20_proftpdoption=$(sed -n '/<Anonymous/,/<\/Anonymous>/p' "$u20_proftpd_file" | sed -n '/<Limit LOGIN/,/<\/Limit>/p' | grep -i "DenyAll")
        u20_lower_proftpd=$(echo "$u20_proftpdoption" | tr '[:upper:]' '[:lower:]')

        if sed -n '/<Anonymous/,/<\/Anonymous>/p' "$u20_proftpd_file" | grep -Eq "^\s*#"; then
            echo "Anonymous ë¸”ë¡ì´ ì£¼ì„ì²˜ë¦¬ ë˜ì–´ ìžˆì–´ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
        else
            if sed -n '/<Anonymous/,/<\/Anonymous>/p' "$u20_proftpd_file" | grep -q "<Anonymous"; then
                if [[ "$u20_lower_proftpd" == *"denyall"* ]]; then
                    echo "Anonymous ê³„ì •ì— ëŒ€í•œ ì ‘ê·¼ì„ í—ˆìš©í•˜ì§€ ì•Šê³  ìžˆì–´ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
                else
                    echo "Anonymous ê³„ì •ì— ëŒ€í•œ ì ‘ê·¼ì„ ê±°ë¶€í•˜ëŠ” ì„¤ì •ì´ ì¡´ìž¬í•˜ì§€ ì•Šì•„ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                    u20_safe_check=$((u20_safe_check+1))
                fi
            else
                echo "Anonymous ë¸”ë¡ì´ ì¡´ìž¬í•˜ì§€ ì•Šì•„ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
            fi
        fi
    else
        echo "$u20_proftpd_file íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
done

if [[ $u20_safe_check -ge 1 ]];then
    u20=$((u20+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u20 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u20_Service_Management=1
fi