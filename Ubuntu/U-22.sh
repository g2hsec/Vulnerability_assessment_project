cat << EOF
===== [U-22] Crond file owner and permission settings              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-22  crond íŒŒì¼ ì†Œìœ ìž ë° ê¶Œí•œ ì„¤ì •             " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : ê´€ë¦¬ìžì™¸ cron ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë„ë¡ ì„¤ì •í•˜ê³  ìžˆëŠ”ì§€ ì ê²€í•˜ëŠ” ê²ƒì„ ëª©ì ìœ¼ë¡œ í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : root ì™¸ ì¼ë°˜ì‚¬ìš©ìžì—ê²Œë„ crontab ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìžˆë„ë¡ í•  ê²½ìš°, ê³ ì˜ ë˜ëŠ” ì‹¤ìˆ˜ë¡œ ë¶ˆë²•ì ì¸ ì˜ˆì•½ íŒŒì¼ ì‹¤í–‰ìœ¼ë¡œ ì‹œìŠ¤í…œ í”¼í•´ë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ ìžˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜: crontab ëª…ë ¹ì–´ ì¼ë°˜ì‚¬ìš©ìž ê¸ˆì§€ ë° cron ê´€ë ¨ íŒŒì¼ 640 ì´í•˜ì¸ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: crontab ëª…ë ¹ì–´ ì¼ë°˜ì‚¬ìš©ìž ì‚¬ìš©ê°€ëŠ¥í•˜ê±°ë‚˜, crond ê´€ë ¨ íŒŒì¼ 640 ì´ìƒì¸ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-21 ì ê²€ ê²°ê³¼" >> $result
u22_cron_checkfiles=("crontab" "cron.allow" "cron.deny")
u22_cron_checkdirs=("cron.d" "cron.hourly" "cron.daily" "cron.weekly" "cron.monthly")
u22_cron_spools=("/var/spool/cron" "/var/spool/cron/crontabs")
u22=0
u22_Service_Management=0
u22_safe_check=0
# ëª…ë ¹ì–´ ì¶œë ¥ì„ ì½ì–´ ë°°ì—´ì— ì €ìž¥
u22_crontab_pass_s=($(type -a crontab | sort | uniq))
for u22_crontab_pass in "${u22_crontab_pass_s[@]}";do
    if [ -f "$u22_crontab_pass" ];then
        u22_crontab_perm=$(stat -c "%a" "$u22_crontab_pass" | cut -c1)
        u22_crontab_group=$(stat -c "%a" "$u22_crontab_pass" | cut -c2)
        u22_crontab_other=$(stat -c "%A" "$u22_crontab_pass" | awk '{print substr($1, 8, 3)}')
        u22_crontab_owner=$(stat -c "%U" "$u22_crontab_pass")
        if [[ $u22_crontab_perm -lt 6 && $u22_crontab_group -lt 4 ]];then
            if [[ $u22_crontab_other == "---" ]];then
                if [[ $u22_crontab_owner == "root" ]];then
                    echo "$u22_crontab_pass íŒŒì¼ì— ëŒ€í•œ ì†Œìœ ìž ë° ê¶Œí•œ ì„¤ì •ì´ ì ì ˆí•˜ê²Œ ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                else
                    echo "$u22_crontab_pass íŒŒì¼ì— ëŒ€í•œ 3.5 DoS ê³µê²©ì— ì·¨ì•½í•œ ì„œë¹„ìŠ¤ ë¹„í™œì„±í™”ìœ ìžê°€ root ì†Œìœ ìžê°€ ì•„ë‹Œ $u22_crontab_owenrë¡œ ì„¤ì •ë˜ì–´ ìžˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                    u22_safe_check=$((u22_safe_check+1))
                fi
            else
                echo "$u22_crontab_pass íŒŒì¼ì— ëŒ€í•œ ê¸°íƒ€ ì‚¬ìš©ìž(Other)ì— ëŒ€í•œ ê¶Œí•œì´ $u22_crontab_other ì„¤ì •ë˜ì–´ ìžˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                u22_safe_check=$((u22_safe_check+1))
            fi
        else
            echo "$u22_crontab_pass íŒŒì¼ì˜ ê¶Œí•œì´ $u22_crontab_perm ìœ¼ë¡œ 640 ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìœ¼ë©° ê¸°íƒ€ ì‚¬ìš©ìž(Other)ì— ëŒ€í•œ ê¶Œí•œì´ ì„¤ì •ë˜ì–´ ìžˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
            u22_safe_check=$((u22_safe_check+1))
        fi
    fi
done
for u22_cron_checkfile in "${u22_cron_checkfiles[@]}";do
    if [ -f "/etc/$u22_cron_checkfile" ];then
        u22_crontab_file_perm=$(stat -c "%a" "/etc/$u22_cron_checkfile" | cut -c1)
        u22_crontab_file_group=$(stat -c "%a" "/etc/$u22_cron_checkfile" | cut -c2)
        u22_crontab_file_other=$(stat -c "%A" "/etc/$u22_cron_checkfile" | awk '{print substr($1, 8, 3)}')
        u22_crontab_file_owner=$(stat -c "%U" "/etc/$u22_cron_checkfile")
        if [[ $u22_crontab_file_perm -lt 6 && $u22_crontab_file_group -lt 4 ]];then
            if [[ $u22_crontab_file_other == "---" ]];then
                if [[ $u22_crontab_file_owner == "root" ]];then
                    echo "/etc/$u22_cron_checkfile íŒŒì¼ì— ëŒ€í•œ ì†Œìœ ìž ë° ê¶Œí•œ ì„¤ì •ì´ ì ì ˆí•˜ê²Œ ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                else
                    echo "/etc/$u22_cron_checkfile íŒŒì¼ì— ëŒ€í•œ ì†Œìœ ìžê°€ root ì†Œìœ ìžê°€ ì•„ë‹Œ $u22_crontab_file_perm ì„¤ì •ë˜ì–´ ìžˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                    u22_safe_check=$((u22_safe_check+1))
                fi
            else
                echo "/etc/$u22_cron_checkfile íŒŒì¼ì— ëŒ€í•œ ê¸°íƒ€ ì‚¬ìš©ìž(Other)ì— ëŒ€í•œ ê¶Œí•œì´ $u22_crontab_file_other ì„¤ì •ë˜ì–´ ìžˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                u22_safe_check=$((u22_safe_check+1))
            fi
        else
            echo "/etc/$u22_cron_checkfile íŒŒì¼ì˜ ê¶Œí•œì´ $u22_crontab_file_perm ìœ¼ë¡œ 640 ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìœ¼ë©° ê¸°íƒ€ ì‚¬ìš©ìž(Other)ì— ëŒ€í•œ ê¶Œí•œì´ ì„¤ì •ë˜ì–´ ìžˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
            u22_safe_check=$((u22_safe_check+1))
        fi
    else
        echo "/etc/$u22_cron_checkfile íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
done
for u22_cron_checkdir in "${u22_cron_checkdirs[@]}";do
    if [ -d "/etc/$u22_cron_checkdir" ];then
        u22_cron_dirinfiles=($(ls -al "/etc/$u22_cron_checkdir" | awk '{print $9}' | grep -v "^\." | sed '1d'))
        if [ -n "$u22_cron_dirinfiles" ];then
            for u22_cron_dirinfile in "${u22_cron_dirinfiles[@]}";do
                if [ -f "/etc/$u22_cron_checkdir/$u22_cron_dirinfile" ];then
                    u22_crontab_dirf_perm=$(stat -c "%a" "/etc/$u22_cron_checkdir/$u22_cron_dirinfile" | cut -c1)
                    u22_crontab_dirf_group=$(stat -c "%a" "/etc/$u22_cron_checkdir/$u22_cron_dirinfile" | cut -c2)
                    u22_crontab_dirf_other=$(stat -c "%A" "/etc/$u22_cron_checkdir/$u22_cron_dirinfile" | awk '{print substr($1, 8, 3)}')
                    u22_crontab_dirf_owner=$(stat -c "%U" "/etc/$u22_cron_checkdir/$u22_cron_dirinfile")
                    if [[ $u22_crontab_dirf_perm -lt 6 && $u22_crontab_dirf_group -lt 4 ]];then
                        if [[ $u22_crontab_dirf_other == "---" ]];then
                            if [[ $u22_crontab_dirf_owner == "root" ]];then
                                echo "/etc/$u22_cron_checkdir/$u22_cron_dirinfile íŒŒì¼ì— ëŒ€í•œ ì†Œìœ ìž ë° ê¶Œí•œ ì„¤ì •ì´ ì ì ˆí•˜ê²Œ ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                            else
                                echo "/etc/$u22_cron_checkdir/$u22_cron_dirinfile íŒŒì¼ì— ëŒ€í•œ ì†Œìœ ìžê°€ root ì†Œìœ ìžê°€ ì•„ë‹Œ $u22_crontab_dirf_perm ì„¤ì •ë˜ì–´ ìžˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                                u22_safe_check=$((u22_safe_check+1))
                            fi
                        else
                            echo "/etc/$u22_cron_checkdir/$u22_cron_dirinfile íŒŒì¼ì— ëŒ€í•œ ê¸°íƒ€ ì‚¬ìš©ìž(Other)ì— ëŒ€í•œ ê¶Œí•œì´ $u22_crontab_dirf_other ì„¤ì •ë˜ì–´ ìžˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                            u22_safe_check=$((u22_safe_check+1))
                        fi
                    else
                        echo "/etc/$u22_cron_checkdir/$u22_cron_dirinfile íŒŒì¼ì˜ ê¶Œí•œì´ $u22_crontab_dirf_owner ìœ¼ë¡œ 640 ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìœ¼ë©° ê¸°íƒ€ ì‚¬ìš©ìž(Other)ì— ëŒ€í•œ ê¶Œí•œì´ ì„¤ì •ë˜ì–´ ìžˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                        u22_safe_check=$((u22_safe_check+1))
                    fi
                fi
            done
        else
            echo "/etc/$u22_cron_checkdir ë””ë ‰í„°ë¦¬ê°€ ì¡´ìž¬í•˜ë‚˜, íŒŒì¼ì€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        fi
    else
        echo "/etc/$u22_cron_checkdir ë””ë ‰í„°ë¦¬ê°€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
done
for u22_cron_spool in "${u22_cron_spools[@]}";do
    if [ -d "$u22_cron_spool" ];then
        u22_cron_spoolinfiles=($(ls -al $u22_cron_spool | awk '{print $9}' | grep -v "^\." | sed '1d'))
        if [ -n "$u22_cron_spoolinfiles" ];then
            for u22_cron_spoolinfile in "${u22_Cron_spoolinfiles[@]}";do
                if [ -f "$u22_cron_spool/$u22_cron_spoolinfile" ];then
                    u22_crontab_spool_perm=$(stat -c "%a" "$u22_cron_spool/$u22_cron_spoolinfile" | cut -c1)
                    u22_crontab_spool_group=$(stat -c "%a" "$u22_cron_spool/$u22_cron_spoolinfile" | cut -c2)
                    u22_crontab_spool_other=$(stat -c "%A" "$u22_cron_spool/$u22_cron_spoolinfile" | awk '{print substr($1, 8, 3)}')
                    u22_crontab_spool_owner=$(stat -c "%U" "$u22_cron_spool/$u22_cron_spoolinfile")
                    if [[ $u22_crontab_spool_perm -lt 6 && $u22_crontab_spool_group -lt 4 ]];then
                        if [[ $u22_crontab_spool_other == "---" ]];then
                            if [[ $u22_crontab_spool_owner == "root" ]];then
                                echo "$u22_cron_spool/$u22_cron_spoolinfile íŒŒì¼ì— ëŒ€í•œ ì†Œìœ ìž ë° ê¶Œí•œ ì„¤ì •ì´ ì ì ˆí•˜ê²Œ ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                            else
                                echo "$u22_cron_spool/$u22_cron_spoolinfile íŒŒì¼ì— ëŒ€í•œ ì†Œìœ ìžê°€ root ì†Œìœ ìžê°€ ì•„ë‹Œ $u22_crontab_spool_perm ì„¤ì •ë˜ì–´ ìžˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                                u22_safe_check=$((u22_safe_check+1))
                            fi
                        else
                            echo "$u22_cron_spool/$u22_cron_spoolinfile íŒŒì¼ì— ëŒ€í•œ ê¸°íƒ€ ì‚¬ìš©ìž(Other)ì— ëŒ€í•œ ê¶Œí•œì´ $u22_crontab_spool_other ì„¤ì •ë˜ì–´ ìžˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                            u22_safe_check=$((u22_safe_check+1))
                        fi
                    else
                        echo "$u22_cron_spool/$u22_cron_spoolinfile íŒŒì¼ì˜ ê¶Œí•œì´ $u22_crontab_spool_owner ìœ¼ë¡œ 640 ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìœ¼ë©° ê¸°íƒ€ ì‚¬ìš©ìž(Other)ì— ëŒ€í•œ ê¶Œí•œì´ ì„¤ì •ë˜ì–´ ìžˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                        u22_safe_check=$((u22_safe_check+1))
                    fi
                fi
            done
        else
            echo "$u22_cron_spool ë””ë ‰í„°ë¦¬ê°€ ì¡´ìž¬í•˜ë‚˜ íŒŒì¼ì€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        fi
    else
        echo "$u22_cron_spool ë””ë ‰í„°ë¦¬ê°€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
done

if [[ $u22_safe_check -ge 1 ]];then
    u22=$((u22+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u22 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u22_Service_Management=1
fi