cat << EOF
===== [U-40] Upload and downloading web service file files              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-40 ì›¹ì„œë¹„ìŠ¤ íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ ì œí•œ              " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : ê¸°ë°˜ì‹œì„¤ íŠ¹ì„±ìƒ ì›ì¹™ì ìœ¼ë¡œ íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œë¥¼ ê¸ˆì§€í•˜ê³  ìžˆì§€ë§Œë¶ˆê°€í”¼í•˜ê²Œ í•„ìš”ì‹œ ìš©ëŸ‰ ì‚¬ì´ì¦ˆë¥¼ ì œí•œí•¨ìœ¼ë¡œì¨ ë¶ˆí•„ìš”í•œ ì—…ë¡œë“œì™€ ë‹¤ìš´ë¡œë“œë¥¼ ë°©ì§€í•´ ì„œë²„ì˜ ê³¼ë¶€í•˜ ì˜ˆë°© ë° ìžì›ì„ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê¸° ìœ„í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : ì•…ì˜ì  ëª©ì ì„ ê°€ì§„ ì‚¬ìš©ìžê°€ ë°˜ë³µ ì—…ë¡œë“œ ë° ì›¹ ì‰˜ ê³µê²© ë“±ìœ¼ë¡œ ì‹œìŠ¤í…œ ê¶Œí•œì„ íƒˆì·¨í•˜ê±°ë‚˜ ëŒ€ìš©ëŸ‰ íŒŒì¼ì˜ ë°˜ë³µ ì—…ë¡œë“œë¡œ ì„œë²„ìžì›ì„ ê³ ê°ˆì‹œí‚¤ëŠ” ê³µê²©ì˜ ìœ„í—˜ì´ ìžˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜: ì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œë¥¼ ì œí•œí•œ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œë¥¼ ì œí•œí•˜ì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
u40=0
u40_safe_check=0
u40_Service_Management=0
u40_apache_files=("/etc/apache2/conf-available/*.conf" "/etc/apache2/sites-available/*.conf" "/etc/apache2/sites-enabled/*.conf")
u40_nginx_files=("/etc/nginx/conf.d/*.conf" "/etc/nginx/sites-available/*.conf" "/etc/nginx/sites-enabled/*.conf")
u40_apache_home_checks=("httpd.conf" "apache2.conf" ".htaccess")
u40_idx=0
u40_break=0
u40_idxn=0
echo "â€»Cent OS 7 ê¸°ì¤€ Apache ë©”ì¸ ì„¤ì •íŒŒì¼ ê²½ë¡œì™€ Nginx ë©”ì¸ ì„¤ì • íŒŒì¼ì¸ /etc/nginx/nginx.confë¥¼ ì ê²€í•©ë‹ˆë‹¤. í•´ë‹¹ ê²½ë¡œê°€ ì¡´ìž¬í•˜ì§€ ì•Šì„ ê²½ìš°, ì•„íŒŒì¹˜ ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ëª…ì„ í† ëŒ€ë¡œ íŒŒì¼ íƒìƒ‰ í›„ ì ê²€ì´ ì§„í–‰ë©ë‹ˆë‹¤. ì¤‘ë³µëœ íŒŒì¼ëª…ì´ ì¡´ìž¬í•  ê²½ìš° ìˆ˜ë™ ì ê²€ì„ ê¶Œìž¥í•©ë‹ˆë‹¤.â€»"  >> $target
echo "apache, nginx ì˜ ì£¼ìš” ì„¤ì •íŒŒì¼ì„ í† ëŒ€ë¡œ apache í™ˆ ë””ë ‰í„°ë¦¬ ì ê²€ í›„ ì¶”ê°€ ì„¤ì • íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ë¥¼ ì ê²€í•˜ë¯€ë¡œ, ì¤‘ë³µëœ ê²°ê³¼ê°€ ì¡´ìž¬í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤." >> $target
for u40_apache_home_check in "${u40_apache_home_checks[@]}";do
    u40_apache_home=$(find / -type f -name "$u40_apache_home_check" 2> /dev/null | egrep -v "tmp|temp|swap|swp")
    if [ -f "$u40_apache_home" ];then
        echo "$u40_apache_home íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤." >> $target
        u40_dir_pathconfs_a=($(grep -vE "^\s*#" "$u40_apache_home" | sed -n '/<Directory/,/<\/Directory>/p' | grep -i "^\s*LimitRequestBody" | awk '{print $2}'))
        u40_check_dirpath_a=($(grep -vE "^\s*#" "$u40_apache_home" | awk 'BEGIN { inBlock = 0; block = "" }/<Directory/ {block = $0;inBlock = 1;dirPath = $2; gsub("\"", "", dirPath)}/<\/Directory>/ {block = block "\n" $0;inBlock = 0;if (block ~ /LimitRequestBody/) { print dirPath }block = ""}inBlock && ! /<\/Directory>/ { block = block "\n" $0 }' | tr -d '>'))
        if [ -n "$u40_dir_pathconfs_a" ];then
            for u40_dir_pathconf_a in "${u40_dir_pathconfs_a[@]}";do
                if [[ $u40_dir_pathconf_a -ge 5242880 ]];then
                    echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´ìƒ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                    echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´ìƒìœ¼ë¡œ ì„¤ì •ëœ ë””ë ‰í† ë¦¬ ê²½ë¡œ : ${u40_check_dirpath_a[$u40_idx]}" >> $target
                    u40_safe_check=$((u40_safe_check+1))
                    u40_idx=$((u40_idx+1))
                else
                    echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´í•˜ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤.." >> $target
                    echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´ìƒìœ¼ë¡œ ì„¤ì •ëœ ë””ë ‰í† ë¦¬ ê²½ë¡œ : ${u40_check_dirpath_a[$u40_idx]}" >> $target
                    u40_idxn=$((u40_idxn+1))
                fi
            done
            break
        else
            echo "$u40_apache_home íŒŒì¼ì€ ì¡´ìž¬í•˜ì§€ë§Œ, íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ ì‚¬ì´ì¦ˆë¥¼ ì„¤ì •í•  ìˆ˜ ìžˆëŠ” LimitRequestBody ì§€ì‹œìžê°€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    u40_idxn=$((u40_idxn+1))
        fi
    else 
        u40_idx=0
        if [ "$u40_break" -eq 1 ];then
            break
        fi
        u40_break=$((u40_break+1))
        echo "$u40_apache_home_check íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•Šìœ¼ë©°, ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ëª…ì„ í† ëŒ€ë¡œ ì ê²€ì„ ì§„í–‰í•©ë‹ˆë‹¤." >> $target
        for u40_apache_file in "${u40_apache_files[@]}";do
            for u40_apache_check in $u40_apache_file;do
                if [ -f "$u40_apache_check" ];then
                    u40_adected_filecks=$(grep -vE "^\s*#" "$u40_apache_check" | grep -iw "LimitRequestBody" | awk '{print $2}' )
                    for u40_adected_fileck in "${u40_adected_filecks[@]}";do
                        if [ -n "$u40_adected_fileck" ];then
                            if [[ "$u40_adected_fileck" -ge 5242880 ]];then
                                echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´ìƒ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                                echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´ìƒìœ¼ë¡œ ì„¤ì •ëœ ë””ë ‰í† ë¦¬ ê²½ë¡œ : ${u40_apache_check[$u40_idx]}" >> $target
                                u40_safe_check=$((u40_safe_check+1))
                                u40_idx=$((u40_idx+1))
                            else
                                echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´í•˜ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤.." >> $target
                                echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´í•˜ë¡œ ì„¤ì •ëœ ë””ë ‰í† ë¦¬ ê²½ë¡œ : ${u40_check_dirpath_a[$u40_idx]}" >> $target
                                u40_idxn=$((u40_idxn+1))
                            fi
                        else
                            echo "$u40_apache_check íŒŒì¼ì€ ì¡´ìž¬í•˜ì§€ë§Œ íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ ì‚¬ì´ì¦ˆë¥¼ ì„¤ì •í•  ìˆ˜ ìžˆëŠ” LimitRequestBody ì§€ì‹œìžê°€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                            u40_idxn=$((u40_idxn+1))
                        fi
                    done
                fi
            done
        done
        echo "ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ë“¤ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¶”ê°€ì ì¸ ìˆ˜ë™ ì ê²€ì„ ê¶Œìž¥í•©ë‹ˆë‹¤." >> $target
        u40_idx=0
    fi
done
u40_idx=0
u40_idxn=0
if [ -f "/etc/nginx/nginx.conf" ];then
    echo "/etc/nginx/nginx.conf íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤." >> $target
    u40_dir_sizechecks_n=($(grep -vE "^\s*#" "/etc/nginx/nginx.conf" | grep -iw "^\s*client_max_body_size" | sed 's/^[ \t]*//' | awk '{print $2}' | tr -d ';'))
    if [ -n "$u40_dir_sizechecks_n" ];then
        for u40_dir_sizecheck_n in "${u40_dir_sizechecks_n[@]}";do
            if [[ $u40_dir_sizecheck_n -ge 5242880 ]];then
                echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´ìƒ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                u40_safe_check=$((u40_safe_check+1))
                u40_idx=$((u40_idx+1))
            else
                echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´í•˜ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤.." >> $target
                u40_idxn=$((u40_idxn+1))
            fi
        done
    else
        echo "/etc/nginx/nginx.conf íŒŒì¼ì€ ì¡´ìž¬í•˜ì§€ë§Œ, íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ ì‚¬ì´ì¦ˆë¥¼ ì„¤ì •í•  ìˆ˜ ìžˆëŠ” client_max_body_size ì§€ì‹œìžê°€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi    
else 
    echo "/etc/nginx/nginx.conf íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•Šìœ¼ë©°, ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ëª…ì„ í† ëŒ€ë¡œ ì ê²€ì„ ì§„í–‰í•©ë‹ˆë‹¤." >> $target
    for u40_ngnix_file in "${u40_nginx_files[@]}";do
        for u40_nginx_check in $u39_ngnix_file;do
            u40_dir_sizechecks_n=($(grep -vE "^\s*#" "$u40_nginx_check" | grep -iw "^\s*client_max_body_size" | sed 's/^[ \t]*//' | awk '{print $2}' | tr -d ';'))
            if [ -f "$u40_nginx_check" ];then
                echo "$u40_nginx_check íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤."
                #u39_ndected_filecks=$(grep -vE "^\s*#" "$u39_nginx_check" | grep -iw "autoindex" | tr -d ';' | grep -iw "on")
                for u40_dir_sizecheck_n in "${u40_dir_sizechecks_n[@]}";do
                    if [ -n "$u40_dir_sizecheck_n" ];then
                        if [ "$u40_dir_sizecheck_n" -ge 5242880 ];then
                            echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´ìƒ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                            u40_safe_check=$((u40_safe_check+1))
                            u40_idx=$((u40_idx+1))
                        else
                            echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´í•˜ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤.." >> $target
                            u40_idxn=$((u40_idxn+1))
                        fi
                    else
                        echo "$u39_nginx_check íŒŒì¼ì€ ì¡´ìž¬í•˜ì§€ë§Œ Body ì‚¬ì´ì¦ˆë¥¼ ì œí•œí•˜ëŠ” client_max_body_size ì§€ì‹œìžê°€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                        u40_idxn=$((u40_idxn+1))
                    fi
                done
                if [[ $u40_idx -ge 1 ]];then
                    echo "$u40_nginx_check íŒŒì¼ì—ì„œ íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ ì‚¬ì´ì¦ˆê°€ 5Mì´ìƒìœ¼ë¡œ ì„¤ì •ëœ client_max_body_sizeê°€ ìžˆìŠµë‹ˆë‹¤." >> $target
                    echo "ì„¤ì • ê°’ : $u40_dir_sizecheck_n" >> $target
                    echo "ì´ $u40_idx ê°œì˜ ì·¨ì•½í•œ ì‚¬ì´ì¦ˆ ì„¤ì •ì´ ì¡´ìž¬í•©ë‹ˆë‹¤. $u40_nginx_check íŒŒì¼ì„ í™•ì¸í•˜ì‹­ì‹œì˜¤." >> $target
                    echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ ì‚¬ì´ì¦ˆê°€ ì ì ˆí•˜ê²Œ ì„¤ì •ëœ $u40_idxn ê°œì˜ ì„¤ì •ì´ ì¡´ìž¬ í•©ë‹ˆë‹¤. $u40_nginx_check íŒŒì¼ì„ í™•ì¸í•˜ì‹­ì‹œì˜¤." >> $target
                fi
            fi
        done
    done
    echo "ì¶”ê°€ì ì¸ ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ë“¤ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¶”ê°€ì ì¸ ìˆ˜ë™ ì ê²€ì„ ê¶Œìž¥í•©ë‹ˆë‹¤." >> $target
fi

if [[ $u40_safe_check -ge 1 ]];then
    u40=$((u40+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u40 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u40_Service_Management=1
fi