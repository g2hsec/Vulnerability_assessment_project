cat << EOF
===== [U-45] Restrict root account su              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-45 root ê³„ì • su ì œí•œ              " >> $target
echo "--------------------------------------------------------------------------" >> $target-F: '{print $4}'
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : su ê´€ë ¨ ê·¸ë£¹ë§Œ su ëª…ë ¹ì–´ ì‚¬ìš© ê¶Œí•œì´ ë¶€ì—¬ë˜ì–´ ìžˆëŠ”ì§€ ì ê²€í•˜ì—¬ su ê·¸ë£¹ì— í¬í•¨ë˜ì§€ ì•Šì€ ì¼ë°˜ ì‚¬ìš©ìžì˜ su ëª…ë ¹ ì‚¬ìš©ì„ ì›ì²œì ìœ¼ë¡œ ì°¨ë‹¨í•˜ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ë¬´ë¶„ë³„í•œ ì‚¬ìš©ìž ë³€ê²½ìœ¼ë¡œ íƒ€ ì‚¬ìš©ìž ì†Œìœ ì˜ íŒŒì¼ì„ ë³€ê²½ í•  ìˆ˜ ìžˆìœ¼ë©°root ê³„ì •ìœ¼ë¡œ ë³€ê²½í•˜ëŠ” ê²½ìš° ê´€ë¦¬ìž ê¶Œí•œì„ íšë“ í•  ìˆ˜ ìžˆìŒ" >> $target
echo "â€» ì¼ë°˜ì‚¬ìš©ìž ê³„ì • ì—†ì´ root ê³„ì •ë§Œ ì‚¬ìš©í•˜ëŠ” ê²½ìš° su ëª…ë ¹ì–´ ì‚¬ìš©ì œí•œ ë¶ˆí•„ìš”" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜: su ëª…ë ¹ì–´ë¥¼ íŠ¹ì • ê·¸ë£¹ì— ì†í•œ ì‚¬ìš©ìžë§Œ ì‚¬ìš©í•˜ë„ë¡ ì œí•œë˜ì–´ ìžˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: su ëª…ë ¹ì–´ë¥¼ ëª¨ë“  ì‚¬ìš©ìžê°€ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •ë˜ì–´ ìžˆëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
u45_Account_Management=0
u45_safe_check=0
u45=0
u45_wheel_check=$(grep -i "wheel" "/etc/passwd" | awk '{print $1}')
u45_whell_group=$(grep -i "wheel" "/etc/group" | awk -F: '{print $4}')
u45_su_perm=$(stat -c "%a" /usr/bin/su)
u45_su_perm_other=$(stat -c "%A" /usr/bin/su | rev | cut -c 1-3 | rev)
if [ -n "$u45_wheel_check" ];then
    echo "$u45_wheel_check ê³„ì •ì´ ì¡´ìž¬í•©ë‹ˆë‹¤." >> $target
    if grep -i "wheel" "/etc/group";then
        if [ -n "$u45_whell_group" ];then
            echo "$u45_whell_group ê³„ì •ë“¤ì´ wheel ê·¸ë£¹ì— ì†í•´ìžˆìŠµë‹ˆë‹¤." >> $target
        else
            echo "wheel ê·¸ë£¹ì˜ í¬í•¨ëœ ê³„ì •ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
            u45_safe_check=$((u45_safe_check+1))
        fi
    fi
else
    echo "wheel ê³„ì •ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    u45_safe_check=$((u45_safe_check+1))
fi
if [[ $u45_su_perm -eq 4750 && "$u45_su_perm_other" == "---" ]];then
    echo "/usr/bin/su íŒŒì¼ì˜ ê¶Œí•œì´ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
else
    echo "/usr/bin/su íŒŒì¼ì˜ ê¶Œí•œì´ $(stat -c "%A" /usr/bin/su) ë¡œ ì ì ˆí•˜ì§€ ì•Šê²Œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
fi

if [ -f "/etc/pam.d/su" ];then
    u45_pam=$(grep -v "#" "/etc/pam.d/su" | grep auth | grep required | grep pam_wheel.so | egrep -E "use_uid|debug\s*group=wheel")
    if [ -n "$u45_pam" ];then
        echo "/etc/pam.d/su íŒŒì¼ ë‚´ì— pam_wheel.so ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì—¬ wheel ê·¸ë£¹ì˜ ì‚¬ìš©ìžë“¤ë§Œ su ëª…ë ¹ì„ ì‚¬ìš©í•  ìˆ˜ ìžˆê²Œ ì œí•œí•˜ê³  ìžˆìŠµë‹ˆë‹¤." >> $target
    else
        echo "/etc/pam.d/su íŒŒì¼ ë‚´ì— whell ê·¸ë£¹ì˜ ì‚¬ìš©ìžë“¤ë§Œ suëª…ë ¹ì„ ì‚¬ìš©í•˜ë„ë¡ í•˜ëŠ” ì„¤ì •ê°’ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        u45_safe_check=$((u45_safe_check+1))
    fi
else
    echo "/etc/pam.d/su íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [ $u45_safe_check -ge 1 ];then
    u45=$((u45+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u45 -ge 1 ]];then
    Low=$((Low+1))
    Account_Management=$((Account_Management+1))
    u45_Account_Management=1
fi