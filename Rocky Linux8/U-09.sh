cat << EOF
===== [U-09] /etc/hosts file owner and permission settings               =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-09   /etc/hosts íŒŒì¼ ì†Œìœ ìž ë° ê¶Œí•œ ì„¤ì •                        " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : /etc/hosts íŒŒì¼ì„ ê´€ë¦¬ìžë§Œ ì œì–´í•  ìˆ˜ ìžˆê²Œ í•˜ì—¬ ë¹„ì¸ê°€ìžë“¤ì˜ ìž„ì˜ì ì¸ íŒŒì¼ ë³€ì¡°ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : hosts íŒŒì¼ì— ë¹„ì¸ê°€ìž ì“°ê¸° ê¶Œí•œì´ ë¶€ì—¬ëœ ê²½ìš°, ê³µê²©ìžëŠ” hostsíŒŒì¼ì— ì•…ì˜ì ì¸ ì‹œìŠ¤í…œì„ ë“±ë¡í•˜ì—¬, ì´ë¥¼ í†µí•´ ì •ìƒì ì¸ DNSë¥¼ ìš°íšŒí•˜ì—¬ ì•…ì„±ì‚¬ì´íŠ¸ë¡œì˜ ì ‘ì†ì„ ìœ ë„í•˜ëŠ” íŒŒë°(Pharming) ê³µê²© ë“±ì— ì•…ìš©ë  ìˆ˜ ìžˆìŒhostsíŒŒì¼ì— ì†Œìœ ìžì™¸ ì“°ê¸° ê¶Œí•œì´ ë¶€ì—¬ëœ ê²½ìš°, ì¼ë°˜ì‚¬ìš©ìž ê¶Œí•œìœ¼ë¡œ hostsíŒŒì¼ì— ë³€ì¡°ëœ IPì£¼ì†Œë¥¼ ë“±ë¡í•˜ì—¬ ì •ìƒì ì¸ DNSë¥¼ ë°©í•´í•˜ê³  ì•…ì„±ì‚¬ì´íŠ¸ë¡œì˜ ì ‘ì†ì„ ìœ ë„í•˜ëŠ” íŒŒë°(Pharming) ê³µê²© ë“±ì— ì•…ìš©ë  ìˆ˜ ìžˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜: /etc/hosts íŒŒì¼ì˜ ì†Œìœ ìžê°€ rootì´ê³ , ê¶Œí•œì´ 600ì¸ ì´í•˜ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: /etc/hosts íŒŒì¼ì˜ ì†Œìœ ìžê°€ rootê°€ ì•„ë‹ˆê±°ë‚˜, ê¶Œí•œì´ 600 ì´ìƒì¸ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-9 ì ê²€ ê²°ê³¼" >> $result
u9=0
u9_safe_check=0
u9_Account_Management=0

if [[ -e "/etc/hosts" ]];then
    echo "/etc/hosts íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤."
    u9_file_owner_user=$(stat -c "%U" "/etc/hosts" 2> /dev/null)
    u9_file_owner=$(stat -c "%a" "/etc/hosts"  2> /dev/null| cut -c1)
    u9_file_group=$(stat -c "%a" "/etc/hosts"  2> /dev/null| cut -c2)
    u9_file_other=$(stat -c "%a" "/etc/hosts"  2> /dev/null| cut -c3)
    u9_check_suid=$(stat -c "%a" "/etc/hosts"  2> /dev/null| tr -d '\n' | wc -c)
    if [[ $u9_check_suid -ge 4 ]];then
        echo "$u9_file íŒŒì¼ì— SUID ê°€ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤. [ìž˜ëª»ëœ SUID ì„¤ì •]" >> $target
        u9_safe_check=$((u9_safe_check+1))
    else
        if [[ "$u9_file_owner_user" == "root" ]];then
            echo "/etc/hosts íŒŒì¼ì˜ ì†Œìœ ìžê°€ rootë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
            if [ $u9_file_owner -le 6 ];then
                echo "/etc/hosts íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                if [ $u9_file_group -le 0 ];then
                    echo "/etc/hosts íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 0ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                    if [ $u9_file_other -eq 0 ];then
                        echo "/etc/hosts íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ìž(Other) ê¶Œí•œì´ 0ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                    else
                        echo "/etc/hosts íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ìž(Other) ê¶Œí•œì´ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                        u9_safe_check=$((u9_safe_check+1))
                    fi
                else
                    echo "/etc/hosts íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 0ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                    u9_safe_check=$((u9_safe_check+1))
                fi
            else
                echo "/etc/hosts íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                u9_safe_check=$((u9_safe_check+1)) 
            fi
        else
            echo "/etc/hosts íŒŒì¼ì˜ ì†Œìœ ìžê°€ rootê°€ ì•„ë‹Œ ë‹¤ë¥¸ ì‚¬ìš©ìžë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
            u9_safe_check=$((u9_safe_check+1))
        fi
    fi
else
    echo "/etc/hosts íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    u9_safe_check=$((u9_safe_check+1))
    u9_Account_Management=$((u9_safe_check+1))
fi


if [ $u9_safe_check -ge 1 ];then
    u9=$((u9+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u9 -ge 1 ]];then
    High=$((High+1))
    Account_Management=$((Account_Management+1))
    u9_Account_Management=1
fi