cat << EOF
===== [U-71] Hide Apache Web Services Information              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-71 Apache ì›¹ ì„œë¹„ìŠ¤ ì •ë³´ ìˆ¨ê¹€             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : HTTP í—¤ë”, ì—ëŸ¬íŽ˜ì´ì§€ì—ì„œ ì›¹ ì„œë²„ ë²„ì „ ë° ì¢…ë¥˜, OS ì •ë³´ ë“± ì›¹ ì„œë²„ì™€ ê´€ë ¨ëœ ë¶ˆí•„ìš”í•œ ì •ë³´ê°€ ë…¸ì¶œë˜ì§€ ì•Šë„ë¡ í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ë¶ˆí•„ìš”í•œ ì •ë³´ê°€ ë…¸ì¶œë  ê²½ìš° í•´ë‹¹ ì •ë³´ë¥¼ ì´ìš©í•˜ì—¬ ì‹œìŠ¤í…œì˜ ì·¨ì•½ì ì„ ìˆ˜ sì§‘í•  ìˆ˜ ìžˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜: ServerTokens Prod, ServerSignature Offë¡œ ì„¤ì •ë˜ì–´ìžˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: ServerTokens Prod, ServerSignature Offë¡œ ì„¤ì •ë˜ì–´ìžˆì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-71 ì ê²€ ê²°ê³¼" >> $result

u71_Service_Management=0
u71=0
u71_safe_check=0
u71_apache_files=("/etc/apache2/conf-available/*.conf" "/etc/apache2/sites-available/*.conf" "/etc/apache2/sites-enabled/*.conf" "/etc/apache2/conf-enabled/*.conf" ".htaccess")
u71_nginx_files=("/etc/nginx/conf.d/*.conf" "/etc/nginx/sites-available/*.conf" "/etc/nginx/sites-enabled/*.conf")
u71_apache_home_checks=("httpd.conf" "apache2.conf" ".htaccess")
u71_break=0
echo "â€»Cent OS 7 ê¸°ì¤€ Apache ë©”ì¸ ì„¤ì •íŒŒì¼ ê²½ë¡œì™€ Nginx ë©”ì¸ ì„¤ì • íŒŒì¼ì¸ /etc/nginx/nginx.confë¥¼ ì ê²€í•©ë‹ˆë‹¤. í•´ë‹¹ ê²½ë¡œê°€ ì¡´ìž¬í•˜ì§€ ì•Šì„ ê²½ìš°, ì•„íŒŒì¹˜ ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ëª…ì„ í† ëŒ€ë¡œ íŒŒì¼ íƒìƒ‰ í›„ ì ê²€ì´ ì§„í–‰ë©ë‹ˆë‹¤. ì¤‘ë³µëœ íŒŒì¼ëª…ì´ ì¡´ìž¬í•  ê²½ìš° ìˆ˜ë™ ì ê²€ì„ ê¶Œìž¥í•©ë‹ˆë‹¤.â€»" >> $target
for u71_apache_home_check in "${u71_apache_home_checks[@]}";do
    u71_apache_home=$(find / -type f -name "$u71_apache_home_check" 2> /dev/null | egrep -v "tmp|temp|swap|swp")
    if [ -f "$u71_apache_home" ];then
        echo "$u71_apache_home íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤." >> $target
        u71_server_tokens=$(grep -vE "^\s*#" "$u71_apache_home" | grep -i "ServerTokens" | grep -i "prod")
        u71_serversignature=$(grep -E "^\s*#" "$u71_apache_home" | grep -i "ServerSignature" | grep -i "off")
        if [ -n "$u71_server_tokens" ];then
            echo "ServerTokens ì§€ì‹œìžì˜ ì˜µì…˜ì´ Prodë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
            echo "í˜„ìž¬ ì„¤ì • ê°’ : $u71_server_tokens" >> $target
            if [ -n "$u71_serversignature" ];then
                echo "ServerSignature ì§€ì‹œìžì˜ ì˜µì…˜ì´ offë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                echo "í˜„ìž¬ ì„¤ì • ê°’ : $u71_serversignature" >> $target
            else
                echo "ServerSignature ì§€ì‹œìžì˜ ì˜µì…˜ì´ ì¡´ìž¬í•˜ì§€ ì•Šê±°ë‚˜, offë¡œ ì„¤ì •ë˜ì–´ ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                u71_safe_check=$((u71_safe_check+1))
            fi
        else
            echo "ServerTokens ì§€ì‹œìžì˜ ì˜µì…˜ì´ ì¡´ìž¬í•˜ì§€ ì•Šê±°ë‚˜, Prodë¡œ ì„¤ì •ë˜ì–´ ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
            u71_safe_check=$((u71_safe_check+1))
        fi
    else 
        if [ $u71_break -eq 1 ];then
            continue
        fi
        u71_break=$((u71_break+1))
        for u71_apache_file in "${u71_apache_files[@]}";do
            for u71_apache_check in $u71_apache_file;do
                if [ -f "$u71_apache_check" ];then
                    echo "$u71_apache_check íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤." >> $target
                    u71_server_tokens=$(grep -v "^\s*#" "$u71_apache_check" | grep -i "ServerTokens" | grep -i "prod")
                    u71_serversignature=$(grep -v "^\s*#" "$u71_apache_check" | grep -i "ServerSignature" | grep -i "off")
                    if [ -n "$u71_server_tokens" ];then
                        echo "ServerTokens ì§€ì‹œìžì˜ ì˜µì…˜ì´ Prodë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                        echo "í˜„ìž¬ ì„¤ì • ê°’ : $u71_server_tokens" >> $target
                        if [ -n "$u71_serversignature" ];then
                            echo "ServerSignature ì§€ì‹œìžì˜ ì˜µì…˜ì´ offë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                            echo "í˜„ìž¬ ì„¤ì • ê°’ : $u71_serversignature" >> $target
                        else
                            echo "ServerSignature ì§€ì‹œìžì˜ ì˜µì…˜ì´ ì¡´ìž¬í•˜ì§€ ì•Šê±°ë‚˜, offë¡œ ì„¤ì •ë˜ì–´ ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                            u71_safe_check=$((u71_safe_check+1))
                        fi
                    else
                        echo "ServerTokens ì§€ì‹œìžì˜ ì˜µì…˜ì´ ì¡´ìž¬í•˜ì§€ ì•Šê±°ë‚˜, Prodë¡œ ì„¤ì •ë˜ì–´ ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                        u71_safe_check=$((u71_safe_check+1))
                    fi
                fi
            done
        done
    fi
done
echo "ì¶”ê°€ì ì¸ Apache ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ë“¤ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¶”ê°€ì ì¸ ìˆ˜ë™ ì ê²€ì„ ê¶Œìž¥í•©ë‹ˆë‹¤." >> $target
if [ -f "/etc/nginx/nginx.conf" ];then
    echo "/etc/nginx/nginx.conf íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤." >> $target
    u71_server_tokens_nginx=$(grep -v "^\s*#" "/etc/nginx/nginx.conf" | grep -i "server_tokens" | grep -i "off")
    if [ -n "$u71_server_tokens_nginx" ];then
        echo "server_tokens ì§€ì‹œìžì˜ ì˜µì…˜ì´ offë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
        echo "í˜„ìž¬ ì„¤ì • ê°’ : $u71_server_tokens_nginx" >> $target
    else
        echo "server_tokens ì§€ì‹œìžì˜ ì˜µì…˜ì´ ì¡´ìž¬í•˜ì§€ ì•Šê±°ë‚˜, offë¡œ ì„¤ì •ë˜ì–´ ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        u71_safe_check=$((u71_safe_check+1))
    fi
else 
    echo "/etc/nginx/nginx.conf íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•Šìœ¼ë©°, ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ëª…ì„ í† ëŒ€ë¡œ ì ê²€ì„ ì§„í–‰í•©ë‹ˆë‹¤." >> $target
    for u71_ngnix_file in ${u71_nginx_files[@]};do
        for u71_nginx_check in $u71_ngnix_file;do
            if [ -e "$u71_nginx_check" ];then
                echo "$u71_nginx_check íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤." >> $target
                u71_server_tokens_nginx=$(grep -v "^\s*#" "$u71_nginx_check" | grep -i "server_tokens" | grep -i "off")
                if [ -n "$u71_server_tokens_nginx" ];then
                    echo "server_tokens ì§€ì‹œìžì˜ ì˜µì…˜ì´ offë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                    echo "í˜„ìž¬ ì„¤ì • ê°’ : $u71_server_tokens_nginx" >> $target
                else
                    echo "server_tokens ì§€ì‹œìžì˜ ì˜µì…˜ì´ ì¡´ìž¬í•˜ì§€ ì•Šê±°ë‚˜, offë¡œ ì„¤ì •ë˜ì–´ ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    u71_safe_check=$((u71_safe_check+1)) >> $target
                fi
            fi
        done
    done
    echo "ì¶”ê°€ì ì¸ ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ë“¤ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¶”ê°€ì ì¸ ìˆ˜ë™ ì ê²€ì„ ê¶Œìž¥í•©ë‹ˆë‹¤." >> $target
fi

if [[ $u71_safe_check -ge 1 ]];then
    u71=$((u71+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi

if [[ $u71 -ge 1 ]];then
    Mid=$((Mid+1))
    Service_Management=$((Service_Management+1))
    u71_Service_Management=1
fi