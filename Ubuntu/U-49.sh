cat << EOF
===== [U-49] Remove unnecessary accounts              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-49 ë¶ˆí•„ìš”í•œ ê³„ì • ì œê±°              " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ë¶ˆí•„ìš”í•œ ê³„ì •ì´ ì¡´ìž¬í•˜ëŠ”ì§€ ì ê²€í•˜ì—¬ ê´€ë¦¬ë˜ì§€ ì•Šì€ ê³„ì •ì— ì˜í•œ ì¹¨ìž…ì— ëŒ€ë¹„í•˜ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ë¡œê·¸ì¸ì´ ê°€ëŠ¥í•˜ê³  í˜„ìž¬ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë¶ˆí•„ìš”í•œ ê³„ì •ì€ ì‚¬ìš©ì¤‘ì¸ ê³„ì •ë³´ë‹¤ ìƒëŒ€ì ìœ¼ë¡œ ê´€ë¦¬ê°€ ì·¨ì•½í•˜ì—¬ ê³µê²©ìžì˜ ëª©í‘œê°€ ë˜ì–´ ê³„ì •ì´ íƒˆì·¨ë  ìˆ˜ ìžˆìŒ" >> $target
echo " â€» í‡´ì§, ì „ì§, íœ´ì§ ë“±ì˜ ì‚¬ìœ ë°œìƒì‹œ ì¦‰ì‹œ ê¶Œí•œì„ íšŒìˆ˜" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜: ë¶ˆí•„ìš”í•œ ê³„ì •ì´ ì¡´ìž¬í•˜ì§€ ì•ŠëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: ë¶ˆí•„ìš”í•œ ê³„ì •ì´ ì¡´ìž¬í•˜ëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
u49_Account_Management=0
u49_safe_check=0
u49_general_users=($(egrep -v "root|nologin|shutdown|sync|halt|false" "/etc/passwd" | awk -F: '{print $1}'))
u49=0
u49_idx=0
u49_never_loggeds=($(lastlog | grep -i 'Never logged in' | awk '{print $1}'))
u49_corrent_timestamp=$(date +%s)
u49_2weeks_check=0


u49_lastlog_dates=($(lastlog | grep -vi 'Never logged in' | awk '{for (i=3; i<=NF; i++) printf "%s%s", $i, (i < NF ? OFS : "\n")}'  | sed '1d'))
u49_lastlog_timestamps=()

for u49_date_str in "${u49_lastlog_dates[@]}"; do
    u49_timestamp=$(date -d "$u49_date_str" +%s 2>/dev/null)
    if [ $? -eq 0 ]; then
        u49_lastlog_timestamps+=("$u49_timestamp")
    fi
done

u49_lastlog_users=($(lastlog | grep -vi 'Never logged in' | awk 'NR>1 {print $1}'))
u49_two_weeks_seconds=$((14 * 24 * 60 * 60))

if [ -n "$u49_general_users" ];then
    echo "root ì œì™¸í•œ ì‹œìŠ¤í…œ ì‚¬ìš©ìž ëª©ë¡ìž…ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê³„ì •ì´ ì¡´ìž¬í•  ê²½ìš° ì‚­ì œì¡°ì¹˜ ë°”ëžë‹ˆë‹¤." >> $target
    for u49_general_user in "${u49_general_users[@]}";do
        echo "$u49_general_user" >> $target
    done
else
    echo "root ì œì™¸í•œ ì‹œìŠ¤í…œ ì‚¬ìš©ìž ëª©ë¡ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi


if [ -n "$u49_never_loggeds" ];then
    echo "ê³„ì • ìƒì„± í›„ ì‹œìŠ¤í…œì— ë¡œê·¸ì¸í•œ ì  ì—†ëŠ” ê³„ì •ë“¤ìž…ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ì¡°ì¹˜ ë°”ëžë‹ˆë‹¤." >> $target
    u49_safe_check=$((u49_safe_check+1))
    for u49_never_logged in "${u49_never_loggeds[@]}";do
        echo "ê³„ì • ëª… : $u49_never_logged" >> $target
    done
else
    echo "ì‹œìŠ¤í…œì— ë¡œê·¸ì¸í•œ ì  ì—†ëŠ” ê³„ì •ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [ ${#u49_general_users[@]} -gt 0 ];then
    echo "ì‹œìŠ¤í…œì— 2ì£¼ ì´ìƒ ë¡œê·¸ì¸(ì ‘ê·¼) ê¸°ë¡ì´ ì—†ëŠ” ê³„ì • ëª©ë¡ìž…ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ì¡°ì¹˜ ë°”ëžë‹ˆë‹¤." >> $target
    u49_safe_check=$((u49_safe_check+1))
    for u49_lastlog_user in "${u49_lastlog_users[@]}";do
        if (( u49_lastlog_timestamps[u49_idx] <= u49_corrent_timestamp - u49_two_weeks_seconds )); then
            echo "$u49_lastlog_user" >> $target
        else
            u49_2weeks_check=$((u49_2weeks_check+1))
        fi
        u49_idx=$((u49_idx+1))
    done
    if [ $u49_2weeks_check -ge 1 ];then
        echo "ì‹œìŠ¤í…œì— 2ì£¼ ì´ìƒ ë¡œê·¸ì¸(ì ‘ê·¼) ê¸°ë¡ì´ ì—†ëŠ” ê³„ì •ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
fi

if [ $u49_safe_check -ge 1 ];then
    u49=$((u49+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u49 -ge 1 ]];then
    Low=$((Low+1))
    Account_Management=$((Account_Management+1))
    u49_Account_Management=1
fi
