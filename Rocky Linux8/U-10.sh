cat << EOF
===== [U-10] /etc/(x)inetd.conf file owner and permission settings               =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-10   /etc/(x)inetd.conf íŒŒì¼ ì†Œìœ ìž ë° ê¶Œí•œ ì„¤ì •                        " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : /etc/(x)inetd.conf íŒŒì¼ì„ ê´€ë¦¬ìžë§Œ ì œì–´í•  ìˆ˜ ìžˆê²Œ í•˜ì—¬ ë¹„ì¸ê°€ìžë“¤ì˜ ìž„ì˜ì ì¸ íŒŒì¼ ë³€ì¡°ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : (x)inetd.conf íŒŒì¼ì— ì†Œìœ ìžì™¸ ì“°ê¸° ê¶Œí•œì´ ë¶€ì—¬ëœ ê²½ìš°, ì¼ë°˜ì‚¬ìš©ìž ê¶Œí•œìœ¼ë¡œ (x)inetd.conf íŒŒì¼ì— ë“±ë¡ëœ ì„œë¹„ìŠ¤ë¥¼ ë³€ì¡°í•˜ê±°ë‚˜ ì•…ì˜ì ì¸ í”„ë¡œê·¸ëž¨(ì„œë¹„ìŠ¤)ë¥¼ ë“±ë¡í•  ìˆ˜ ìžˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜: /etc/inetd.conf íŒŒì¼ì˜ ì†Œìœ ìžê°€ rootì´ê³ , ê¶Œí•œì´ 600ì¸ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: /etc/inetd.conf íŒŒì¼ì˜ ì†Œìœ ìžê°€ rootê°€ ì•„ë‹ˆê±°ë‚˜, ê¶Œí•œì´ 600ì´ ì•„ë‹Œ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-10 ì ê²€ ê²°ê³¼" >> $result
u10=0
u10_x_inetd_confs=("/etc/inetd.conf" "/etc/xinetd.conf")
u10_safe_check=0
u10_Files_Directory_Management=0
for u10_x_inetd_conf in "${u10_x_inetd_confs[@]}";do
    if [[ -e "$u10_x_inetd_conf" ]];then
        echo "$u10_x_inetd_conf íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤."
        u10_file_owner_user=$(stat -c "%U" "$u10_x_inetd_conf" 2> /dev/null)
        u10_file_owner=$(stat -c "%a" "$u10_x_inetd_conf"  2> /dev/null| cut -c1)
        u10_file_group=$(stat -c "%a" "$u10_x_inetd_conf"  2> /dev/null| cut -c2)
        u10_file_other=$(stat -c "%a" "$u10_x_inetd_conf"  2> /dev/null| cut -c3)
        u10_check_suid=$(stat -c "%a" "$u10_x_inetd_conf"  2> /dev/null| tr -d '\n' | wc -c)
        if [[ $u10_check_suid -ge 4 ]];then
            echo "$u10_file íŒŒì¼ì— SUID ê°€ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤. [ìž˜ëª»ëœ SUID ì„¤ì •]" >> $target
            u10_safe_check=$((u10_safe_check+1))
        else
            if [[ "$u10_file_owner_user" == "root" ]];then
                echo "/etc/hosts íŒŒì¼ì˜ ì†Œìœ ìžê°€ rootë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤."
                if [ $u10_file_owner -eq 6 ];then
                    echo "$u10_x_inetd_conf íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                    if [ $u10_file_group -eq 0 ];then
                        echo "$u10_x_inetd_conf íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 0ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                        if [ $u10_file_other -eq 0 ];then
                            echo "$u10_x_inetd_conf íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ìž(Other) ê¶Œí•œì´ 0ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                        else
                            echo "$u10_x_inetd_conf íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ìž(Other) ê¶Œí•œì´ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                            u10_safe_check=$((u10_safe_check+1))
                        fi
                    else
                        ehco "$u10_x_inetd_conf íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                        u10_safe_check=$((u10_safe_check+1))
                    fi
                else
                    echo "$u10_x_inetd_conf íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                    u10_safe_check=$((u10_safe_check+1)) >> $target
                fi
            else
                echo "/etc/hosts íŒŒì¼ì˜ ì†Œìœ ìžê°€ rootê°€ ì•„ë‹Œ ë‹¤ë¥¸ ì‚¬ìš©ìžë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤."
                u10_safe_check=$((u10_safe_check+1))
            fi
        fi
    else
        echo "$u10_x_inetd_conf íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
done

if [[ -d "/etc/xinetd.d" ]]; then
    for u10_xinetd_file in /etc/xinetd.d/*; do
        if [[ -f $u10_xinetd_file ]]; then
            echo "$u10_xinetd_file ì´ ì¡´ìž¬í•©ë‹ˆë‹¤."
            u10_file_owner_user=$(stat -c "%U" "$u10_xinetd_file" 2> /dev/null)
            u10_file_owner=$(stat -c "%a" "$u10_xinetd_file"  2> /dev/null| cut -c1)
            u10_file_group=$(stat -c "%a" "$u10_xinetd_file"  2> /dev/null| cut -c2)
            u10_file_other=$(stat -c "%a" "$u10_xinetd_file"  2> /dev/null| cut -c3)
            u10_check_suid=$(stat -c "%a" "$u10_xinetd_file"  2> /dev/null| tr -d '\n' | wc -c)
            if [[ $u10_check_suid -ge 4 ]];then
                echo "$u10_file íŒŒì¼ì— SUID ê°€ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤. [ìž˜ëª»ëœ SUID ì„¤ì •]" >> $target
                u10_safe_check=$((u10_safe_check+1))
            else
                if [[ "$u10_file_owner_user" == "root" ]];then
                    echo "$u10_xinetd_file íŒŒì¼ì˜ ì†Œìœ ìžê°€ rootë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                    if [ $u10_file_owner -le 6 ];then
                        echo "$u10_xinetd_file íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                        if [ $u10_file_group -le 0 ];then
                            echo "$u10_xinetd_file íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 0ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                            if [ $u10_file_other -eq 0 ];then
                                echo "$u10_xinetd_file íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ìž(Other) ê¶Œí•œì´ 0ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                            else
                                echo "$u10_xinetd_file íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ìž(Other) ê¶Œí•œì´ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                                u10_safe_check=$((u10_safe_check+1))
                            fi
                        else
                            ehco "$u10_xinetd_file íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                            u10_safe_check=$((u10_safe_check+1))
                        fi
                    else
                        echo "$u10_xinetd_file íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                        u10_safe_check=$((u10_safe_check+1)) 
                    fi
                else
                    echo "$u10_xinetd_file íŒŒì¼ì˜ ì†Œìœ ìžê°€ rootê°€ ì•„ë‹Œ ë‹¤ë¥¸ ì‚¬ìš©ìžë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                    u10_safe_check=$((u10_safe_check+1))
                fi 
            fi
        fi
    done
else
    echo "/etc/xinetd.d ë””ë ‰í„°ë¦¬ê°€ ì¡´ìž¬í•˜ì§€ ì•Šê±°ë‚˜, í•´ë‹¹ ë””ë ‰í„°ë¦¬ ë‚´ì— íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."  >> $target
fi

if [[ $u10_safe_check -ge 1 ]];then
    u10=$((u10+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u10 -ge 1 ]];then
    High=$((High+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u10_Files_Directory_Management=1
fi