cat << EOF
===== [U-14] Setting users, system startup files and environment file owners and permissions               =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-14 ì‚¬ìš©ìž, ì‹œìŠ¤í…œ ì‹œìž‘íŒŒì¼ ë° í™˜ê²½íŒŒì¼ ì†Œìœ ìž ë° ê¶Œí•œ ì„¤ì •                        " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ë¹„ì¸ê°€ìžì˜ í™˜ê²½ë³€ìˆ˜ ì¡°ìž‘ìœ¼ë¡œ ì¸í•œ ë³´ì•ˆ ìœ„í—˜ì„ ë°©ì§€í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : í™ˆ ë””ë ‰í„°ë¦¬ ë‚´ì˜ ì‚¬ìš©ìž íŒŒì¼ ë° ì‚¬ìš©ìžë³„ ì‹œìŠ¤í…œ ì‹œìž‘íŒŒì¼ ë“±ê³¼ ê°™ì€ í™˜ê²½ë³€ìˆ˜ íŒŒì¼ì˜ ì ‘ê·¼ê¶Œí•œ ì„¤ì •ì´ ì ì ˆí•˜ì§€ ì•Šì„ ê²½ìš° ë¹„ì¸ê°€ìžê°€ í™˜ê²½ë³€ìˆ˜ íŒŒì¼ì„ ë³€ì¡°í•˜ì—¬ ì •ìƒ ì‚¬ìš©ì¤‘ì¸ ì‚¬ìš©ìžì˜ ì„œë¹„ìŠ¤ê°€ ì œí•œ ë  ìˆ˜ ìžˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜: í™ˆ ë””ë ‰í„°ë¦¬ í™˜ê²½ë³€ìˆ˜ íŒŒì¼ ì†Œìœ ìžê°€ root ë˜ëŠ”, í•´ë‹¹ ê³„ì •ìœ¼ë¡œ ì§€ì •ë˜ì–´ ìžˆê³ , í™ˆ ë””ë ‰í„°ë¦¬ í™˜ê²½ë³€ìˆ˜ íŒŒì¼ì— rootì™€ ì†Œìœ ìžë§Œ ì“°ê¸° ê¶Œí•œì´ ë¶€ì—¬ëœ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: í™ˆ ë””ë ‰í„°ë¦¬ í™˜ê²½ë³€ìˆ˜ íŒŒì¼ ì†Œìœ ìžê°€ root ë˜ëŠ”, í•´ë‹¹ ê³„ì •ìœ¼ë¡œ ì§€ì •ë˜ì§€ ì•Šê³ , í™ˆ ë””ë ‰í„°ë¦¬ í™˜ê²½ë³€ìˆ˜ íŒŒì¼ì— rootì™€ ì†Œìœ ìž ì™¸ì— ì“°ê¸° ê¶Œí•œì´ ë¶€ì—¬ëœ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-14 ì ê²€ ê²°ê³¼" >> $result
u14_Files_Directory_Management=0
u14_safe_check=0
u14=0

u14_home_Environmental_files=(
    ".profile"
    ".kshrc"
    ".cshrc"
    ".bashrc"
    ".bash_profile"
    ".login"
    ".exrc"
    ".netrc"
    ".bash_logout"
    ".env"
    ".zshrc"
    ".zprofile"
)

u14_check_users=($(cat /etc/passwd | egrep -v '/sbin|false|sync' | awk -F':' '{print $1}'))
for u14_check_user in "${u14_check_users[@]}";do
    u14_user_home=($(getent passwd "$u14_check_user" | awk -F':' '{print$6}'))
    if [ -d "$u14_user_home" ];then
        echo "--------------------------------------" >> $target
        echo "$u14_check_user ì˜ í™ˆ ë””ë ‰í„°ë¦¬ê°€ ì¡´ìž¬í•©ë‹ˆë‹¤." >> $target
        for u14_home_Environmental_file in "${u14_home_Environmental_files[@]}";do
            echo -e "${RED}Checking file: $u14_user_home/$u14_home_Environmental_file${NC}" >> $target
            if [ -e "$u14_user_home/$u14_home_Environmental_file" ];then
                echo "$u14_user_home/$u14_home_Environmental_file íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤." >> $target
                u14_file_owner=$(ls -l "$u14_user_home/$u14_home_Environmental_file" | awk '{print $4}')
                if [[ "$u14_file_owner" == "root" ]] || [[ "$u14_file_owner" == "$u14_check_user" ]]; then
                    echo "$u14_user_home/$u14_home_Environmental_file íŒŒì¼ì˜ ì†Œìœ ìžê°€ root í˜¹ì€ í•´ë‹¹ ê³„ì •ìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target 
                    u14_permissions=$(stat -c "%A" "$u14_user_home/$u14_home_Environmental_file")
                    u14_group_perm=$(echo "$u14_permissions" | cut -c6)
                    u14_other_perm=$(echo "$u14_permissions" | cut -c9)
                    if [ "$u14_group_perm" == "w" ] || [ "$u14_other_perm" == "w" ]; then 
                        echo "$u14_user_home/$home_Environmental_file íŒŒì¼ì˜ ì†Œìœ ìž ë° root ì™¸ì— ê¸°íƒ€ì‚¬ìš©ìž(Other)ì— ëŒ€í•œ ì“°ê¸° ê¶Œí•œì´ ë¶€ì—¬ë˜ì–´ ìžˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                        u14_safe_check=$((u14_safe_check+1))
                    else
                        echo "$u14_user_home/$u14_home_Environmental_file íŒŒì¼ì˜ ì†Œìœ ìž ë° root ì™¸ì— ê¸°íƒ€ì‚¬ìš©ìž(Other)ì— ëŒ€í•œ ì“°ê¸° ê¶Œí•œì´ ë¶€ì—¬ë˜ì–´ ìžˆì§€ ì•Šì•„ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
                    fi
                else
                    echo "echo "$u14_user_home/$u14_home_Environmental_file íŒŒì¼ì˜ ì†Œìœ ìžê°€ root í˜¹ì€ í•´ë‹¹ ê³„ì •ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆì§€ ì•Šì•„ ì·¨ì•½í•©ë‹ˆë‹¤."" >> $target
                    u14_safe_check=$((u14_safe_check+1))
                fi
            else
                echo "$u14_user_home/$u14_home_Environmental_file íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
            fi
        done
    fi
done

if [[ $u14_safe_check -ge 1 ]];then
    u14=$((u14+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u14 -ge 1 ]];then
    High=$((High+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u14_Files_Directory_Management=1
fi