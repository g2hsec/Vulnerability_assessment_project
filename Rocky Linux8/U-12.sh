cat << EOF
===== [U-12] /etc/services file owner and permission settings               =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-12   /etc/services íŒŒì¼ ì†Œìœ ìž ë° ê¶Œí•œ ì„¤ì •                        " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : /etc/services íŒŒì¼ì„ ê´€ë¦¬ìžë§Œ ì œì–´í•  ìˆ˜ ìžˆê²Œ í•˜ì—¬ ë¹„ì¸ê°€ìžë“¤ì˜ ìž„ì˜ì ì¸ íŒŒì¼ ë³€ì¡°ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : services íŒŒì¼ì˜ ì ‘ê·¼ê¶Œí•œì´ ì ì ˆí•˜ì§€ ì•Šì„ ê²½ìš° ë¹„ì¸ê°€ ì‚¬ìš©ìžê°€ ìš´ì˜ í¬íŠ¸ë²ˆí˜¸ë¥¼ ë³€ê²½í•˜ì—¬ ì •ìƒì ì¸ ì„œë¹„ìŠ¤ë¥¼ ì œí•œí•˜ê±°ë‚˜, í—ˆìš©ë˜ì§€ ì•Šì€ í¬íŠ¸ë¥¼ ì˜¤í”ˆí•˜ì—¬ ì•…ì„± ì„œë¹„ìŠ¤ë¥¼ ì˜ë„ì ìœ¼ë¡œ ì‹¤í–‰í•  ìˆ˜ ìžˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜: /etc/services íŒŒì¼ì˜ ì†Œìœ ìžê°€ root(ë˜ëŠ” bin, sys)ì´ê³ , ê¶Œí•œì´ 644 ì´í•˜ì¸ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: /etc/services íŒŒì¼ì˜ ì†Œìœ ìžê°€ root(ë˜ëŠ” bin, sys)ê°€ ì•„ë‹ˆê±°ë‚˜, ê¶Œí•œì´ 644 ì´í•˜ê°€ ì•„ë‹Œ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-12 ì ê²€ ê²°ê³¼" >> $result
u12=0
u12_Files_Directory_Management=0
u12_safe_check=0
if [[ -e "/etc/services" ]];then
    echo "/etc/services íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤." >> $target
    u12_file_owner_user=$(stat -c "%U" "/etc/services" 2> /dev/null)
    u12_file_owner=$(stat -c "%a" "/etc/services"  2> /dev/null| cut -c1)
    u12_file_group=$(stat -c "%a" "/etc/services"  2> /dev/null| cut -c2)
    u12_file_other=$(stat -c "%a" "/etc/services"  2> /dev/null| cut -c3)
    u12_check_suid=$(stat -c "%a" "/etc/services"  2> /dev/null| tr -d '\n' | wc -c)
    if [[ $u12_check_suid -ge 4 ]];then
        echo "$u12_file íŒŒì¼ì— SUID ê°€ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤. [ìž˜ëª»ëœ SUID ì„¤ì •]" >> $target
        u12_safe_check=$((u12_safe_check+1))
    else
        if [[ $u12_file_owner_user == "root" || $u12_file_owner_user == "bin" || $u12_file_owner_user == "sys" ]];then
            echo "$syslog_file íŒŒì¼ì˜ ì†Œìœ ìžê°€ root, bin, sysë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
            if [ $u12_file_owner -le 6 ];then
                echo "/etc/services íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                if [ $u12_file_group -le 4 ];then
                    echo "/etc/services íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 4ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                    if [ $u12_file_other -le 4 ];then
                        echo "/etc/services íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ìž(Other) ê¶Œí•œì´ 4 ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                    else
                        echo "/etc/services íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ìž(Other) ê¶Œí•œì´ 4 ì´ìƒì˜ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                        u12_safe_check=$((u12_safe_check+1))
                    fi
                else
                    echo "/etc/services íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 4 ì´ìƒì˜ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                    u12_safe_check=$((u12_safe_check+1))
                fi
            else
                echo "/etc/services íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 4 ì´ìƒì˜ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                u12_safe_check=$((u12_safe_check+1)) 
            fi
        else
            echo "/etc/services íŒŒì¼ì˜ ì†Œìœ ìžê°€ root, bin, sysê°€ ì•„ë‹Œ ë‹¤ë¥¸ ì‚¬ìš©ìžë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
            u12_safe_check=$((u12_safe_check+1))
        fi 
    fi
else
    echo "/etc/services íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    u12=$((u12+1))
fi

if [[ $u12_safe_check -ge 1 ]];then
    u12=$((u12+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u12 -ge 1 ]];then
    High=$((High+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u12_Files_Directory_Management=1
fi