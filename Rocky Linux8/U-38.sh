cat << EOF
===== [U-38] Remove unnecessary Web Services files              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-38 ì›¹ì„œë¹„ìŠ¤ ë¶ˆí•„ìš”í•œ íŒŒì¼ ì œê±°              " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : Apache ì„¤ì¹˜ ì‹œ ë””í´íŠ¸ë¡œ ì„¤ì¹˜ë˜ëŠ” ë¶ˆí•„ìš”í•œ íŒŒì¼ì„ ì œê±°í•¨ì„ ëª©ì ìœ¼ë¡œ í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : Apache ì„¤ì¹˜ ì‹œ htdocs ë””ë ‰í„°ë¦¬ ë‚´ì— ë§¤ë‰´ì–¼ íŒŒì¼ì€ ì‹œìŠ¤í…œ ê´€ë ¨ì •ë³´ë¥¼ ë…¸ì¶œí•˜ê±°ë‚˜ í•´í‚¹ì— ì•…ìš©ë  ìˆ˜ ìžˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜: ê¸°ë³¸ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ë¶ˆí•„ìš”í•œ íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ê°€ ì œê±°ë˜ì–´ ìžˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: ê¸°ë³¸ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ë¶ˆí•„ìš”í•œ íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ê°€ ì œê±°ë˜ì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
u38=0
u38_safe_check=0
u38_Service_Management=0
echo "Apache ë° Nginx ì— ëŒ€í•´ ì„¤ì¹˜ ì‹œ ë””í´íŠ¸ë¡œ ì„¤ì¹˜ë˜ëŠ” ë¶ˆí•„ìš”í•œ íŒŒì¼ì„ íƒìƒ‰í•©ë‹ˆë‹¤." >> $target
u38_unnecessary_dirs=("/usr/share/doc/httpd/" "/usr/share/httpd/" "/usr/share/doc/apache2" "/usr/share/examples/apache2" "/etc/httpd/conf/htdocs/manual" "/etc/httpd/conf/manual" "/var/www/error/" "/var/www/icons/" "/var/www/cgi-bin/" "/usr/share/doc/nginx/" "/usr/share/nginx/modules/" "/usr/share/nginx/html/" "/usr/share/examples/nginx")
u38_unnecessary_files=("/etc/apache2/sites-available/000-default.conf" "/usr/share/man/man8/httpd.8.gz" "/etc/httpd/conf.d/welcome.conf" "/etc/httpd/conf.d/autoindex.conf" "/var/www/html/index.html" "/var/www/html/favicon.ico" "/etc/httpd/conf.d/welcome.conf" "/usr/share/man/man1/apache2.1.gz""/usr/share/nginx/html/index.html" "/usr/share/nginx/html/50x.html" "/usr/share/nginx/html/favicon.ico" "/etc/nginx/conf.d/default.conf" "/usr/share/man/man1/nginx.1.gz" "/usr/share/man/man8/nginx.8.gz")
u38_unnecessary_files_sample=("/var/www/html/*.png" "/var/www/html/*.gif")
u38_apache_home_checks=("httpd.conf" "apache2.conf" ".htaccess")
u38_idx=0
#/etc/nginx/sites-available/default -> debian 
# /etc/httpd/conf.d/welcome.conf -> REHL
echo "apache, nginx ì˜ ì£¼ìš” ì„¤ì •íŒŒì¼ì„ í† ëŒ€ë¡œ apache í™ˆ ë””ë ‰í„°ë¦¬ ì ê²€ í›„ ì¶”ê°€ ì„¤ì • íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ë¥¼ ì ê²€í•˜ë¯€ë¡œ, ì¤‘ë³µëœ ê²°ê³¼ê°€ ì¡´ìž¬í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤." >> $target
for u38_apache_home_check in "${u38_apache_home_checks[@]}";do
    u38_apache_home=$(find / -type f -name "$u38_apache_home_check" 2> /dev/null | egrep -v "tmp|temp|swap|swp")
    if [ -f "$u38_apache_home" ];then
        u38_documentroot=$(grep -i 'documentroot' "$u38_apache_home" | grep -v "#" | awk '{print $2}' | tr -d '"')
        if [ -n "$u38_documentroot" ];then
            u38_unnecessary_apache_home=$(ls -d "$u38_documentroot/htdocs/manual" 2> /dev/null)
            if [ -d "$u38_unnecessary_apache_home" ];then
                echo "$u38_unnecessary_apache_home ê²½ë¡œê°€ ì¡´ìž¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëžë‹ˆë‹¤." >> $target
                u38_safe_check=$((u38_safe_check+1))
                for u38_unnecessary_apache_file in "$u38_unnecessary_apache_home/*";do
                    if [ -f "$u38_unnecessary_apache_file" ];then
                        echo "$u38_unnecessary_apache_file íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëžë‹ˆë‹¤." >> $target
                        u38_safe_check=$((u38_safe_check+1))
                    elif [ -d "$u38_unnecessary_apache_file" ];then
                        echo "$u38_unnecessary_apache_file ë””ë ‰í„°ë¦¬ê°€ ì¡´ìž¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëžë‹ˆë‹¤." >> $target
                        u38_safe_check=$((u38_safe_check+1))
                        echo "$u38_unnecessary_apache_file ë””ë ‰í„°ë¦¬ë¥¼ ìž¬ê·€ì ìœ¼ë¡œ íƒìƒ‰í•©ë‹ˆë‹¤." >> $target
                        echo "$(tree $u38_unnecessary_apache_file)" >> $target
                    else
                        u38_idx=$((u38_idx+1))
                    fi
                done
                if [ $u38_idx -eq 0 ];then
                    echo "$u38_unnecessary_apache_home ê²½ë¡œ ë‚´ì— íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ê°€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                fi
            else
                u38_unnecessary_apache_home=$(ls -d "$u38_documentroot/manual" 2> /dev/null)
                if [ -d "$u38_unnecessary_apache_home" ];then
                    echo "$u38_unnecessary_apache_home ê²½ë¡œê°€ ì¡´ìž¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëžë‹ˆë‹¤." >> $target
                    u38_safe_check=$((u38_safe_check+1))
                    for u38_unnecessary_apache_file in "$u38_unnecessary_apache_home/*";do
                        if [ -f "$u38_unnecessary_apache_file" ];then
                            echo "$u38_unnecessary_apache_file íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëžë‹ˆë‹¤." >> $target
                            u38_safe_check=$((u38_safe_check+1))
                        elif [ -d "$u38_unnecessary_apache_file" ];then
                            echo "$u38_unnecessary_apache_file ë””ë ‰í„°ë¦¬ê°€ ì¡´ìž¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëžë‹ˆë‹¤." >> $target
                            u38_safe_check=$((u38_safe_check+1))
                            echo "$u38_unnecessary_apache_file ë””ë ‰í„°ë¦¬ë¥¼ ìž¬ê·€ì ìœ¼ë¡œ íƒìƒ‰í•©ë‹ˆë‹¤." >> $target
                            echo "$(tree $u38_unnecessary_apache_file)" >> $target
                        else
                            u38_idx=$((u38_idx+1))

                        fi
                    done
                    if [ $u38_idx -eq 0 ];then
                        echo "$u38_unnecessary_apache_home ê²½ë¡œ ë‚´ì— íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ê°€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    fi
                fi
            fi
        else
            for i in "/etc/httpd/conf.d/*";do
                u38_documentroot=$(grep -i 'documentroot' /etc/httpd/conf.d/* | grep -v "#" | awk -F':' '{print $2}' | awk '{print $2}' | tr -d '"')
                if [ -n "$u38_documentroot" ];then
                    u38_unnecessary_apache_home=$(ls -ld "$u38_documentroot/htdocs/manual" 2> /dev/null)
                    if [ -d "$u38_unnecessary_apache_home" ];then
                        echo "$u38_unnecessary_apache_home ê²½ë¡œê°€ ì¡´ìž¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëžë‹ˆë‹¤." >> $target
                        u38_safe_check=$((u38_safe_check+1))
                        for u38_unnecessary_apache_file in "$u38_unnecessary_apache_home/*";do
                            if [ -f "$u38_unnecessary_apache_file" ];then
                                echo "$u38_unnecessary_apache_file íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëžë‹ˆë‹¤." >> $target
                                u38_safe_check=$((u38_safe_check+1))
                            elif [ -d "$u38_unnecessary_apache_file" ];then
                                echo "$u38_unnecessary_apache_file ë””ë ‰í„°ë¦¬ê°€ ì¡´ìž¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëžë‹ˆë‹¤." >> $target
                                u38_safe_check=$((u38_safe_check+1))
                                echo "$u38_unnecessary_apache_file ë””ë ‰í„°ë¦¬ë¥¼ ìž¬ê·€ì ìœ¼ë¡œ íƒìƒ‰í•©ë‹ˆë‹¤." >> $target
                                echo "$(tree $u38_unnecessary_apache_file)" >> $target
                            else
                                u38_idx=$((u38_idx+1))

                            fi
                        done
                        if [ $u38_idx -eq 0 ];then
                            echo "$u38_unnecessary_apache_home ê²½ë¡œ ë‚´ì— íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ê°€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                        fi
                    else
                        u38_unnecessary_apache_home=$(ls -ld "$u38_documentroot/manual" 2> /dev/null)
                        if [ -d "$u38_unnecessary_apache_home" ];then
                            echo "$u38_unnecessary_apache_home ê²½ë¡œê°€ ì¡´ìž¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëžë‹ˆë‹¤." >> $target
                            u38_safe_check=$((u38_safe_check+1))
                            for u38_unnecessary_apache_file in "$u38_unnecessary_apache_home/*";do
                                if [ -f "$u38_unnecessary_apache_file" ];then
                                    echo "$u38_unnecessary_apache_file íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëžë‹ˆë‹¤." >> $target
                                    u38_safe_check=$((u38_safe_check+1))
                                elif [ -d "$u38_unnecessary_apache_file" ];then
                                    echo "$u38_unnecessary_apache_file ë””ë ‰í„°ë¦¬ê°€ ì¡´ìž¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëžë‹ˆë‹¤." >> $target
                                    u38_safe_check=$((u38_safe_check+1))
                                    echo "$u38_unnecessary_apache_file ë””ë ‰í„°ë¦¬ë¥¼ ìž¬ê·€ì ìœ¼ë¡œ íƒìƒ‰í•©ë‹ˆë‹¤." >> $target
                                    echo "$(tree $u38_unnecessary_apache_file)" >> $target
                                else
                                    u38_idx=$((u38_idx+1))

                                fi
                            done
                            if [ $u38_idx -eq 0 ];then
                                echo "$u38_unnecessary_apache_home ê²½ë¡œ ë‚´ì— íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ê°€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                            fi
                        fi
                    fi
                fi
            done
        fi     
    fi
done
u38_idx=0
for u38_unnecessary_dir in "${u38_unnecessary_dirs[@]}";do
    echo "$u38_unnecessary_dir ê²½ë¡œì— ëŒ€í•´ ì ê²€í•©ë‹ˆë‹¤." >> $target
    if [ -d "$u38_unnecessary_dir" ];then
         for u38_dected_file in "$u38_unnecessary_dir";do
            if [ -f "$u38_dected_file" ];then
                echo "$u38_unnecessary_dir ê²½ë¡œì—ì„œ $u38_dected_file íŒŒì¼ì´ ì‹ë³„ë˜ì—ˆìŠµë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ íŒŒì¼ì¼ ê²½ìš° ì‚­ì œ ë°”ëžë‹ˆë‹¤." >> $target
                u38_safe_check=$((u38_safe_check+1))
            elif [ -d "$u38_dected_file" ];then
                echo "$u38_dected_file ë””ë ‰í„°ë¦¬ê°€ ì¡´ìž¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëžë‹ˆë‹¤." >> $target
                u38_safe_check=$((u38_safe_check+1))
                echo "$u38_dected_file ë””ë ‰í„°ë¦¬ë¥¼ ìž¬ê·€ì ìœ¼ë¡œ íƒìƒ‰í•©ë‹ˆë‹¤." >> $target
                echo "$(tree $u38_dected_file)" >> $target
            else
                u38_idx=$((u38_idx+1))

            fi
         done
    else
        echo "$u38_unnecessary_dir ê²½ë¡œê°€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi  
done

for u38_unnecessary_file in "${u38_unnecessary_files[@]}";do
    if [ -f "$u38_unnecessary_file" ];then
        echo "$u38_unnecessary_file íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œê²½ìš° ì‚­ì œ ë°”ëžë‹ˆë‹¤." >> $target
        u38_safe_check=$((u38_safe_check+1))
        u38_idx=$((u38_idx+1))
    else
        echo "$u38_unnecessary_file íŒŒì¼ì€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
done
if [ $u38_idx -eq 0 ];then
    echo "ê¸°ë³¸ì ìœ¼ë¡œ ë¶ˆí•„ìš”í•œ íŒŒì¼ì€ ë°œê²¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì¶”ê°€ì ì¸ ìˆ˜ë™ ì ê²€ì„ ê¶Œìž¥í•©ë‹ˆë‹¤." >> $target
fi
for u38_unnecessary_file_sample in "$u38_unnecessary_files_sample";do
    if [ -f "$u38_unnecessary_file_sample" ];then >> $target
        echo "$u38_unnecessary_file_sample íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëžë‹ˆë‹¤." >> $target
        u38_safe_check=$((u38_safe_check+1))
    fi
done

if [[ $u38_safe_check -ge 1 ]];then
    u38=$((u38+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u38 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u38_Service_Management=1
fi