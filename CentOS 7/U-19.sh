cat << EOF
===== [U-19] Access IP and Port Restrictions              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-19 Finger ì„œë¹„ìŠ¤ ë¹„í™œì„±í™”             " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : Finger(ì‚¬ìš©ìž ì •ë³´ í™•ì¸ ì„œë¹„ìŠ¤)ë¥¼ í†µí•´ì„œ ë„¤íŠ¸ì›Œí¬ ì™¸ë¶€ì—ì„œ í•´ë‹¹ ì‹œìŠ¤í…œì— ë“±ë¡ëœ ì‚¬ìš©ìž ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìžˆì–´ ë¹„ì¸ê°€ìžì—ê²Œ ì‚¬ìš©ìž ì •ë³´ê°€ ì¡°íšŒë˜ëŠ” ê²ƒì„ ì°¨ë‹¨í•˜ê³ ìž í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ë¹„ì¸ê°€ìžì—ê²Œ ì‚¬ìš©ìž ì •ë³´ê°€ ì¡°íšŒë˜ì–´ íŒ¨ìŠ¤ì›Œë“œ ê³µê²©ì„ í†µí•œ ì‹œìŠ¤í…œ ê¶Œí•œ íƒˆì·¨ ê°€ëŠ¥ì„±ì´ ìžˆìœ¼ë¯€ë¡œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ í•´ë‹¹ ì„œë¹„ìŠ¤ë¥¼ ì¤‘ì§€í•˜ì—¬ì•¼ í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜: Finger ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„±í™” ë˜ì–´ ìžˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: Finger ì„œë¹„ìŠ¤ê°€ í™œì„±í™” ë˜ì–´ ìžˆëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-19 ì ê²€ ê²°ê³¼" >> $result
u19_Service_Management=0
u19_safe_check=0
u19=0
#finger ì„œë¹„ìŠ¤ëŠ” ë³´í†µ systemctlì´ë‚˜ pgrep ëª…ë ¹ì–´ë¡œëŠ” ë°”ë¡œ í™•ì¸í•  ìˆ˜ ì—†ìŒ
if [ -f "/etc/inetd.conf" ];then
    if grep -iqE "^\s*finger\s*stream\s*tcp\s*nowait\s*bin" "/etc/inetd.conf";then
        echo "/etc/inetd.conf íŒŒì¼ì— Finger ì„œë¹„ìŠ¤ê°€ í™œì„±í™” ë˜ì–´ ìžˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
        u19_safe_check=$((u19_safe_check+1))
    elif grep -iqE "^#\s*finger\s*stream\s*tcp\s*nowait\s*bin" "/etc/inetd.conf";then
        echo "/etc/inetd.conf íŒŒì¼ì— Finger ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„±í™” ë˜ì–´ ìžˆì–´ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
    else
        echo "/etc/inetd.conf íŒŒì¼ ë‚´ì— Finger ì„¤ì • í•­ëª©ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
elif [ -f "/etc/xinetd.d/finger" ];then
    u19_fingerconf=$(sed -n '/service finger/,/}/p' "/etc/xinetd.d/finger" | grep -v "^#" | grep -iE "^\s*disable" | awk '{print tolower($3)}' | sed -n '1p')
    u19_lower_string=$(echo "$u19_fingerconf" | tr '[:upper:]' '[:lower:]')
    if [[ $u19_lower_string == "no" ]];then
        echo "/etc/xinerd.d/finger ì„¤ì • íŒŒì¼ ë‚´ì— finger ì„œë¹„ìŠ¤ê°€ í™œì„±í™” ë˜ì–´ ìžˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
        u19_safe_check=$((u19_safe_check+1))
    elif [[ $u19_lower_string == "yes" ]];then
        echo "/etc/xinetd.d/finger ì„¤ì • íŒŒì¼ ë‚´ì— finger ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„±í™” ë˜ì–´ ìžˆì–´ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
    else
        echo "/etc/xinetd.d/finger ì„¤ì • íŒŒì¼ ë‚´ì— finger ì„œë¹„ìŠ¤ í•­ëª©ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
else
    echo "/etc/inetd.conf íŒŒì¼ ë° /etc/xinetd.d/finger íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [[ $u19_safe_check -ge 1 ]];then
    u19=$((u19+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u19 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u19_Service_Management=1
fi