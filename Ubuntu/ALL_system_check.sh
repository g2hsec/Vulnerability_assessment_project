#!/bin/bash

# bash shellë¡œ ì‹¤í–‰ ì‹œí‚¤ì„¸ìš”.
if [ "$EUID" -ne 0 ]
        then echo "root ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰ì‹œí‚¤ì„¸ìš”."
        exit
fi

#yum install tree
RED='\033[31m'
NC='\033[0m' # No Color
hostname=$(hostname)
date_time=$(date '+%Y%m%d-%H%M%S')
release=$(cat /etc/lsb-release )
info=$(uname -a)

target="./${hostname}.${date_time}.detail"
result="./${hostname}.${date_time}.result"

rm -f $target
rm -f $result
severity_total="./severity_total"
echo -n > "$severity_total"

High=0
Mid=0
Low=0
Account_Management=0
Files_Directory_Management=0
Service_Management=0
Patch_Management=0
Log_Management=0
#ì„œë¹„ìŠ¤ ì ê²€ í•¨ìˆ˜
check_service_status() {
    local port_numbers=("$1")  # ì²« ë²ˆì§¸ ì¸ìëŠ” í¬íŠ¸ ë²ˆí˜¸ ë°°ì—´ ë˜ëŠ” ë‹¨ì¼ í¬íŠ¸ ë²ˆí˜¸
    shift  # ì²« ë²ˆì§¸ ì¸ìë¥¼ ì œê±°í•˜ê³  ë‚˜ë¨¸ì§€ ì¸ìë“¤ì„ ì„œë¹„ìŠ¤ ì´ë¦„ìœ¼ë¡œ ì„¤ì •

    local services=("$@")  # ë‚˜ë¨¸ì§€ ì¸ìë¥¼ ë°°ì—´ì— ì €ì¥
    local any_service_active=0  # í”Œë˜ê·¸ ì´ˆê¸°í™”

    for i in "${!services[@]}"; do
        local service_name=${services[$i]}
        local port_number=${port_numbers[$i]:-0}  # í¬íŠ¸ ë²ˆí˜¸ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ 0

        echo "Checking $service_name..." >> "$target"

        # ì„œë¹„ìŠ¤ í™œì„±í™” ì—¬ë¶€ ì²´í¬
        if systemctl is-active --quiet "$service_name"; then
            echo "í˜„ì¬ ì‹œìŠ¤í…œì— $service_name ì„œë¹„ìŠ¤ê°€ í™œì„±í™” ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ë¹„í™œì„±í™”ê°€ ì´ë£¨ì–´ì ¸ì•¼ í•©ë‹ˆë‹¤." >> "$target"
            any_service_active=1  # í”Œë˜ê·¸ë¥¼ 1ë¡œ ì„¤ì •
        else
            echo "í˜„ì¬ ì‹œìŠ¤í…œì— $service_name ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„±í™” ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> "$target"
        fi

        # ë„¤íŠ¸ì›Œí¬ í¬íŠ¸ ì²´í¬
        local netstat_ports=$(netstat -tuln | awk '{print $4}' | awk -F':' '{print $2}')

        if [ $port_number -ne 0 ] && echo "$netstat_ports" | grep -qE "^$port_number$"; then
            echo "$service_name ì„œë¹„ìŠ¤ê°€ $port_number í¬íŠ¸ë²ˆí˜¸ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> "$target"
            echo "$service_name ì„œë¹„ìŠ¤ê°€ $port_number ë²ˆ í¬íŠ¸ë²ˆí˜¸ë¡œ ì„œë¹„ìŠ¤ê°€ ë™ì‘ì¤‘ì…ë‹ˆë‹¤." >> "$target"
        else
            local new_port=$(grep -wE "^$service_name\s+" /etc/services | awk '{print $2}' | awk -F'/' '{print $1}' | head -n 1)
            if [ -n "$new_port" ]; then
                echo "$service_name ì„œë¹„ìŠ¤ê°€ $new_port í¬íŠ¸ë²ˆí˜¸ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> "$target"
                if echo "$netstat_ports" | grep -qE "^$new_port$"; then
                    echo "$service_name ì„œë¹„ìŠ¤ê°€ $new_port í¬íŠ¸ë²ˆí˜¸ë¡œ ì„œë¹„ìŠ¤ê°€ ë™ì‘ì¤‘ì…ë‹ˆë‹¤." >> "$target"
                else
                    echo "$service_name ì„œë¹„ìŠ¤ê°€ $new_port í¬íŠ¸ë²ˆí˜¸ë¡œ ë™ì‘ì¤‘ì¸ ì„œë¹„ìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤." >> "$target"
                fi
            else
                echo "$service_name ì„œë¹„ìŠ¤ê°€ /etc/services íŒŒì¼ì— ì •ì˜ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> "$target"
            fi
        fi

        # inetd ì„œë¹„ìŠ¤ ì²´í¬
        if [ -f "/etc/inetd.conf" ]; then
            if grep -qiwE "^\s*$service_name" /etc/inetd.conf; then
                echo "/etc/inetd.conf íŒŒì¼ì—ì„œ $service_name ì„œë¹„ìŠ¤ê°€ í™œì„±í™” ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> "$target"
            else
                echo "/etc/inetd.conf íŒŒì¼ì—ì„œ $service_name ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„±í™” ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> "$target"
            fi
        else
            echo "/etc/inetd.conf íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> "$target"
        fi

        # xinetd ì„œë¹„ìŠ¤ ì²´í¬
        if [ -d "/etc/xinetd.d" ]; then
            if [ -f "/etc/xinetd.d/$service_name" ]; then
                local xinetd_conf=$(grep -iE "\s*disable" "/etc/xinetd.d/$service_name" | grep -v "^#" | awk '{print $3}' | head -n 1)
                if [[ "$xinetd_conf" == "no" ]]; then
                    echo "/etc/xinetd.d/$service_name íŒŒì¼ë‚´ì— $service_name í•­ëª©ì´ í™œì„±í™” ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> "$target"
                else
                    echo "/etc/xinetd.d/$service_name íŒŒì¼ë‚´ì— $service_name í•­ëª©ì´ ë¹„í™œì„±í™” ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> "$target"
                fi
            else
                echo "/etc/xinetd.d/$service_name íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> "$target"
            fi
        else
            echo "/etc/xinetd.d ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> "$target"
        fi

        echo "Finished checking $service_name." >> "$target"
        echo "" >> "$target"  # ë¹ˆ ì¤„ ì¶”ê°€
    done

    # ë™ì‘ ì¤‘ì¸ ì„œë¹„ìŠ¤ê°€ í•˜ë‚˜ë¼ë„ ìˆìœ¼ë©´ 1ì„ ì¶œë ¥
    if [ $any_service_active -eq 1 ]; then
        return 1
    else
        return 0
    fi
}
cat << EOF
===== [U-01] Remote Login Permission for the root User  =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-01 root ê³„ì • ì›ê²© ì ‘ì† ì œí•œ                         "  >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ê´€ë¦¬ìê³„ì • íƒˆì·¨ë¡œ ì¸í•œ ì‹œìŠ¤í…œ ì¥ì•…ì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ì™¸ë¶€ ë¹„ì¸ê°€ìì˜ root ê³„ì • ì ‘ê·¼ ì‹œë„ë¥¼ ì›ì²œì ìœ¼ë¡œ ì°¨ë‹¨í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : root ê³„ì •ì€ ìš´ì˜ì²´ì œì˜ ëª¨ë“ ê¸°ëŠ¥ì„ ì„¤ì • ë° ë³€ê²½ì´ ê°€ëŠ¥í•˜ì—¬(í”„ë¡œì„¸ìŠ¤, ì»¤ë„ë³€ê²½ ë“±) root ê³„ì •ì„ íƒˆì·¨í•˜ì—¬ ì™¸ë¶€ì—ì„œ ì›ê²©ì„ ì´ìš©í•œ ì‹œìŠ¤í…œ ì¥ì•… ë° ê°ì¢… ê³µê²©ìœ¼ë¡œ(ë¬´ì‘ìœ„ ëŒ€ì… ê³µê²©) ì¸í•œ root ê³„ì • ì‚¬ìš© ë¶ˆê°€ ìœ„í˜‘" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ì›ê²© í„°ë¯¸ë„ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê±°ë‚˜, ì‚¬ìš© ì‹œ root ì§ì ‘ ì ‘ì†ì„ ì°¨ë‹¨í•œ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ì›ê²© í„°ë¯¸ë„ ì„œë¹„ìŠ¤ ì‚¬ìš© ì‹œ root ì§ì ‘ ì ‘ì†ì„ í—ˆìš©í•œ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-1 ì ê²€ ê²°ê³¼" >> $result
u1=0
u1_safe_check=0
u1_Account_Management=0
telnet_access_check() {
    if [ -f "/etc/securetty" ]; then
        echo "/etc/securetty íŒŒì¼: ì¡´ì¬í•¨" >> "$target"
        if grep -q "pts" "/etc/securetty"; then
            echo "  - pts í•­ëª©: ë°œê²¬ë¨ " >> "$target"
            u1_safe_check=$((u1_safe_check+1))
        else
            echo "  - pts í•­ëª©: ë°œê²¬ë˜ì§€ ì•ŠìŒ" >> "$target"
        fi
    else
        echo "/etc/securetty íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> "$target"
    fi
    
    if [ -f "/etc/pam.d/login" ]; then
        echo "/etc/pam.d/login íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> "$target"
        if grep -qiE "^\s*#\s*auth\s*required\s*/lib/security/pam_securetty.so" "/etc/pam.d/login"; then
            echo 'auth required /lib/security/pam_securetty.so í•­ëª©ì´ ì£¼ì„ì²˜ë¦¬ ë˜ì–´ ìˆìŠµë‹ˆë‹¤.' >> "$target"
            u1_safe_check=$((u1_safe_check+1))
        else
            if grep -qiE "^\s*auth\s*required\s*/lib/security/pam_securetty.so" "/etc/pam.d/login"; then
                echo "auth required /lib/security/pam_securetty.so í•­ëª©: ë°œê²¬ë¨" >> "$target"
            else
                echo "auth required /lib/security/pam_securetty.so í•­ëª©: ë¹„í™œì„±í™”" >> "$target"
                u1_safe_check=$((u1_safe_check+1))
            fi
        fi
    else
        echo "/etc/pam.d/login íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> "$target"
    fi
    if [[ $u1_safe_check -ge 1 ]];then
        echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½"
        u1=$((u1+1))
    else
        echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸"
    fi
}
if pgrep "telnetd" > /dev/null; then
    echo "Telnet ì„œë¹„ìŠ¤: ë™ì‘ ì¤‘"
    telnet_access_check	
else
    if grep -q '^telnet[[:space:]]*23/tcp' /etc/services; then
        if sudo netstat -tuln | grep :23  > /dev/null; then
            telnet_access_check
        else
	    echo 'telnet í”„ë¡œì„¸ìŠ¤: ë™ì‘ ì¤‘ì´ ì•„ë‹˜' >> $target
        fi
    else
        echo 'telnet ê¸°ë³¸ í¬íŠ¸ 23ìœ¼ë¡œ ì„¤ì •ë˜ì–´ìˆì§€ ì•ŠìŒ' >> $target
        u1_telnet_newport=$(grep '^telnet[[:space:]]' /etc/services | awk '{print $2}' | cut -d'/' -f1)
        if sudo netstat -tuln | grep :$u1_telnet_newport  > /dev/null; then
            telnet_access_check
        else
	    echo 'telnet í”„ë¡œì„¸ìŠ¤: ë™ì‘ ì¤‘ì´ ì•„ë‹˜' >> $target
        fi
    fi
fi
ssh_access_check() {
    # /etc/ssh/sshd_config íŒŒì¼ ì²´í¬
    if [ -f "/etc/ssh/sshd_config" ]; then
        echo "/etc/ssh/sshd_config íŒŒì¼: ì¡´ì¬í•¨" >> "$target"
        if grep -iqE "^\s*#\s*PermitRootLogin" "/etc/ssh/sshd_config"; then
            echo 'PermitRootLogin í•­ëª©ì´ ì£¼ì„ì²˜ë¦¬ ë˜ì–´ìˆìŠµë‹ˆë‹¤. : ë¹„í™œì„±í™”' >> "$target"
            u1_safe_check=$((u1_safe_check+1))
        else
            if grep -iE '^\s*PermitRootLogin' "/etc/ssh/sshd_config" | awk '{print tolower($2)}' | grep -iq 'yes'; then
                echo "  - PermitRootLogin Yes : ë°œê²¬ë¨" >> "$target"
                u1_safe_check=$((u1_safe_check+1))
                u1_Account_Management=$((u1_Account_Management+1))
            else
                echo "  - PermitRootLogin Yes : ë°œê²¬ë˜ì§€ ì•ŠìŒ" >> "$target"
            fi
        fi
    else
        echo "/etc/ssh/sshd_config íŒŒì¼: ì¡´ì¬í•˜ì§€ ì•ŠìŒ" >> "$target"
    fi

    # /etc/pam.d/sshd íŒŒì¼ ì²´í¬
    if [ -f "/etc/pam.d/sshd" ]; then
        echo "/etc/pam.d/sshd íŒŒì¼: ì¡´ì¬í•¨" >> "$target"
        if grep -qiE "^\s*#\s*auth\s*required\s*pam_securetty.so" "/etc/pam.d/sshd"; then
            echo "pam_securetty.so ëª¨ë“ˆ ì‚¬ìš©ì´ ì£¼ì„ì²˜ë¦¬ë˜ì–´ìˆìŠµë‹ˆë‹¤. : ë¹„í™œì„±í™”" >> "$target"
            u1_safe_check=$((u1_safe_check+1))
        else
            if grep -qiE "^\s*auth\s*required\s*pam_securetty.so" "/etc/pam.d/sshd"; then
                echo "pam_securetty.so ëª¨ë“ˆì„ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤." >> "$target"
            else
                echo "pam_securetty.so ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ìˆìŠµë‹ˆë‹¤." >> "$target"
                u1_safe_check=$((u1_safe_check+1))
            fi
        fi

        if grep -qiE "^\s*#\s*AllowUsers" "/etc/pam.d/sshd"; then
            echo "AllowUsers í•­ëª©ì€ ì£¼ì„ì²˜ë¦¬ ë˜ì–´ ë¹„í™œì„±í™” ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> "$target"
        else
            if grep -qiE "^\s*AllowUsers" "/etc/pam.d/sshd"; then
                if grep -qiE "\s*AllowUsers\s*root" "/etc/pam.d/sshd"; then
                    echo "AllowUsers í•­ëª©ì— rootê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> "$target"
                    u1_safe_check=$((u1_safe_check+1))
                else
                    echo "AllowUsers í•­ëª©ì´ ì•ˆì „í•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> "$target"
                fi
            else
                echo "AllowUsers í•­ëª©ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> "$target"
            fi
        fi

        if grep -qiE "^\s*#\s*AllowGroups" "/etc/pam.d/sshd"; then
            echo "AllowGroups í•­ëª©ì€ ì£¼ì„ì²˜ë¦¬ ë˜ì–´ ë¹„í™œì„±í™” ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> "$target"
        else
            if grep -qiE "^\s*AllowGroups" "/etc/pam.d/sshd"; then
                if grep -qiE "\s*AllowGroups\s*root" "/etc/pam.d/sshd"; then
                    echo "AllowGroups í•­ëª©ì— rootê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> "$target"
                    u1_safe_check=$((u1_safe_check+1))
                else
                    echo "AllowGroups í•­ëª©ì´ ì•ˆì „í•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> "$target"
                fi
            else
                echo "AllowGroups í•­ëª©ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> "$target"
            fi
        fi
    else
        echo "/etc/pam.d/sshd íŒŒì¼ : ì¡´ì¬í•˜ì§€ ì•ŠìŒ" >> "$target"
    fi
    if [[ $u1_safe_check -ge 1 ]];then
        echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
        u1=$((u1+1))
    else
        echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
    fi
}
if pgrep "sshd" > /dev/null; then
    echo "sshd í”„ë¡œì„¸ìŠ¤: ë™ì‘ ì¤‘" >> $target
    ssh_access_check
else
    if grep -q '^ssh[[:space:]]*22/tcp' /etc/services; then
    	if sudo netstat -tuln | grep :22  > /dev/null; then
    	    ssh_access_check
    	else
    	    echo "sshd í”„ë¡œì„¸ìŠ¤: ë™ì‘ ì¤‘ì´ ì•„ë‹˜" >> $target
    	fi
    else
        echo 'ssh ê¸°ë³¸ í¬íŠ¸ 22ìœ¼ë¡œ ì„¤ì •ë˜ì–´ìˆì§€ ì•ŠìŒ' >> $target
        u1_ssh_newport=$(grep '^sshd[[:space:]]' /etc/services | awk '{print $2}' | cut -d'/' -f1)
        if sudo netstat -tuln | grep :$u1_ssh_newport  > /dev/null; then
            ssh_access_check	    
    	else
    	    echo "sshd í”„ë¡œì„¸ìŠ¤: ë™ì‘ ì¤‘ì´ ì•„ë‹˜" >> $target
    	fi
    fi
fi

if [ $u1 -ge 1 ];then
    High=$((High+1))
    Account_Management=$((Account_Management+1))
    u1_Account_Management=1
fi



cat << EOF
===== [U-02] Weak password complexity settings          =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-02 íŒ¨ìŠ¤ì›Œë“œ ë³µì¡ì„± ì„¤ì • ë¯¸í¡ ì ê²€                        " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo '' >> $target
echo "/etc/pam.d/login.defs íŒŒì¼ ì ê²€" >> $target
echo "-------------" >> $result
echo "U-2 ì ê²€ ê²°ê³¼" >> $result
u2=0
u2_safe_check=0
u2_Account_Management=0
if [ -e "/etc/login.defs" ]; then
    u2_defs_check_values=("PASS_MAX_DAYS" "PASS_REUSE_DAYS" "PASS_MIN_DAYS" "PASS_WARN_AGE" "PASS_MIN_LEN")

    for u2_defs_check_value in "${u2_defs_check_values[@]}"; do
        # ì„¤ì •ê°’ ê°€ì ¸ì˜¤ê¸°
        u2_defs_value=$(grep -iE "^\s*$u2_defs_check_value" /etc/login.defs | tr -d ' ' | grep -v '^#' | awk '{print $2}')

        if grep -iqE "^#.*$u2_defs_check_value[[:space:]]*([0-9]{1,4})?$" /etc/login.defs; then
            echo "$u2_defs_check_value ì„¤ì •ì´ ì£¼ì„ì²˜ë¦¬ ë˜ì–´ ë¹„í™œì„±í™” ë˜ì–´ìˆìŠµë‹ˆë‹¤." >> $target
            u2_safe_check=$((u2_safe_check+1))
        else
            case "$u2_defs_check_value" in
                "PASS_MAX_DAYS")
                    if grep -q "$u2_defs_check_value" /etc/login.defs; then
                    	if [[ $u2_defs_value -gt 90 ]]; then 
                        	echo "$u2_defs_check_value ì˜ ë³´ì•ˆê¶Œê³  ì„¤ì • ê°’ì¸ 90 ë³´ë‹¤ í¬ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. | í˜„ì¬ ì„¤ì •ëœ ê°’ $u2_defs_value" >> $target
                            u2_safe_check=$((u2_safe_check+1))
                    	else
                        	echo "$u2_defs_check_value ì˜ ì„¤ì •ê°’ì´ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    	fi
                    else
                    	echo "$u2_defs_check_value ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."  >> $target
                    fi
                    ;;
                "PASS_REUSE_DAYS")               
                    if grep -q "$u2_defs_check_value" /etc/login.defs; then
                    	if [[ $u2_defs_value -gt 4 ]]; then 
                        	echo "$u2_defs_check_value ì˜ ë³´ì•ˆê¶Œê³  ì„¤ì • ê°’ì¸ 4 ë³´ë‹¤ í¬ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. | í˜„ì¬ ì„¤ì •ëœ ê°’ $u2_defs_value" >> $target
                            u2_safe_check=$((u2_safe_check+1))
                    	else
                        	echo "$u2_defs_check_value ì˜ ì„¤ì •ê°’ì´ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    	fi
                    else
                    	echo "$u2_defs_check_value ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    fi
                    ;;
                "PASS_MIN_DAYS"|"PASS_WARN_AGE")
                    if grep -q "$u2_defs_check_value" /etc/login.defs; then
                    	if [[ $u2_defs_value -gt 7 ]]; then 
                        	echo "$u2_defs_check_value ì˜ ë³´ì•ˆê¶Œê³  ì„¤ì • ê°’ì¸ 7 ë³´ë‹¤ í¬ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. | í˜„ì¬ ì„¤ì •ëœ ê°’ $u2_defs_value" >> $target
                            u2_safe_check=$((u2_safe_check+1))
                    	else
                        	echo "$u2_defs_check_value ì˜ ì„¤ì •ê°’ì´ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    	fi
                    else
                    	echo "$u2_defs_check_value ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    fi
                    ;;
                "PASS_MIN_LEN")
                    if grep -q "$u2_defs_check_value" /etc/login.defs; then
                    	if [[ $u2_defs_value -gt 8 ]]; then 
                        	echo "$u2_defs_check_value ì˜ ë³´ì•ˆê¶Œê³  ì„¤ì • ê°’ì¸ 8 ë³´ë‹¤ í¬ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. | í˜„ì¬ ì„¤ì •ëœ ê°’ $u2_defs_value" >> $target
                            u2_safe_check=$((u2_safe_check+1))
                    	else
                        	echo "$u2_defs_check_value ì˜ ì„¤ì •ê°’ì´ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    	fi
                    else
                    	echo "$u2_defs_check_value ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    fi
                    ;;
                *)
                    echo "í•´ë‹¹ ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.: $u2_defs_check_value" >> $target
                    ;;
            esac
        fi
    done
else
    echo "/etc/login.defs íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi
echo "" >> $target
echo "/etc/pam.d/common-password íŒŒì¼ ì ê²€" >> $target
if [ -e "/etc/pam.d/common-password" ]; then
    u2_com_module_check=("pam_cracklib.so" "pam_pwquality.so" "pam_unix.so")
    u2_com_check=("minlen" "ucredit" "lcredit" "dcredit" "ocredit" "difok" "retry")
    u2_modules_found=0
   
    for u2_com_module in "${u2_com_module_check[@]}"; do
        # ëª¨ë“ˆì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
        if grep -q "$u2_com_module" /etc/pam.d/common-password; then
            u2_modules_found=$((u2_modules_found + 1))
            # ì„¤ì •ì´ ì¡´ì¬í•˜ëŠ” ê²½ìš°ì—ë§Œ ê²€ì¦ ë° ì£¼ì„ ê²€ì¦
            if grep -qiE "^\s*#.*password\s+.*$u2_com_module" "/etc/pam.d/common-password"; then
                echo "íŒ¨ìŠ¤ì›Œë“œ ë³µì¡ì„± ì„¤ì •($u2_com_module)ì´ ì£¼ì„ì²˜ë¦¬ ë˜ì–´ ìˆìŠµë‹ˆë‹¤. : ì·¨ì•½" >> "$target"
                u2_safe_check=$((u2_safe_check+1))
                u2=$((u2+1))
			elif [ "$u2_com_module" == "pam_unix.so" ]; then
				if grep -iE "^\s*#.*password\s+.*$u2_com_module" "/etc/pam.d/common-password" | awk '{print $1}' | grep -Eo "^#"; then
					echo "íŒ¨ìŠ¤ì›Œë“œ ë³µì¡ì„± ì„¤ì •($u2_com_module)ì´ ì£¼ì„ì²˜ë¦¬ ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> "$target"
                    u2_safe_check=$((u2_safe_check+1))
				else grep -qiE "^\s*#.*password\s+.*$u2_com_module" "/etc/pam.d/common-password"; 
					echo "/etc/pam.d/common-password íŒŒì¼ì´ ì¡´ì¬í•˜ë©°, íŒ¨ìŠ¤ì›Œë“œ ë³µì¡ë„ ì„¤ì •($u2_com_module)ì´ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> "$target"
					#ê²€ì¦ë¡œì§ ì„¤ì • í•˜ê¸°
					u2_com_check_value2=$(cat /etc/pam.d/common-password | grep -iE "^\s*password\s+.*$u2_com_module" | sed "s/.*$u2_com_module\s*//")
					echo "í˜„ì¬ $u2_com_module ëª¨ë“ˆì— ì ìš©ëœ ì„¤ì •ê°’ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤." >> $target
					echo "$u2_com_check_value2" | sed 's/\s\+/\n/g' | while read -r u2_com_field; do
    					echo "$u2_com_field" >> $target
						done
                    u2_corrent_control_keyworld=$( grep -iE "^\s*password\s+.*$u2_com_module" "/etc/pam.d/common-password" | sed 's/ \+/\\t/g' | awk '{print $2}')
                    if [[ $u2_corrent_control_keyworld == "required" ]]; then
                        echo "$u2_com_module ëª¨ë“ˆì˜ ì œì–´ í‚¤ì›Œë“œë¡œ $u2_corrent_control_keyworld ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    else
                        echo "$u2_com_module ëª¨ë“ˆì˜ ì œì–´ í‚¤ì›Œë“œë¡œ $u2_corrent_control_keyworld ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        u2_safe_check=$((u2_safe_check+1))
                    fi
				fi
            else
                if grep -qiE "^\s*password\s+.*$u2_com_module" /etc/pam.d/common-password; then
                    echo "/etc/pam.d/common-password íŒŒì¼ì´ ì¡´ì¬í•˜ë©°, íŒ¨ìŠ¤ì›Œë“œ ë³µì¡ë„ ì„¤ì •($u2_com_module)ì´ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> "$target"
                    for u2_com_value in "${u2_com_check[@]}"; do
                        # ì„¤ì • ê°’ í™•ì¸
                        u2_com_check_value=$(grep "$u2_com_module" /etc/pam.d/common-password | grep -o "$u2_com_value=[^ ]*" | tr -d ' ' | awk -F= '{print $2}')
                        
                        # ì„¤ì • ê°’ì´ ì¡´ì¬í•˜ëŠ” ê²½ìš°ì—ë§Œ ì¶œë ¥
                        if [[ -n "$u2_com_check_value" ]]; then
                            case "$u2_com_value" in	
                                "minlen")
                                    if [[ $u2_com_check_value -lt 8 ]]; then
                                        echo "$u2_com_value ì˜ ë³´ì•ˆ ê¶Œê³  ì„¤ì • ê°’ì¸ 8 ë³´ë‹¤ ì‘ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. | í˜„ì¬ ì„¤ì • ê°’ : $u2_com_check_value" >> "$target"
                                        u2_safe_check=$((u2_safe_check+1))
                                    else
                                        echo "$com_value ì˜ ì„¤ì •ê°’ì´ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> "$target"
                                    fi
                                    ;;
                                "ucredit"|"lcredit"|"dcredit"|"ocredit"|"difok")
                                    if [[ $u2_com_check_value -lt 1 ]]; then
                                        echo "$u2_com_value ì˜ ë³´ì•ˆ ê¶Œê³  ì„¤ì • ê°’ì¸ 1 ë³´ë‹¤ ì‘ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. | í˜„ì¬ ì„¤ì • ê°’ : $u2_com_check_value" >> "$target"
                                        u2_safe_check=$((u2_safe_check+1))
                                    else
                                        echo "$u2_com_value ì˜ ì„¤ì •ê°’ì´ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> "$target"
                                    fi 
                                    ;;
								"retry")
									if [[ $u2_com_check_value -gt 3 ]]; then
										echo "$u2_com_value ì˜ ë³´ì•ˆ ê¶Œê³  ì„¤ì • ê°’ì¸ 3 ë³´ë‹¤ í¬ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. | í˜„ì¬ ì„¤ì • ê°’ : $u2_com_check_value" >> "$target"
                                        u2_safe_check=$((u2_safe_check+1))
									else
										echo "$u2_com_value ì˜ ì„¤ì •ê°’ì´ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> "$target"
									fi
									;;
                                *)
                                    echo "ì•Œ ìˆ˜ ì—†ëŠ” ì„¤ì • ê°’: $u2_com_value" >> "$target"
                                    ;;
                            esac
                        else
                            echo "$u2_com_value ì„¤ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> "$target"
                            u2_safe_check=$((u2_safe_check+1))
                        fi
                    done
                    if [[ "$u2_com_module" == "pam_pwquality.so" || "$u2_com_module" == "pam_cracklib.so" ]]; then
                        u2_corrent_control_keyworld=$( grep -iE "^\s*password\s+.*$u2_com_module" "/etc/pam.d/common-password" | awk '{print $2}')
                        if [[ $u2_corrent_control_keyworld == "requisite" ]]; then
                            echo "$u2_com_module ëª¨ë“ˆì˜ ì œì–´ í‚¤ì›Œë“œë¡œ $u2_corrent_control_keyworld ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        else
                            echo "$u2_com_module ëª¨ë“ˆì˜ ì œì–´ í‚¤ì›Œë“œë¡œ $u2_corrent_control_keyworld ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            u2_safe_check=$((u2_safe_check+1))
                        fi
                    fi
                else
                    echo "/etc/pam.d/common-password íŒŒì¼ì´ ì¡´ì¬í•˜ë©°, íŒ¨ìŠ¤ì›Œë“œ ë³µì¡ì„± ì„¤ì •ì´($u2_com_module)ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> "$target"
                    u2_safe_check=$((u2_safe_check+1))
                fi
            fi
        else
            echo "/etc/pam.d/common-password íŒŒì¼ì´ ì¡´ì¬í•˜ë©°, íŒ¨ìŠ¤ì›Œë“œ ë³µì¡ì„± ì„¤ì •ì´($u2_com_module)ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> "$target"
            u2_safe_check=$((u2_safe_check+1))
        fi
    done
    
    #  ëª¨ë“ˆ ëª¨ë‘ ë°œê²¬ë˜ì§€ ì•Šì•˜ì„ ê²½ìš°
    if [[ $u2_modules_found -eq 0 ]]; then
        echo "/etc/pam.d/common-password íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ë§Œ, íŒ¨ìŠ¤ì›Œë“œ ë³µì¡ì„± ì„¤ì • ê´€ë ¨ ëª¨ë“ˆì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> "$target"
        u2_safe_check=$((u2_safe_check+1))
    fi
else
    echo "/etc/pam.d/common-password íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> "$target"
fi

echo '' >> $target
echo "/etc/security/pwquality.conf íŒŒì¼ ì ê²€" >> $target
if [ -e "/etc/security/pwquality.conf" ]; then
    u2_pwquality_check_values=("minlen" "dcredit" "ucredit" "ocredit" "lcredit" "minclass" "retry")
    for u2_pwquality_check_value in "${u2_pwquality_check_values[@]}"; do
        u2_pwquality_value=$(grep "^\s*$u2_pwquality_check_value" /etc/security/pwquality.conf | tr -d ' ' | awk -F= '{print $2}')
        
        u2_pwquality_Annotations=$(grep "^\s*#.*$u2_pwquality_check_value" /etc/security/pwquality.conf)

	if [[ -n $u2_pwquality_Annotations ]]; then
	    echo "$u2_pwquality_check_value ê°’ì€ ì£¼ì„ì²˜ë¦¬ ë˜ì–´ ë¹„í™œì„±í™” ë˜ì–´ìˆìŠµë‹ˆë‹¤." >> $target
        u2_safe_check=$((u2_safe_check+1))
        else
	    if [[ -n $u2_pwquality_value ]]; then
	        case "$u2_pwquality_check_value" in
	            "minlen")
                    if [[ $u2_pwquality_value -lt 8 ]]; then
                        echo "$u2_pwquality_check_value ì˜ ë³´ì•ˆê¶Œê³  ì„¤ì • ê°’ì¸ 8 ë³´ë‹¤ ì‘ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. | í˜„ì¬ ì„¤ì •ëœ ê°’ $u2_pwquality_value" >> $target
                        u2_safe_check=$((u2_safe_check+1))
                    else
                        echo "$u2_pwquality_check_value ì˜ ì„¤ì •ê°’ì´ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    fi
                    ;;
	            "dcredit"|"ucredit"|"ocredit"|"lcredit")
		        if [[ $u2_pwquality_value -lt 1 ]]; then
                    echo "$u2_pwquality_check_value ì˜ ë³´ì•ˆê¶Œê³  ì„¤ì • ê°’ì¸ 1 ë³´ë‹¤ ì‘ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. | í˜„ì¬ ì„¤ì •ëœ ê°’ $u2_pwquality_value" >> $target
                    u2_safe_check=$((u2_safe_check+1))
		        else
			        echo "$u2_pwquality_check_value ì˜ ì„¤ì •ê°’ì´ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
		        fi
		        ;;
		    "minclass")
		        if [[ $u2_pwquality_value -lt 3 ]]; then
                    echo "$u2_pwquality_check_value ì˜ ë³´ì•ˆê¶Œê³  ì„¤ì • ê°’ì¸ 3 ë³´ë‹¤ ì‘ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. | í˜„ì¬ ì„¤ì •ëœ ê°’ $u2_pwquality_value" >> $target
                    u2_safe_check=$((u2_safe_check+1))
		        else
                    echo "$u2_pwquality_check_value ì˜ ì„¤ì •ê°’ì´ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
		        fi
			;;
		    "retry")
		        if [[ $u2_pwquality_value -gt 3 ]]; then
                    echo "$u2_pwquality_check_value ì˜ ë³´ì•ˆê¶Œê³  ì„¤ì • ê°’ì¸ 3 ë³´ë‹¤ í¬ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. | í˜„ì¬ ì„¤ì • ê°’ : $u2_pwquality_value" >> $target
                    u2_safe_check=$((u2_safe_check+1))
		        else
                    echo "$u2_pwquality_check_value ì˜ ì„¤ì •ê°’ì´ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
			fi
		        ;;
	        *)
	        esac
	    else
            echo "í•´ë‹¹ ì˜µì…˜ì€ ê°’ì´ ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.: $u2_pwquality_check_value" >> $target
            u2_safe_check=$((u2_safe_check+1))
	    fi
	fi
    done
fi	

if [ $u2_safe_check -ge 1 ];then
    u2=$((u2+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u2 -ge 1 ]];then
    High=$((High+1))
    Account_Management=$((Account_Management+1))
    u2_Account_Management=1
fi

cat << EOF
===== [U-03] Set Account Lock Threshold                 =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-03 ê³„ì • ì ê¸ˆ ì„ê³„ê°’ ì„¤ì •                        " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ê³„ì •íƒˆì·¨ ëª©ì ì˜ ë¬´ì‘ìœ„ ëŒ€ì… ê³µê²© ì‹œ í•´ë‹¹ ê³„ì •ì„ ì ê¸ˆí•˜ì—¬ ì¸ì¦ ìš”ì²­ì— ì‘ë‹µí•˜ëŠ” ë¦¬ì†ŒìŠ¤ ë‚­ë¹„ë¥¼ ì°¨ë‹¨í•˜ê³  ëŒ€ì… ê³µê²©ìœ¼ë¡œ ì¸í•œ ë¹„ë°€ë²ˆí˜¸ ë…¸ì¶œ ê³µê²©ì„ ë¬´ë ¥í™”í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : íŒ¨ìŠ¤ì›Œë“œ íƒˆì·¨ ê³µê²©(ë¬´ì‘ìœ„ ëŒ€ì… ê³µê²©, ì‚¬ì „ ëŒ€ì… ê³µê²©, ì¶”ì¸¡ ê³µê²© ë“±)ì˜ ì¸ì¦ ìš”ì²­ì— ëŒ€í•´ ì„¤ì •ëœ íŒ¨ìŠ¤ì›Œë“œì™€ ì¼ì¹˜ í•  ë•Œê¹Œì§€ ì§€ì†ì ìœ¼ë¡œ ì‘ë‹µí•˜ì—¬ í•´ë‹¹ ê³„ì •ì˜ íŒ¨ìŠ¤ì›Œë“œê°€ ìœ ì¶œ ë  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ê³„ì • ì ê¸ˆ ì„ê³„ê°’ì´ 10íšŒ ì´í•˜ì˜ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ê³„ì • ì ê¸ˆ ì„ê³„ê°’ì´ ì„¤ì •ë˜ì–´ ìˆì§€ ì•Šê±°ë‚˜, 10íšŒ ì´í•˜ì˜ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-3 ì ê²€ ê²°ê³¼" >> $result
u3=0
u3_safe_check=0
u3_Account_Management=0
echo "/etc/pam.d/common-auth íŒŒì¼ ì ê²€" >> $target
if [ -e "/etc/pam.d/common-auth" ]; then
    u3_auth_module_check=("pam_tally.so" "pam_tally2.so" "pam_faillock.so")    
    u3_modules_found=0
    for u3_auth_module in "${u3_auth_module_check[@]}";do
        echo "$u3_auth_module ì ê²€" >> $target
        if grep -qiE "^\s*auth\s+.*$u3_auth_module" "/etc/pam.d/common-auth";then
            echo "auth ì— ëŒ€í•œ $u3_auth_module ê°€ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
            u3_auth_check_values=$(grep -iE "^\s*auth\s+.*$u3_auth_module"  "/etc/pam.d/common-auth" | sed -E "s/^.*$u3_auth_module\s*//")
            echo "$(grep -iE "^\s*auth\s+.*$auth_module" "/etc/pam.d/common-auth")" >> $target
            echo "í˜„ì¬ auth ì˜ $u3_auth_module ëª¨ë“ˆì— ì ìš©ëœ ì„¤ì •ê°’ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤." >> $target
            echo "$u3_auth_check_values" | sed 's/\s\+/\n/g' | while read -r auth_field; do
                    echo "$u3_auth_field" >> $target
                    done
            echo "--------------------" >> $target
            u3_deny_count=$(grep -iE "^\s*auth\s+.*$u3_auth_module" "/etc/pam.d/common-auth" | sed -E "s/^.*$u3_auth_module\s*//" | grep -oP 'deny=\K\d+')
            if (( deny_count <= 10 )); then
                echo "ê³„ì • ì„ê³„ê°’ ì„¤ì •ì´ $u3_deny_count ë¡œ ë³´ì•ˆê¶Œê³  ì‚¬í•­ì¸ 10 ì´í•˜ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤." >> "$target"
                echo "--------------------" >> $target
            else
                echo "ê³„ì • ì„ê³„ê°’ ì„¤ì •ì´ $u3_deny_count ë¡œ ë³´ì•ˆê¶Œê³  ì‚¬í•­ì¸ 10 ì´ìƒìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤." >> "$target"
                echo "--------------------" >> $target
                u3_safe_check=$((u3_safe_check+1))
            fi
        else
            if grep -qiE "^\s*#.*$u3_auth_stack\s+.*$u3_auth_module" "/etc/pam.d/common-auth"; then  
                echo "ê³„ì • ì„ê³„ê°’ ì„¤ì • ëª¨ë“ˆ($u3_auth_module)ì´ ì£¼ì„ì²˜ë¦¬ ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                u3_safe_check=$((u3_safe_check+1))
            else    
                echo "$u3_auth_moduleê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
            fi
        fi
    done
else
    echo "/etc/pam.d/common-password íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [ $u3_safe_check -ge 1 ];then
    u3=$((u3+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u3 -ge 1 ]];then
    High=$((High+1))
    Account_Management=$((Account_Management+1))
    u3_Account_Management=1
fi

cat << EOF
===== [U-04] password file protection                 =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-04 íŒ¨ìŠ¤ì›Œë“œ íŒŒì¼ ë³´í˜¸                        " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ì¼ë¶€ ì˜¤ë˜ëœ ì‹œìŠ¤í…œì˜ ê²½ìš° /etc/passwd íŒŒì¼ì— íŒ¨ìŠ¤ì›Œë“œê°€ í‰ë¬¸ìœ¼ë¡œ ì €ì¥ë˜ë¯€ë¡œ ì‚¬ìš©ì ê³„ì • íŒ¨ìŠ¤ì›Œë“œê°€ ì•”í˜¸í™”ë˜ì–´ ì €ì¥ë˜ì–´ ìˆëŠ”ì§€ ì ê²€í•˜ì—¬ ë¹„ì¸ê°€ìì˜ íŒ¨ìŠ¤ì›Œë“œ íŒŒì¼ ì ‘ê·¼ ì‹œì—ë„ ì‚¬ìš©ì ê³„ì • íŒ¨ìŠ¤ì›Œë“œê°€ ì•ˆì „í•˜ê²Œ ê´€ë¦¬ë˜ê³  ìˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ì‚¬ìš©ì ê³„ì • íŒ¨ìŠ¤ì›Œë“œê°€ ì €ì¥ëœ íŒŒì¼ì´ ìœ ì¶œ ë˜ëŠ” íƒˆì·¨ ì‹œ í‰ë¬¸ìœ¼ë¡œ ì €ì¥ëœíŒ¨ìŠ¤ì›Œë“œ ì •ë³´ê°€ ë…¸ì¶œë  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ì‰ë„ìš° íŒ¨ìŠ¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜, íŒ¨ìŠ¤ì›Œë“œë¥¼ ì•”í˜¸í™”í•˜ì—¬ ì €ì¥í•˜ëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ì‰ë„ìš° íŒ¨ìŠ¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³ , íŒ¨ìŠ¤ì›Œë“œë¥¼ ì•”í˜¸í™”í•˜ì—¬ ì €ì¥í•˜ì§€ ì•ŠëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-4 ì ê²€ ê²°ê³¼" >> $result
u4=0
u4_safe_check=0
u4_Account_Management=0
if [ -e "/etc/passwd" ];then
    u4_check_encryption=$(cat "/etc/passwd" | awk -F':' '{print $2}' | grep -v 'x')
    u4_count_noencryption=$(cat "/etc/passwd" | awk -F':' '{print $2}' | grep -v 'x' | wc -l)
    if [[ -n $u4_check_encryption ]];then
        echo "passwd íŒŒì¼ ë‚´ì— íŒ¨ìŠ¤ì›Œë“œê°€ ì•”í˜¸í™” ì €ì¥ì´ ì•„ë‹Œ í‰ë¬¸ìœ¼ë¡œ ì €ì¥ëœ ê³„ì •ì´ $u4_count_noencryption ê°œ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        u4_safe_check=$((u4_safe_check+1))
        echo "$u4_check_encryption" | while IFS= read -r view_account; do
            echo "ì•”í˜¸í™” ë˜ì§€ ì•Šì€ ê³„ì • : $u4_view_account" >> "$target"
        done
    else
        echo "passwd íŒŒì¼ ë‚´ì— í‰ë¬¸ ì €ì¥ëœ ê³„ì •ì€ í™•ì¸ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤." >> $target
    fi
    if [ -e "/etc/shadow" ];then
        u4_check_hash=$(cat /etc/shadow | awk -F':' '{print $2}')
        u4_unsafe_user=$(grep -vE '^([^:]+:(\*|\$y|\$5|\$6|\!|\!!))' /etc/shadow)
        u4_count_unsafe_user=$(grep -vE '^([^:]+:(\*|\$y|\$5|\$6|\!|\!!))' /etc/shadow | wc -l)
        if [[ $u4_count_unsafe_user -eq 0 ]];then
            echo "passwd íŒŒì¼ì´ ì¡´ì¬í•˜ë©°, ëª¨ë“  ê³„ì •ì— ëŒ€í•œ íŒ¨ìŠ¤ì›Œë“œê°€ ì•”í˜¸í™” ë˜ì–´ ì•ˆì „í•˜ê²Œ shadow íŒŒì¼ì— ì €ì¥ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
        else
            echo "shadow íŒŒì¼ ë‚´ì— íŒ¨ìŠ¤ì›Œë“œê°€ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜ ì•ˆì „í•˜ì§€ ì•Šì€ í•´ì‹œ ì•Œê³ ë¥´ì§ìœ¼ë¡œ ì €ì¥ëœ ê³„ì •ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
            echo "ì•ˆì „í•˜ì§€ ì•Šì€ ê³„ì • : $u4_count_unsafe" >> $target
            u4_safe_check=$((u4_safe_check+1))
        fi
    else
        echo "shadow íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©°, íŒ¨ìŠ¤ì›Œë“œ ì•”í˜¸í™”ê°€ ë˜ì–´ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        u4_safe_check=$((u4_safe_check+1))
    fi
fi


if [ $u4_safe_check -ge 1 ];then
    u4=$((u4+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u4 -ge 1 ]];then
    High=$((High+1))
    Account_Management=$((Account_Management+1))
    u4_Account_Management=1
fi

cat << EOF
===== [U-05] root home, pass directory permissions, and pass settings               =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-05  rootí™ˆ, íŒ¨ìŠ¤ ë””ë ‰í„°ë¦¬ ê¶Œí•œ ë° íŒ¨ìŠ¤ ì„¤ì •                        " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ë¹„ì¸ê°€ìê°€ ë¶ˆë²•ì ìœ¼ë¡œ ìƒì„±í•œ ë””ë ‰í„°ë¦¬ ë° ëª…ë ¹ì–´ë¥¼ ìš°ì„ ìœ¼ë¡œ ì‹¤í–‰ë˜ì§€ ì•Šë„ë¡ ì„¤ì •í•˜ê¸° ìœ„í•´ í™˜ê²½ë³€ìˆ˜ ì ê²€ì´ í•„ìš”í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : root ê³„ì •ì˜ PATH(í™˜ê²½ë³€ìˆ˜)ì— ì •ìƒì ì¸ ê´€ë¦¬ì ëª…ë ¹ì–´(ì˜ˆ: ls, mv, cpë“±)ì˜ ë””ë ‰í„°ë¦¬ ê²½ë¡œ ë³´ë‹¤ í˜„ì¬ ë””ë ‰í„°ë¦¬ë¥¼ ì§€ì¹­í•˜ëŠ” â€œ.â€ í‘œì‹œê°€ ìš°ì„ í•˜ë©´ í˜„ì¬ ë””ë ‰í„°ë¦¬ì— ë³€ì¡°ëœ ëª…ë ¹ì–´ë¥¼ ì‚½ì…í•˜ì—¬ ê´€ë¦¬ì ëª…ë ¹ì–´ ì…ë ¥ ì‹œ ì•…ì˜ì ì¸ ê¸°ëŠ¥ì´ ì‹¤í–‰ ë  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: PATH í™˜ê²½ë³€ìˆ˜ì— â€œ.â€ ì´ ë§¨ ì•ì´ë‚˜ ì¤‘ê°„ì— í¬í•¨ë˜ì§€ ì•Šì€ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: PATH í™˜ê²½ë³€ìˆ˜ì— â€œ.â€ ì´ ë§¨ ì•ì´ë‚˜ ì¤‘ê°„ì— í¬í•¨ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-5 ì ê²€ ê²°ê³¼" >> $result
u5=0
u5_safe_check=0
u5_Files_Directory_Management=0

u5_etc_configure_files=(
    "/etc/profile"
    "/etc/.login"
    "/etc/bashrc"
)

u5_home_configure_files=(
    ".profile"
    ".cshrc"
    ".login"
    "kshrc"
    ".bash_profile"
)

if [[ $PATH =~ (^|:)(\.|::)(:|$) ]]; then 
    echo "PATH í™˜ê²½ë³€ìˆ˜ì— . ë° :: ë¬¸ìê°€ PATH ë³€ìˆ˜ì˜ ë§¨ ì• í˜¹ì€ ì¤‘ê°„ì— ìœ„ì¹˜í•˜ê³  ìˆìŠµë‹ˆë‹¤. í•´ë‹¹ ë¬¸ìë¥¼ ë§¨ ë§ˆì§€ë§‰ìœ¼ë¡œ ì´ë™í•˜ì‹­ì‹œì˜¤." >> $target
    u5_safe_check=$((u5_safe_check+1))
else
    echo "PATH í™˜ê²½ë³€ìˆ˜ì— . ë° :: ë¬¸ìê°€ ì˜¬ë°”ë¥¸ ìœ„ì¹˜ì— ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
fi


for u5_etc_configure_file in "${u5_etc_configure_files[@]}"; do
    echo -e "${RED}Checking file: $u5_etc_configure_file${NC}" >> $target
    if [ -e "$u5_etc_configure_file" ]; then
        # íŒŒì¼ì´ ì¡´ì¬í•˜ë©´ ê¶Œí•œì„ í™•ì¸í•˜ëŠ” êµ¬ë¬¸ ì¶”ê°€í•˜ê¸°
        #ls -l "$etc_configure_file"
        if grep -qiE "^#\s*PATH\s*=" "$u5_etc_configure_file"; then  
            echo "PATH ì„¤ì • êµ¬ë¬¸ì´ ì£¼ì„ì²˜ë¦¬ë˜ì–´ ë¹„í™œì„±í™” ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            echo "--------------------------------------" >> $target
        else
            if grep -qiE "^\s*PATH\s*=" "$u5_etc_configure_file"; then
                grep -iE "^\s*PATH\s*=" "$u5_etc_configure_file" | while read -r line ; do
                    echo "PATH setting found: $u5_line" >> $target
                    # PATH ì„¤ì •ì—ì„œ . ë˜ëŠ” :: ë¬¸ìê°€ ë§¨ ì•ì´ë‚˜ ì¤‘ê°„ì— í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
                    if echo "$u5_line" | grep -iqE "(^|:)(\.|::)(:|$)"; then
                        echo "PATH ì„¤ì • ê°’ì— â€œ.â€, â€œ::â€ì´ ë§¨ ì• í˜¹ì€ ì¤‘ê°„ì— ìœ„ì¹˜í•˜ê³  ìˆìŠµë‹ˆë‹¤.- ì·¨ì•½" >> $target
                        echo "--------------------------------------" >> $target
                        u5_safe_check=$((u5_safe_check+1))
                    else
                        echo "PATH ê´€ë ¨ ì„¤ì •ì´ ì•ˆì „í•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        echo "--------------------------------------" >> $target
                    fi
                done
            else
                echo "PATH ê´€ë ¨ ì„¤ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                echo "--------------------------------------" >> $target
            fi
        fi

        #if 

        #fi
    else
        # íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ë©”ì‹œì§€ ì¶œë ¥
        echo "$u5_configure_file íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.." >> $target
        echo "--------------------------------------" >> $target
    fi
done

u5_check_users=($(cat /etc/passwd | egrep -v '/sbin|sync|false' | awk -F':' '{print $1}'))
for u5_check_user in "${u5_check_users[@]}";do
    u5_user_home=($(getent passwd "$u5_check_user" | awk -F':' '{print$6}'))
    if [ -d "$u5_user_home" ];then
        echo "--------------------------------------" >> $target
        echo "$u5_check_user ì˜ í™ˆ ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        for u5_home_configure_file in "${u5_home_configure_files[@]}";do
            echo -e "${RED}Checking file: $u5_user_home/$u5_home_configure_file${NC}" >> $target
            if [ -e "$u5_user_home/$u5_home_configure_file" ];then
                echo "$u5_user_home/$u5_home_configure_file íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target

                if grep -qiE "^#\s*PATH\s*=" "$u5_user_home/$u5_home_configure_file"; then  
                    echo "PATH ì„¤ì • êµ¬ë¬¸ì´ ì£¼ì„ì²˜ë¦¬ë˜ì–´ ë¹„í™œì„±í™” ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    echo "--------------------------------------" >> $target
                else
                    if grep -qiE "^\s*PATH\s*=" "$u5_user_home/$u5_home_configure_file"; then
                        grep -iE "^\s*PATH\s*=" "$u5_user_home/$u5_home_configure_file" | while read -r line ; do
                            echo "PATH setting found: $line" >> $target
                            # PATH ì„¤ì •ì—ì„œ . ë˜ëŠ” :: ë¬¸ìê°€ ë§¨ ì•ì´ë‚˜ ì¤‘ê°„ì— í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
                            if echo "$u5_line" | grep -qiE "(^|:)(\.|::)(:|$)"; then
                                echo "PATH ì„¤ì • ê°’ì— â€œ.â€, â€œ::â€ì´ ë§¨ ì• í˜¹ì€ ì¤‘ê°„ì— ìœ„ì¹˜í•˜ê³  ìˆìŠµë‹ˆë‹¤.- ì·¨ì•½" >> $target
                                echo "--------------------------------------" >> $target
                                u5_safe_check=$((u5_safe_check+1))
                            else
                                echo "PATH ê´€ë ¨ ì„¤ì •ì´ ì•ˆì „í•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                                echo "--------------------------------------" >> $target
                            fi
                        done
                    else
                        echo "PATH ê´€ë ¨ ì„¤ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                        echo "--------------------------------------" >> $target
                    fi
                fi

            else
                echo "$u5_user_home/$u5_home_configure_file íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                echo "--------------------------------------" >> $target
            fi
        done
    else
        echo "$u5_check_user ì˜ í™ˆ ë””ë ‰í„±ë¦¬ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        echo "--------------------------------------" >> $target
    fi
done


if [ $u5_safe_check -ge 1 ];then
    u5=$((u5+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u5 -ge 1 ]];then
    High=$((High+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u5_Files_Directory_Management=1
fi

cat << EOF
===== [U-06] File and Directory Owner Settings               =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-06   íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ ì†Œìœ ì ì„¤ì •                        " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ì†Œìœ ìê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ë¥¼ ì‚­ì œ ë° ê´€ë¦¬í•˜ì—¬ ì„ì˜ì˜ ì‚¬ìš©ìê°€ í•´ë‹¹íŒŒì¼ì„ ì—´ëŒ, ìˆ˜ì •í•˜ëŠ” í–‰ìœ„ë¥¼ ì‚¬ì „ì— ì°¨ë‹¨í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ì†Œìœ ìê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” íŒŒì¼ì˜ UIDì™€ ë™ì¼í•œ ê°’ìœ¼ë¡œ íŠ¹ì •ê³„ì •ì˜ UIDê°’ì„ ë³€ê²½í•˜ë©´ í•´ë‹¹ íŒŒì¼ì˜ ì†Œìœ ìê°€ ë˜ì–´ ëª¨ë“  ì‘ì—…ì´ ê°€ëŠ¥í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ì†Œìœ ìê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ì†Œìœ ìê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•˜ëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-6 ì ê²€ ê²°ê³¼" >> $result
u6=0
u6_safe_check=0
u6_Files_Directory_Management=0
echo "#ì†Œìœ ì ë˜ëŠ” ê·¸ë£¹ì´ ì—†ëŠ” íŒŒì¼ì€ íŒŒì¼ ì†ì„± í•´ë‹¹ í•„ë“œì— ìˆ«ìë¡œ í‘œì‹œë¨#" >> $target
declare -a u6_file_list
declare -a u6_dir_list

# find ëª…ë ¹ì–´ì˜ ì¶œë ¥ì„ ë°°ì—´ì— ì €ì¥
mapfile -t u6_noowner_lists < <(find / \( -nouser -o -nogroup \) -print 2> /dev/null)

# íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ ê²½ë¡œë¥¼ ë¶„ë¦¬í•˜ì—¬ ë°°ì—´ì— ì €ì¥
for u6_noowner_list in "${u6_noowner_lists[@]}"; do
    if [[ -e "$u6_noowner_list" ]]; then
        if [[ -f "$u6_noowner_list" ]]; then
            u6_file_list+=("$u6_noowner_list")
        elif [[ -d "$u6_noowner_list" ]]; then
            u6_dir_list+=("$u6_noowner_list")
        fi
    fi
done

# íŒŒì¼ ëª©ë¡ì„ ì¶œë ¥
# #ì€ ë°°ì—´ì˜ ê¸¸ì´ë¥¼ ì–»ëŠ”ë° ì‚¬ìš©ë¨
if [[ ${#u6_file_list[@]} -gt 0 ]]; then
    u6_safe_check=$((u6_safe_check+1))
    echo "ì†Œìœ ìê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” íŒŒì¼ ëª©ë¡:" >> "$target"
    for u6_file in "${u6_file_list[@]}"; do
        echo "íŒŒì¼: $u6_file" >> "$target"
        ls -l "$u6_file" >> "$target"
    done
else
    echo "ì†Œìœ ìê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤." >> "$target"
fi

# ë””ë ‰í„°ë¦¬ ëª©ë¡ì„ ì¶œë ¥
if [[ ${#u6_dir_list[@]} -gt 0 ]]; then
    u6_safe_check=$((u6_safe_check+1))
    echo "ì†Œìœ ìê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë””ë ‰í„°ë¦¬ ëª©ë¡:" >> "$target"
    for u6_dir in "${u6_dir_list[@]}"; do
        u6=$((u6 + 1))
        echo "ë””ë ‰í„°ë¦¬: $u6_dir" >> "$target"
        ls -ld "$u6_dir" >> "$target"
    done
else
    echo "ì†Œìœ ìê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë””ë ‰í„°ë¦¬ê°€ ì—†ìŠµë‹ˆë‹¤." >> "$target"
fi

if [ $u6_safe_check -ge 1 ];then
    u6=$((u6+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u6 -ge 1 ]];then
    High=$((High+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u6_Files_Directory_Management=1
fi

cat << EOF
===== [U-07] /etc/passwd file owner and permission settings               =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-07   /etc/passwd íŒŒì¼ ì†Œìœ ì ë° ê¶Œí•œ ì„¤ì •                        " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : /etc/passwd íŒŒì¼ì˜ ì„ì˜ì ì¸ ë³€ê²½ì„ ì°¨ë‹¨í•˜ê¸° ìœ„í•¨ì„ í†µí•´ ë¹„ì¸ê°€ìê°€ ê¶Œí•œ ìƒìŠ¹í•˜ëŠ” ê²ƒì„ ë§‰ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ê´€ë¦¬ì(root) ì™¸ ì‚¬ìš©ìê°€ /etc/passwd íŒŒì¼ì˜ ì‚¬ìš©ì ì •ë³´ë¥¼ ë³€ì¡°í•˜ì—¬ shell ë³€ê²½, ì‚¬ìš©ì ì¶”ê°€/ì‚­ì œ ë“± rootë¥¼ í¬í•¨í•œ ì‚¬ìš©ì ê¶Œí•œ íšë“ ê°€ëŠ¥" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: /etc/passwd íŒŒì¼ì˜ ì†Œìœ ìê°€ rootì´ê³ , ê¶Œí•œì´ 644 ì´í•˜ì¸ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: /etc/passwd íŒŒì¼ì˜ ì†Œìœ ìê°€ rootê°€ ì•„ë‹ˆê±°ë‚˜, ê¶Œí•œì´ 644 ì´í•˜ê°€ ì•„ë‹Œê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-7 ì ê²€ ê²°ê³¼" >> $result
u7=0
u7_safe_check=0
u7_Files_Directory_Management=0

if [[ -e "/etc/passwd" ]];then
    echo "/etc/passwd íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
    u7_file_owner_user=$(stat -c "%U" "/etc/passwd" 2> /dev/null)
    u7_file_owner=$(stat -c "%a" "/etc/passwd"  2> /dev/null| cut -c1)
    u7_file_group=$(stat -c "%a" "/etc/passwd"  2> /dev/null| cut -c2)
    u7_file_other=$(stat -c "%a" "/etc/passwd"  2> /dev/null| cut -c3)
    u7_check_suid=$(stat -c "%a" "/etc/passwd"  2> /dev/null| tr -d '\n' | wc -c)
    if [[ $u7_check_suid -ge 4 ]];then
        echo "$u7_file íŒŒì¼ì— SUID ê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. [ì˜ëª»ëœ SUID ì„¤ì •]" >> $target
        u7_safe_check=$((u7_safe_check+1))
    else
        if [[ "$u7_file_owner_user" == "root" ]];then
            echo "/etc/passwd íŒŒì¼ì˜ ì†Œìœ ìê°€ rootë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            if [ $u7_file_owner -le 6 ];then
                echo "/etc/passwd íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                if [ $u7_file_group -le 4 ];then
                    echo "/etc/passwd íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 4ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    if [ $u7_file_other -eq 4 ];then
                        echo "/etc/passwd íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ì(Other) ê¶Œí•œì´ 4ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    else
                        echo "/etc/passwd íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ì(Other) ê¶Œí•œì´ 4ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        u7_safe_check=$((u7_safe_check+1))
                    fi
                else
                    ehco "/etc/passwd íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 4ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    u7_safe_check=$((u7_safe_check+1))
                fi
            else
                echo "/etc/passwd íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                u7_safe_check=$((u7_safe_check+1))
            fi
        else
            echo "/etc/passwd íŒŒì¼ì˜ ì†Œìœ ìê°€ rootê°€ ì•„ë‹Œ ë‹¤ë¥¸ ì‚¬ìš©ìë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            u7_safe_check=$((u7_safe_check+1))
        fi
    fi
else
    echo "/etc/passwd íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    u7_safe_check=$((u7_safe_check+1))
fi


if [ $u7_safe_check -ge 1 ];then
    u7=$((u7+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u7 -ge 1 ]];then
    High=$((High+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u7_Files_Directory_Management=1
fi


cat << EOF
===== [U-08] /etc/shadow file owner and permission settings               =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-08   /etc/shadow íŒŒì¼ ì†Œìœ ì ë° ê¶Œí•œ ì„¤ì •                        " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : /etc/shadow íŒŒì¼ì„ ê´€ë¦¬ìë§Œ ì œì–´í•  ìˆ˜ ìˆê²Œ í•˜ì—¬ ë¹„ì¸ê°€ìë“¤ì˜ ì ‘ê·¼ì„ ì°¨që‹¨í•˜ë„ë¡ shadow íŒŒì¼ ì†Œìœ ì ë° ê¶Œí•œì„ ê´€ë¦¬í•´ì•¼í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : shadowíŒŒì¼ì€ íŒ¨ìŠ¤ì›Œë“œë¥¼ ì•”í˜¸í™”í•˜ì—¬ ì €ì¥í•˜ëŠ” íŒŒì¼ì´ë©° í•´ë‹¹ íŒŒì¼ì˜ ì•”í˜¸í™”ëœ í•´ì‰¬ê°’ì„ ë³µí˜¸í™”í•˜ì—¬(í¬ë˜í‚¹) ë¹„ë°€ë²ˆí˜¸ë¥¼ íƒˆì·¨í•  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: /etc/shadow íŒŒì¼ì˜ ì†Œìœ ìê°€ rootì´ê³ , ê¶Œí•œì´ 400 ì´í•˜ì¸ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: /etc/shadow íŒŒì¼ì˜ ì†Œìœ ìê°€ rootê°€ ì•„ë‹ˆê±°ë‚˜, ê¶Œí•œì´ 400 ì´í•˜ê°€ ì•„ë‹Œ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-8 ì ê²€ ê²°ê³¼" >> $result
u8=0
u8_safe_check=0
u8_Files_Directory_Management=0

if [[ -e "/etc/shadow" ]];then
    echo "/etc/shadow íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
    u8_file_owner_user=$(stat -c "%U" "/etc/shadow" 2> /dev/null)
    u8_file_owner=$(stat -c "%a" "/etc/shadow"  2> /dev/null| cut -c1)
    u8_file_group=$(stat -c "%a" "/etc/shadow"  2> /dev/null| cut -c2)
    u8_file_other=$(stat -c "%a" "/etc/shadow"  2> /dev/null| cut -c3)
    u8_check_suid=$(stat -c "%a" "/etc/shadow"  2> /dev/null| tr -d '\n' | wc -c)
    if [[ $u8_check_suid -ge 4 ]];then
        echo "$u8_file íŒŒì¼ì— SUID ê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. [ì˜ëª»ëœ SUID ì„¤ì •]" >> $target
        u8_safe_check=$((u8_safe_check+1))
    else
        if [[ "$u8_file_owner_user" == "root" ]];then
            echo "/etc/shadow íŒŒì¼ì˜ ì†Œìœ ìê°€ rootë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            if [ $u8_file_owner -le 4 ];then
                echo "/etc/shadow íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 4ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                if [ $u8_file_group -eq 0 ];then
                    echo "/etc/shadow íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 0ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    if [ $u8_file_other -eq 0 ];then
                        echo "/etc/shadow íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ì(Other) ê¶Œí•œì´ 0ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    else
                        echo "/etc/shadow íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ì(Other) ê¶Œí•œì´ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        u8_safe_check=$((u8_safe_check+1))
                    fi
                else
                    ehco "/etc/shadow íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 0ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    u8_safe_check=$((u8_safe_check+1))
                fi
            else
                echo "/etc/shadow íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 4ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                u8_safe_check=$((u8_safe_check+1)) 
            fi
        else
            echo "/etc/shadow íŒŒì¼ì˜ ì†Œìœ ìê°€ rootê°€ ì•„ë‹Œ ë‹¤ë¥¸ ì‚¬ìš©ìë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            u8_safe_check=$((u8_safe_check+1))
        fi
    fi
else
    echo "/etc/shadow íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    u8_safe_check=$((u8_safe_check+1))
fi

if [ $u8_safe_check -ge 1 ];then
    u8=$((u8+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u8 -ge 1 ]];then
    High=$((High+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u8_Files_Directory_Management=1
fi


cat << EOF
===== [U-09] /etc/hosts file owner and permission settings               =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-09   /etc/hosts íŒŒì¼ ì†Œìœ ì ë° ê¶Œí•œ ì„¤ì •                        " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : /etc/hosts íŒŒì¼ì„ ê´€ë¦¬ìë§Œ ì œì–´í•  ìˆ˜ ìˆê²Œ í•˜ì—¬ ë¹„ì¸ê°€ìë“¤ì˜ ì„ì˜ì ì¸ íŒŒì¼ ë³€ì¡°ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : hosts íŒŒì¼ì— ë¹„ì¸ê°€ì ì“°ê¸° ê¶Œí•œì´ ë¶€ì—¬ëœ ê²½ìš°, ê³µê²©ìëŠ” hostsíŒŒì¼ì— ì•…ì˜ì ì¸ ì‹œìŠ¤í…œì„ ë“±ë¡í•˜ì—¬, ì´ë¥¼ í†µí•´ ì •ìƒì ì¸ DNSë¥¼ ìš°íšŒí•˜ì—¬ ì•…ì„±ì‚¬ì´íŠ¸ë¡œì˜ ì ‘ì†ì„ ìœ ë„í•˜ëŠ” íŒŒë°(Pharming) ê³µê²© ë“±ì— ì•…ìš©ë  ìˆ˜ ìˆìŒhostsíŒŒì¼ì— ì†Œìœ ìì™¸ ì“°ê¸° ê¶Œí•œì´ ë¶€ì—¬ëœ ê²½ìš°, ì¼ë°˜ì‚¬ìš©ì ê¶Œí•œìœ¼ë¡œ hostsíŒŒì¼ì— ë³€ì¡°ëœ IPì£¼ì†Œë¥¼ ë“±ë¡í•˜ì—¬ ì •ìƒì ì¸ DNSë¥¼ ë°©í•´í•˜ê³  ì•…ì„±ì‚¬ì´íŠ¸ë¡œì˜ ì ‘ì†ì„ ìœ ë„í•˜ëŠ” íŒŒë°(Pharming) ê³µê²© ë“±ì— ì•…ìš©ë  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: /etc/hosts íŒŒì¼ì˜ ì†Œìœ ìê°€ rootì´ê³ , ê¶Œí•œì´ 600ì¸ ì´í•˜ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: /etc/hosts íŒŒì¼ì˜ ì†Œìœ ìê°€ rootê°€ ì•„ë‹ˆê±°ë‚˜, ê¶Œí•œì´ 600 ì´ìƒì¸ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-9 ì ê²€ ê²°ê³¼" >> $result
u9=0
u9_safe_check=0
u9_Files_Directory_Management=0

if [[ -e "/etc/hosts" ]];then
    echo "/etc/hosts íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
    u9_file_owner_user=$(stat -c "%U" "/etc/hosts" 2> /dev/null)
    u9_file_owner=$(stat -c "%a" "/etc/hosts"  2> /dev/null| cut -c1)
    u9_file_group=$(stat -c "%a" "/etc/hosts"  2> /dev/null| cut -c2)
    u9_file_other=$(stat -c "%a" "/etc/hosts"  2> /dev/null| cut -c3)
    u9_check_suid=$(stat -c "%a" "/etc/hosts"  2> /dev/null| tr -d '\n' | wc -c)
    if [[ $u9_check_suid -ge 4 ]];then
        echo "$u9_file íŒŒì¼ì— SUID ê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. [ì˜ëª»ëœ SUID ì„¤ì •]" >> $target
        u9_safe_check=$((u9_safe_check+1))
    else
        if [[ "$u9_file_owner_user" == "root" ]];then
            echo "/etc/hosts íŒŒì¼ì˜ ì†Œìœ ìê°€ rootë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            if [ $u9_file_owner -le 6 ];then
                echo "/etc/hosts íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                if [ $u9_file_group -le 0 ];then
                    echo "/etc/hosts íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 0ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    if [ $u9_file_other -eq 0 ];then
                        echo "/etc/hosts íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ì(Other) ê¶Œí•œì´ 0ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    else
                        echo "/etc/hosts íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ì(Other) ê¶Œí•œì´ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        u9_safe_check=$((u9_safe_check+1))
                    fi
                else
                    echo "/etc/hosts íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 0ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    u9_safe_check=$((u9_safe_check+1))
                fi
            else
                echo "/etc/hosts íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                u9_safe_check=$((u9_safe_check+1)) 
            fi
        else
            echo "/etc/hosts íŒŒì¼ì˜ ì†Œìœ ìê°€ rootê°€ ì•„ë‹Œ ë‹¤ë¥¸ ì‚¬ìš©ìë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            u9_safe_check=$((u9_safe_check+1))
        fi
    fi
else
    echo "/etc/hosts íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    u9_safe_check=$((u9_safe_check+1))
fi


if [ $u9_safe_check -ge 1 ];then
    u9=$((u9+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u9 -ge 1 ]];then
    High=$((High+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u9_Files_Directory_Management=1
fi


cat << EOF
===== [U-10] /etc/(x)inetd.conf file owner and permission settings               =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-10   /etc/(x)inetd.conf íŒŒì¼ ì†Œìœ ì ë° ê¶Œí•œ ì„¤ì •                        " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : /etc/(x)inetd.conf íŒŒì¼ì„ ê´€ë¦¬ìë§Œ ì œì–´í•  ìˆ˜ ìˆê²Œ í•˜ì—¬ ë¹„ì¸ê°€ìë“¤ì˜ ì„ì˜ì ì¸ íŒŒì¼ ë³€ì¡°ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : (x)inetd.conf íŒŒì¼ì— ì†Œìœ ìì™¸ ì“°ê¸° ê¶Œí•œì´ ë¶€ì—¬ëœ ê²½ìš°, ì¼ë°˜ì‚¬ìš©ì ê¶Œí•œìœ¼ë¡œ (x)inetd.conf íŒŒì¼ì— ë“±ë¡ëœ ì„œë¹„ìŠ¤ë¥¼ ë³€ì¡°í•˜ê±°ë‚˜ ì•…ì˜ì ì¸ í”„ë¡œê·¸ë¨(ì„œë¹„ìŠ¤)ë¥¼ ë“±ë¡í•  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: /etc/inetd.conf íŒŒì¼ì˜ ì†Œìœ ìê°€ rootì´ê³ , ê¶Œí•œì´ 600ì¸ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: /etc/inetd.conf íŒŒì¼ì˜ ì†Œìœ ìê°€ rootê°€ ì•„ë‹ˆê±°ë‚˜, ê¶Œí•œì´ 600ì´ ì•„ë‹Œ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-10 ì ê²€ ê²°ê³¼" >> $result
u10=0
u10_x_inetd_confs=("/etc/inetd.conf" "/etc/xinetd.conf")
u10_safe_check=0
u10_Files_Directory_Management=0
for u10_x_inetd_conf in "${u10_x_inetd_confs[@]}";do
    if [[ -e "$u10_x_inetd_conf" ]];then
        echo "$u10_x_inetd_conf íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        u10_file_owner_user=$(stat -c "%U" "$u10_x_inetd_conf" 2> /dev/null)
        u10_file_owner=$(stat -c "%a" "$u10_x_inetd_conf"  2> /dev/null| cut -c1)
        u10_file_group=$(stat -c "%a" "$u10_x_inetd_conf"  2> /dev/null| cut -c2)
        u10_file_other=$(stat -c "%a" "$u10_x_inetd_conf"  2> /dev/null| cut -c3)
        u10_check_suid=$(stat -c "%a" "$u10_x_inetd_conf"  2> /dev/null| tr -d '\n' | wc -c)
        if [[ $u10_check_suid -ge 4 ]];then
            echo "$u10_file íŒŒì¼ì— SUID ê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. [ì˜ëª»ëœ SUID ì„¤ì •]" >> $target
            u10_safe_check=$((u10_safe_check+1))
        else
            if [[ "$u10_file_owner_user" == "root" ]];then
                echo "/etc/hosts íŒŒì¼ì˜ ì†Œìœ ìê°€ rootë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                if [ $u10_file_owner -eq 6 ];then
                    echo "$u10_x_inetd_conf íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    if [ $u10_file_group -eq 0 ];then
                        echo "$u10_x_inetd_conf íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 0ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        if [ $u10_file_other -eq 0 ];then
                            echo "$u10_x_inetd_conf íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ì(Other) ê¶Œí•œì´ 0ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        else
                            echo "$u10_x_inetd_conf íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ì(Other) ê¶Œí•œì´ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            u10_safe_check=$((u10_safe_check+1))
                        fi
                    else
                        ehco "$u10_x_inetd_conf íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        u10_safe_check=$((u10_safe_check+1))
                    fi
                else
                    echo "$u10_x_inetd_conf íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    u10_safe_check=$((u10_safe_check+1)) 
                fi
            else
                echo "/etc/hosts íŒŒì¼ì˜ ì†Œìœ ìê°€ rootê°€ ì•„ë‹Œ ë‹¤ë¥¸ ì‚¬ìš©ìë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                u10_safe_check=$((u10_safe_check+1))
            fi
        fi
    else
        echo "$u10_x_inetd_conf íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
done

if [[ -d "/etc/xinetd.d" ]]; then
    for u10_xinetd_file in /etc/xinetd.d/*; do
        if [[ -f $u10_xinetd_file ]]; then
            echo "$u10_xinetd_file ì´ ì¡´ì¬í•©ë‹ˆë‹¤."
            u10_file_owner_user=$(stat -c "%U" "$u10_xinetd_file" 2> /dev/null)
            u10_file_owner=$(stat -c "%a" "$u10_xinetd_file"  2> /dev/null| cut -c1)
            u10_file_group=$(stat -c "%a" "$u10_xinetd_file"  2> /dev/null| cut -c2)
            u10_file_other=$(stat -c "%a" "$u10_xinetd_file"  2> /dev/null| cut -c3)
            u10_check_suid=$(stat -c "%a" "$u10_xinetd_file"  2> /dev/null| tr -d '\n' | wc -c)
            if [[ $u10_check_suid -ge 4 ]];then
                echo "$u10_file íŒŒì¼ì— SUID ê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. [ì˜ëª»ëœ SUID ì„¤ì •]" >> $target
                u10_safe_check=$((u10_safe_check+1))
            else
                if [[ "$u10_file_owner_user" == "root" ]];then
                    echo "/etc/hosts íŒŒì¼ì˜ ì†Œìœ ìê°€ rootë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤."
                    if [ $u10_file_owner -le 6 ];then
                        echo "$u10_xinetd_file íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        if [ $u10_file_group -le 0 ];then
                            echo "$u10_xinetd_file íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 0ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            if [ $u10_file_other -eq 0 ];then
                                echo "$u10_xinetd_file íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ì(Other) ê¶Œí•œì´ 0ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            else
                                echo "$u10_xinetd_file íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ì(Other) ê¶Œí•œì´ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                                u10_safe_check=$((u10_safe_check+1))
                            fi
                        else
                            ehco "$u10_xinetd_file íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            u10_safe_check=$((u10_safe_check+1))
                        fi
                    else
                        echo "$u10_xinetd_file íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        u10_safe_check=$((u10_safe_check+1)) 
                    fi
                else
                    echo "/etc/hosts íŒŒì¼ì˜ ì†Œìœ ìê°€ rootê°€ ì•„ë‹Œ ë‹¤ë¥¸ ì‚¬ìš©ìë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤."
                    u10_safe_check=$((u10_safe_check+1))
                fi 
            fi
        fi
    done
else
    echo "/etc/xinetd.d ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜, í•´ë‹¹ ë””ë ‰í„°ë¦¬ ë‚´ì— íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."  >> $target
fi

if [[ $u10_safe_check -ge 1 ]];then
    u10=$((u10+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u10 -ge 1 ]];then
    High=$((High+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u10_Files_Directory_Management=1
fi

cat << EOF
===== [U-11] /etc/syslog.conf file owner and permission settings               =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-11   /etc/syslog.conf íŒŒì¼ ì†Œìœ ì ë° ê¶Œí•œ ì„¤ì •                        " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : /etc/syslog.conf íŒŒì¼ì˜ ê¶Œí•œ ì ì ˆì„±ì„ ì ê²€í•˜ì—¬, ê´€ë¦¬ì ì™¸ ë¹„ì¸ê°€ìì˜ ì„ì˜ì ì¸ syslog.conf íŒŒì¼ ë³€ì¡°ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : syslog.conf íŒŒì¼ì˜ ì„¤ì •ë‚´ìš©ì„ ì°¸ì¡°í•˜ì—¬ ë¡œê·¸ì˜ ì €ì¥ìœ„ì¹˜ê°€ ë…¸ì¶œë˜ë©° ë¡œê·¸ì„ ê¸°ë¡í•˜ì§€ ì•Šë„ë¡ ì„¤ì •í•˜ê±°ë‚˜ ëŒ€ëŸ‰ì˜ ë¡œê·¸ë¥¼ ê¸°ë¡í•˜ê²Œ í•˜ì—¬ ì‹œìŠ¤í…œ ê³¼ë¶€í•˜ë¥¼ ìœ ë„í•  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: /etc/syslog.conf íŒŒì¼ì˜ ì†Œìœ ìê°€ root(ë˜ëŠ” bin, sys)ì´ê³ , ê¶Œí•œì´ 640 ì´í•˜ì¸ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: /etc/syslog.conf íŒŒì¼ì˜ ì†Œìœ ìê°€ root(ë˜ëŠ” bin, sys)ê°€ ì•„ë‹ˆê±°ë‚˜, ê¶Œí•œì´ 640 ì´í•˜ê°€ ì•„ë‹Œ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-11 ì ê²€ ê²°ê³¼" >> $result
u11=0
u11_syslog_files=("/etc/syslog.conf" "/etc/rsyslog.conf")
u11_Files_Directory_Management=0
u11_safe_check=0

for u11_syslog_file in "${u11_syslog_files[@]}";do
    echo "$u11_syslog_file Checking..." >> $target
    if [[ -e "$u11_syslog_file" ]];then
        echo "$u11_syslog_file íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        u11_file_owner_user=$(stat -c "%U" "$u11_syslog_file" 2> /dev/null)
        u11_file_owner=$(stat -c "%a" "$u11_syslog_file"  2> /dev/null| cut -c1)
        u11_file_group=$(stat -c "%a" "$u11_syslog_file"  2> /dev/null| cut -c2)
        u11_file_other=$(stat -c "%a" "$u11_syslog_file"  2> /dev/null| cut -c3)
        u11_check_suid=$(stat -c "%a" "$u11_syslog_file"  2> /dev/null| tr -d '\n' | wc -c)
        if [[ $u11_check_suid -ge 4 ]];then
            echo "$u11_file íŒŒì¼ì— SUID ê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. [ì˜ëª»ëœ SUID ì„¤ì •]" >> $target
            u11_safe_check=$((u11_safe_check+1))
        else
            if [[ $u11_file_owner_user == "root" || $u11_file_owner_user == "bin" || $u11_file_owner_user == "sys" ]];then
                echo "$syslog_file íŒŒì¼ì˜ ì†Œìœ ìê°€ root, bin, sysë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                if [ $u11_file_owner -le 6 ];then
                    echo "$u11_syslog_file íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    if [ $u11_file_group -le 4 ];then
                        echo "$u11_syslog_file íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 4ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        if [ $u11_file_other -eq 0 ];then
                            echo "$u11_syslog_file íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ì(Other) ê¶Œí•œì´ 0ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        else
                            echo "$u11_syslog_file íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ì(Other) ê¶Œí•œì´ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            u11_safe_check=$((u11_safe_check+1))
                        fi
                    else
                        echo "$u11_syslog_file íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 4ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        u11_safe_check=$((u11_safe_check+1))
                    fi
                else
                    echo "$u11_syslog_file íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    u11_safe_check=$((u11_safe_check+1)) 
                fi
            else
                echo "$u11_syslog_file íŒŒì¼ì˜ ì†Œìœ ìê°€ root, bin, sysê°€ ì•„ë‹Œ ë‹¤ë¥¸ ì‚¬ìš©ìë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                u11_safe_check=$((u11_safe_check+1))
            fi 
        fi
    else
        echo "$u11_syslog_file íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        u11=$((u11+1))
    fi
done


if [[ $u11_safe_check -ge 1 ]];then
    u11=$((u11+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u11 -ge 1 ]];then
    High=$((High+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u11_Files_Directory_Management=1
fi

cat << EOF
===== [U-12] /etc/services file owner and permission settings               =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-12   /etc/services íŒŒì¼ ì†Œìœ ì ë° ê¶Œí•œ ì„¤ì •                        " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : /etc/services íŒŒì¼ì„ ê´€ë¦¬ìë§Œ ì œì–´í•  ìˆ˜ ìˆê²Œ í•˜ì—¬ ë¹„ì¸ê°€ìë“¤ì˜ ì„ì˜ì ì¸ íŒŒì¼ ë³€ì¡°ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : services íŒŒì¼ì˜ ì ‘ê·¼ê¶Œí•œì´ ì ì ˆí•˜ì§€ ì•Šì„ ê²½ìš° ë¹„ì¸ê°€ ì‚¬ìš©ìê°€ ìš´ì˜ í¬íŠ¸ë²ˆí˜¸ë¥¼ ë³€ê²½í•˜ì—¬ ì •ìƒì ì¸ ì„œë¹„ìŠ¤ë¥¼ ì œí•œí•˜ê±°ë‚˜, í—ˆìš©ë˜ì§€ ì•Šì€ í¬íŠ¸ë¥¼ ì˜¤í”ˆí•˜ì—¬ ì•…ì„± ì„œë¹„ìŠ¤ë¥¼ ì˜ë„ì ìœ¼ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: /etc/services íŒŒì¼ì˜ ì†Œìœ ìê°€ root(ë˜ëŠ” bin, sys)ì´ê³ , ê¶Œí•œì´ 644 ì´í•˜ì¸ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: /etc/services íŒŒì¼ì˜ ì†Œìœ ìê°€ root(ë˜ëŠ” bin, sys)ê°€ ì•„ë‹ˆê±°ë‚˜, ê¶Œí•œì´ 644 ì´í•˜ê°€ ì•„ë‹Œ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-12 ì ê²€ ê²°ê³¼" >> $result
u12=0
u12_Files_Directory_Management=0
u12_safe_check=0
if [[ -e "/etc/services" ]];then
    echo "/etc/services íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
    u12_file_owner_user=$(stat -c "%U" "/etc/services" 2> /dev/null)
    u12_file_owner=$(stat -c "%a" "/etc/services"  2> /dev/null| cut -c1)
    u12_file_group=$(stat -c "%a" "/etc/services"  2> /dev/null| cut -c2)
    u12_file_other=$(stat -c "%a" "/etc/services"  2> /dev/null| cut -c3)
    u12_check_suid=$(stat -c "%a" "/etc/services"  2> /dev/null| tr -d '\n' | wc -c)
    if [[ $u12_check_suid -ge 4 ]];then
        echo "/etc/services íŒŒì¼ì— SUID ê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. [ì˜ëª»ëœ SUID ì„¤ì •]" >> $target
        u12_safe_check=$((u12_safe_check+1))
    else
        if [[ $u12_file_owner_user == "root" || $u12_file_owner_user == "bin" || $u12_file_owner_user == "sys" ]];then
            echo "$syslog_file íŒŒì¼ì˜ ì†Œìœ ìê°€ root, bin, sysë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            if [ $u12_file_owner -le 6 ];then
                echo "/etc/services íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                if [ $u12_file_group -le 4 ];then
                    echo "/etc/services íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 4ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    if [ $u12_file_other -le 4 ];then
                        echo "/etc/services íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ì(Other) ê¶Œí•œì´ 4 ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    else
                        echo "/etc/services íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ì(Other) ê¶Œí•œì´ 4 ì´ìƒì˜ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        u12_safe_check=$((u12_safe_check+1))
                    fi
                else
                    echo "/etc/services íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 4 ì´ìƒì˜ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    u12_safe_check=$((u12_safe_check+1))
                fi
            else
                echo "/etc/services íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 4 ì´ìƒì˜ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                u12_safe_check=$((u12_safe_check+1)) 
            fi
        else
            echo "/etc/services íŒŒì¼ì˜ ì†Œìœ ìê°€ root, bin, sysê°€ ì•„ë‹Œ ë‹¤ë¥¸ ì‚¬ìš©ìë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            u12_safe_check=$((u12_safe_check+1))
        fi 
    fi
else
    echo "/etc/services íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    u12=$((u12+1))
fi

if [[ $u12_safe_check -ge 1 ]];then
    u12=$((u12+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u12 -ge 1 ]];then
    High=$((High+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u12_Files_Directory_Management=1
fi

cat << EOF
===== [U-13] Check SUID, SGID, settings file               =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-13   SUID, SGID, ì„¤ì • íŒŒì¼ì ê²€                        " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ë¶ˆí•„ìš”í•œ SUID, SGID ì„¤ì • ì œê±°ë¡œ ì•…ì˜ì ì¸ ì‚¬ìš©ìì˜ ê¶Œí•œìƒìŠ¹ì„ ë°©ì§€í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : SUID, SGID íŒŒì¼ì˜ ì ‘ê·¼ê¶Œí•œì´ ì ì ˆí•˜ì§€ ì•Šì„ ê²½ìš° SUID, SGID ì„¤ì •ëœ íŒŒì¼ë¡œ íŠ¹ì • ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ root ê¶Œí•œ íšë“ ê°€ëŠ¥í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ì£¼ìš” ì‹¤í–‰íŒŒì¼ì˜ ê¶Œí•œì— SUIDì™€ SGIDì— ëŒ€í•œ ì„¤ì •ì´ ë¶€ì—¬ë˜ì–´ ìˆì§€ ì•Šì€ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ì£¼ìš” ì‹¤í–‰íŒŒì¼ì˜ ê¶Œí•œì— SUIDì™€ SGIDì— ëŒ€í•œ ì„¤ì •ì´ ë¶€ì—¬ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-13 ì ê²€ ê²°ê³¼" >> $result
u13=0
u13_Files_Directory_Management=0
u13_safe_check=0
u13_default_sugid_files=(
    "/usr/lib/x86_64-linux-gnu/utempter/utempter"
    "/usr/lib/xorg/Xorg.wrap"
    "/usr/lib/snapd/snap-confine"
    "/usr/lib/openssh/ssh-keysign"
    "/usr/lib/dbus-1.0/dbus-daemon-launch-helper"
    "/usr/libexec/camel-lock-helper-1.2"
    "/usr/libexec/polkit-agent-helper-1"
    "/usr/sbin/unix_chkpwd"
    "/usr/sbin/pppd"
    "/usr/sbin/pam_extrausers_chkpwd"
    "/usr/bin/newgrp"
    "/usr/bin/chsh"
    "/usr/bin/fusermount3"
    "/usr/bin/pkexec"
    "/usr/bin/chage"
    "/usr/bin/vmware-user-suid-wrapper"
    "/usr/bin/chfn"
    "/usr/bin/crontab"
    "/usr/bin/expiry"
    "/usr/bin/gpasswd"
    "/usr/bin/su"
    "/usr/bin/mount"
    "/usr/bin/sudo"
    "/usr/bin/umount"
    "/usr/bin/ssh-agent"
    "/usr/bin/passwd"
)

u13_check_sugid_files=(
    "/sbin/dump" 
    "/sbin/restore" 
    "/sbin/unix_chkpwd" 
    "/usr/bin/at" 
    "/usr/bin/lpq" 
    "/usr/bin/lpq-lpd" 
    "/usr/bin/lpr" 
    "/usr/bin/lpr-lpd" 
    "/usr/bin/lprm" 
    "/usr/bin/lprm-lpd" 
    "/usr/bin/newgrp" 
    "/usr/sbin/lpc" 
    "/usr/sbin/lpc-lpd" 
    "/usr/sbin/traceroute"
)

echo -e "${RED}Ubunt ì‹œìŠ¤í…œì˜ ê¸°ë³¸ì ìœ¼ë¡œ ì„¤ì •ëœ SUID, SGID íŒŒì¼ì„ ì œì™¸í•œ ì˜ëª»ëœ SUID, SGID ì„¤ì • íŒŒì¼ë“¤ì„ í™•ì¸í•©ë‹ˆë‹¤.${NC}"  >> $target
# ê²°ê³¼ë¥¼ ì €ì¥í•  ë°°ì—´
u13_questionable_files=()

# `find` ëª…ë ¹ì–´ì˜ ê²°ê³¼ë¥¼ ë°°ì—´ë¡œ ì €ì¥í•©ë‹ˆë‹¤.
mapfile -t u13_find_results < <(find / -xdev -user root -type f \( -perm -04000 -o -perm -02000 \) 2>/dev/null)

# ê° íŒŒì¼ì— ëŒ€í•´ ì œì™¸í•  ëª©ë¡ê³¼ ë¹„êµí•˜ì—¬ ì¤‘ë³µì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.
for u13_find_result in "${u13_find_results[@]}"; do
    u13_exclude=0
    for u13_exclude_file in "${u13_default_sugid_files[@]}"; do
        if [[ "$u13_find_result" == "$u13_exclude_file" ]]; then
            u13_exclude=1
            break
        fi
    done
    
    # ì¤‘ë³µë˜ì§€ ì•Šê±°ë‚˜ ì œì™¸ ëª©ë¡ì— í¬í•¨ë˜ì§€ ì•ŠëŠ” ê²½ìš° ë°°ì—´ì— ì¶”ê°€
    if [[ $u13_exclude -eq 0 ]]; then
        # ë°°ì—´ì— ì¶”ê°€í•˜ê¸° ì „ì— ì¤‘ë³µ í™•ì¸
        if [[ ! " ${u13_questionable_files[@]} " =~ " ${u13_find_result} " ]]; then
            u13_questionable_files+=("$u13_find_result")
        fi
    fi
done

if [[ ${#u13_questionable_files[@]} -gt 0 ]]; then
    u13_safe_check=$((u13_safe_check+1))
    echo "ë‹¤ìŒ íŒŒì¼ë“¤ì€ ì œì™¸ ëª©ë¡ì— ì—†ê±°ë‚˜ ì¤‘ë³µë˜ì§€ ì•Šìœ¼ë©°, ì˜ì‹¬ìŠ¤ëŸ¬ìš´ SUID, SGIDê°€ ì„¤ì •ë­ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
    for u13_questionable_file in "${u13_questionable_files[@]}"; do
        echo "$u13_questionable_file" >> $target
    done
else
    echo "ì œì™¸ ëª©ë¡ì— í¬í•¨ë˜ì§€ ì•ŠëŠ” íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤." >> $target
fi

echo -e "${RED}Check-List ê¸°ë°˜ì˜ ë¶ˆí•„ìš”í•œ SUID/SGID ì„¤ì • íŒŒì¼ ëª©ë¡ì„ ì ê²€í•©ë‹ˆë‹¤.${NC}" >> $target
for u13_check_sugid_file in "${u13_check_sugid_files[@]}";do
    u13_chekc_perm=$(stat -c "%A" "$u13_check_sugid_file" 2> /dev/null )
    if [[ $u13_chekc_perm == *s* || $u13_chekc_perm == *S* ]];then
        echo "$u13_check_sugid_file íŒŒì¼ì— ë¶ˆí•„ìš”í•œ SUID/SGID ê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
        u13_safe_check=$((u13_safe_check+1))
    fi
done

if [[ $u13_safe_check -ge 1 ]];then
    u13=$((u13+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u13 -ge 1 ]];then
    High=$((High+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u13_Files_Directory_Management=1
fi

cat << EOF
===== [U-14] Setting users, system startup files and environment file owners and permissions               =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-14 ì‚¬ìš©ì, ì‹œìŠ¤í…œ ì‹œì‘íŒŒì¼ ë° í™˜ê²½íŒŒì¼ ì†Œìœ ì ë° ê¶Œí•œ ì„¤ì •                        " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ë¹„ì¸ê°€ìì˜ í™˜ê²½ë³€ìˆ˜ ì¡°ì‘ìœ¼ë¡œ ì¸í•œ ë³´ì•ˆ ìœ„í—˜ì„ ë°©ì§€í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : í™ˆ ë””ë ‰í„°ë¦¬ ë‚´ì˜ ì‚¬ìš©ì íŒŒì¼ ë° ì‚¬ìš©ìë³„ ì‹œìŠ¤í…œ ì‹œì‘íŒŒì¼ ë“±ê³¼ ê°™ì€ í™˜ê²½ë³€ìˆ˜ íŒŒì¼ì˜ ì ‘ê·¼ê¶Œí•œ ì„¤ì •ì´ ì ì ˆí•˜ì§€ ì•Šì„ ê²½ìš° ë¹„ì¸ê°€ìê°€ í™˜ê²½ë³€ìˆ˜ íŒŒì¼ì„ ë³€ì¡°í•˜ì—¬ ì •ìƒ ì‚¬ìš©ì¤‘ì¸ ì‚¬ìš©ìì˜ ì„œë¹„ìŠ¤ê°€ ì œí•œ ë  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: í™ˆ ë””ë ‰í„°ë¦¬ í™˜ê²½ë³€ìˆ˜ íŒŒì¼ ì†Œìœ ìê°€ root ë˜ëŠ”, í•´ë‹¹ ê³„ì •ìœ¼ë¡œ ì§€ì •ë˜ì–´ ìˆê³ , í™ˆ ë””ë ‰í„°ë¦¬ í™˜ê²½ë³€ìˆ˜ íŒŒì¼ì— rootì™€ ì†Œìœ ìë§Œ ì“°ê¸° ê¶Œí•œì´ ë¶€ì—¬ëœ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: í™ˆ ë””ë ‰í„°ë¦¬ í™˜ê²½ë³€ìˆ˜ íŒŒì¼ ì†Œìœ ìê°€ root ë˜ëŠ”, í•´ë‹¹ ê³„ì •ìœ¼ë¡œ ì§€ì •ë˜ì§€ ì•Šê³ , í™ˆ ë””ë ‰í„°ë¦¬ í™˜ê²½ë³€ìˆ˜ íŒŒì¼ì— rootì™€ ì†Œìœ ì ì™¸ì— ì“°ê¸° ê¶Œí•œì´ ë¶€ì—¬ëœ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-14 ì ê²€ ê²°ê³¼" >> $result
u14_Files_Directory_Management=0
u14_safe_check=0
u14=0

u14_home_Environmental_files=(
    ".profile"
    ".kshrc"
    ".cshrc"
    ".bashrc"
    ".bash_profile"
    ".login"
    ".exrc"
    ".netrc"
    ".bash_logout"
    ".env"
    ".zshrc"
    ".zprofile"
)

u14_check_users=($(cat /etc/passwd | egrep -v '/sbin|false|sync' | awk -F':' '{print $1}'))
for u14_check_user in "${u14_check_users[@]}";do
    u14_user_home=($(getent passwd "$u14_check_user" | awk -F':' '{print$6}'))
    if [ -d "$u14_user_home" ];then
        echo "--------------------------------------" >> $target
        echo "$u14_check_user ì˜ í™ˆ ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        for u14_home_Environmental_file in "${u14_home_Environmental_files[@]}";do
            echo -e "${RED}Checking file: $u14_user_home/$u14_home_Environmental_file${NC}" >> $target
            if [ -e "$u14_user_home/$u14_home_Environmental_file" ];then
                echo "$u14_user_home/$u14_home_Environmental_file íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
                u14_file_owner=$(ls -l "$u14_user_home/$u14_home_Environmental_file" | awk '{print $4}')
                if [[ "$u14_file_owner" == "root" ]] || [[ "$u14_file_owner" == "$u14_check_user" ]]; then
                    echo "$u14_user_home/$u14_home_Environmental_file íŒŒì¼ì˜ ì†Œìœ ìê°€ root í˜¹ì€ í•´ë‹¹ ê³„ì •ìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target 
                    u14_permissions=$(stat -c "%A" "$u14_user_home/$u14_home_Environmental_file")
                    u14_group_perm=$(echo "$u14_permissions" | cut -c6)
                    u14_other_perm=$(echo "$u14_permissions" | cut -c9)
                    if [ "$u14_group_perm" == "w" ] || [ "$u14_other_perm" == "w" ]; then 
                        echo "$u14_user_home/$home_Environmental_file íŒŒì¼ì˜ ì†Œìœ ì ë° root ì™¸ì— ê¸°íƒ€ì‚¬ìš©ì(Other)ì— ëŒ€í•œ ì“°ê¸° ê¶Œí•œì´ ë¶€ì—¬ë˜ì–´ ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                        u14_safe_check=$((u14_safe_check+1))
                    else
                        echo "$u14_user_home/$u14_home_Environmental_file íŒŒì¼ì˜ ì†Œìœ ì ë° root ì™¸ì— ê¸°íƒ€ì‚¬ìš©ì(Other)ì— ëŒ€í•œ ì“°ê¸° ê¶Œí•œì´ ë¶€ì—¬ë˜ì–´ ìˆì§€ ì•Šì•„ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
                    fi
                else
                    echo "echo "$u14_user_home/$u14_home_Environmental_file íŒŒì¼ì˜ ì†Œìœ ìê°€ root í˜¹ì€ í•´ë‹¹ ê³„ì •ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆì§€ ì•Šì•„ ì·¨ì•½í•©ë‹ˆë‹¤."" >> $target
                    u14_safe_check=$((u14_safe_check+1))
                fi
            else
                echo "$u14_user_home/$u14_home_Environmental_file íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
            fi
        done
    fi
done

if [[ $u14_safe_check -ge 1 ]];then
    u14=$((u14+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u14 -ge 1 ]];then
    High=$((High+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u14_Files_Directory_Management=1
fi

cat << EOF
===== [U-15] world writable file check               =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-15 world writable íŒŒì¼ ì ê²€                        " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : world writable íŒŒì¼ì„ ì´ìš©í•œ ì‹œìŠ¤í…œ ì ‘ê·¼ ë° ì•…ì˜ì ì¸ ì½”ë“œ ì‹¤í–‰ì„ ë°©ì§€í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ì‹œìŠ¤í…œ íŒŒì¼ê³¼ ê°™ì€ ì¤‘ìš” íŒŒì¼ì— world writable ì„¤ì •ì´ ë  ê²½ìš°, ì¼ë°˜ì‚¬ìš©ì ë° ë¹„ì¸ê°€ëœ ì‚¬ìš©ìê°€ í•´ë‹¹ íŒŒì¼ì„ ì„ì˜ë¡œ ìˆ˜ì •, ì‚­ì œê°€ ê°€ëŠ¥í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ì‹œìŠ¤í…œ ì¤‘ìš” íŒŒì¼ì— world writable íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜, ì¡´ì¬ ì‹œ ì„¤ì • ì´ìœ ë¥¼ í™•ì¸í•˜ê³  ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ì‹œìŠ¤í…œ ì¤‘ìš” íŒŒì¼ì— world writable íŒŒì¼ì´ ì¡´ì¬í•˜ë‚˜ í•´ë‹¹ ì„¤ì • ì´ìœ ë¥¼ í™•ì¸í•˜ê³  ìˆì§€ ì•ŠëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-15 ì ê²€ ê²°ê³¼" >> $result
u15_Files_Directory_Management=0
u15_safe_check=0
u15=0

u15_world_wr=$(find / -type f -perm -2 -exec ls -l {} \; 2> /dev/null | wc -l)
if [[ $u15_world_wr -gt 0 ]];then
    echo "world writable íŒŒì¼ë“¤ì´ ì¡´ì¬í•©ë‹ˆë‹¤. [ê´€ë¦¬ìì™€ì˜ ìƒë‹´ í•„ìš”]" >> $target
    u15_safe_check=$((u15_safe_check+1))
else
    echo "world writable íŒŒì¼ë“¤ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [[ $u15_safe_check -ge 1 ]];then
    u15=$((u15+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u15 -ge 1 ]];then
    High=$((High+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u15_Files_Directory_Management=1
fi


cat << EOF
===== [U-16] Check device files that do not exist in /dev              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-16 /devì— ì¡´ì¬í•˜ì§€ ì•ŠëŠ” device íŒŒì¼ ì ê²€             " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ì‹¤ì œ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë””ë°”ì´ìŠ¤ë¥¼ ì°¾ì•„ ì œê±°í•¨ìœ¼ë¡œì¨ root íŒŒì¼ ì‹œìŠ¤í…œ ì†ìƒ ë° ë‹¤ìš´ ë“±ì˜ ë¬¸ì œë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ê³µê²©ìëŠ” rootkit ì„¤ì •íŒŒì¼ë“¤ì„ ì„œë²„ ê´€ë¦¬ìê°€ ì‰½ê²Œ ë°œê²¬í•˜ì§€ ëª»í•˜ë„ë¡ /devì— device íŒŒì¼ì¸ ê²ƒì²˜ëŸ¼ ìœ„ì¥í•˜ëŠ” ìˆ˜ë²•ì„ ë§ì´ ì‚¬ìš©í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: devì— ëŒ€í•œ íŒŒì¼ ì ê²€ í›„ ì¡´ì¬í•˜ì§€ ì•Šì€ device íŒŒì¼ì„ ì œê±°í•œ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: devì— ëŒ€í•œ íŒŒì¼ ë¯¸ì ê²€ ë˜ëŠ”, ì¡´ì¬í•˜ì§€ ì•Šì€ device íŒŒì¼ì„ ë°©ì¹˜í•œ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-16 ì ê²€ ê²°ê³¼" >> $result
u16_Files_Directory_Management=0
u16_safe_check=0
u16=0

u16_dev_find=$(find /dev -type f -exec ls -l {} \; 2> /dev/null | wc -l)
if [[ $u16_dev_find -gt 0 ]];then
    echo "/dev ë””ë ‰í„°ë¦¬ ë‚´ ë¶ˆí•„ìš”í•œ device íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
    u16_safe_check=$((u16_safe_check+1))
else
    echo "/dev ë””ë ‰í„°ë¦¬ ë‚´ ë¶ˆí•„ìš”í•œ device íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.." >> $target
fi

if [[ $u16 -ge 1 ]];then
    High=$((High+1))
fi

if [[ $u16_safe_check -ge 1 ]];then
    u16=$((u16+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u16 -ge 1 ]];then
    High=$((High+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u16_Files_Directory_Management=1
fi


cat << EOF
===== [U-17] \$HOME/.rhosts, hosts.equiv disabled              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-17 \$HOME/.rhosts, hosts.equiv ì‚¬ìš© ê¸ˆì§€             " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : â€˜râ€™ command ì‚¬ìš©ì„ í†µí•œ ì›ê²© ì ‘ì†ì€ ì¸ì¦ ì—†ì´ ê´€ë¦¬ì ì›ê²©ì ‘ì†ì´ ê°€ëŠ¥í•˜ë¯€ë¡œ ì„œë¹„ìŠ¤ í¬íŠ¸ë¥¼ ì°¨ë‹¨í•´ì•¼ í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ :  rlogin, rsh ë“±ê³¼ ê°™ì€ â€˜râ€™ commandì˜ ë³´ì•ˆ ì„¤ì •ì´ ì ìš©ë˜ì§€ ì•Šì€ ê²½ìš°, ì›ê²©ì§€ì˜ ê³µê²©ìê°€ ê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ ëª©í‘œ ì‹œìŠ¤í…œìƒì˜ ì„ì˜ì˜ ëª…ë ¹ì„ ìˆ˜í–‰ì‹œí‚¬ìˆ˜ ìˆìœ¼ë©°, ëª…ë ¹ì–´ ì›ê²© ì‹¤í–‰ì„ í†µí•´ ì¤‘ìš” ì •ë³´ ìœ ì¶œ ë° ì‹œìŠ¤í…œ ì¥ì• ë¥¼ ìœ ë°œì‹œí‚¬ ìˆ˜ ìˆìŒ. ë˜í•œ ê³µê²©ì ë°±ë„ì–´ ë“±ìœ¼ë¡œë„ í™œìš©ë  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜:  login, shell, exec ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê±°ë‚˜, ì‚¬ìš© ì‹œ ì•„ë˜ì™€ ê°™ì€ ì„¤ì •ì´ ì ìš©ëœ ê²½ìš°" >> $target
echo " 1. /etc/hosts.equiv ë° $HOME/.rhosts íŒŒì¼ ì†Œìœ ìê°€ root ë˜ëŠ”, í•´ë‹¹ ê³„ì •ì¸ ê²½ìš°" >> $target
echo " 2. /etc/hosts.equiv ë° $HOME/.rhosts íŒŒì¼ ê¶Œí•œì´ 600 ì´í•˜ì¸ ê²½ìš°" >> $target
echo " 3. /etc/hosts.equiv ë° $HOME/.rhosts íŒŒì¼ ì„¤ì •ì— â€˜+â€™ ì„¤ì •ì´ ì—†ëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ogin, shell, exec ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³ , ìœ„ì™€ ê°™ì€ ì„¤ì •ì´ ì ìš©ë˜ì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-17 ì ê²€ ê²°ê³¼" >> $result
u17_Files_Directory_Management=0
u17_safe_check=0
u17=0
u17_check_users=($(cat /etc/passwd | egrep -v 'nologin|sync|false' | awk -F':' '{print $1}'))
for u17_check_user in "${u17_check_users[@]}";do
    u17_user_home=($(getent passwd "$u17_check_user" | awk -F':' '{print$6}'))
    if [ -e "$u17_user_home/.rhosts" ];then
        u17_rhosts_owner=$(stat -c "%U" "$u17_user_home/.rhosts")
        if [[ "$u17_rhosts_owner" == "$u17_check_user" ||"$u17_rhosts_owner" == "root" ]];then
            echo "$u17_user_home/.rhosts íŒŒì¼ì˜ ì†Œìœ ìê°€ rooë˜ëŠ” $u17_check_user ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            u17_rhosts_perm=$(stat -c "%a" "$u17_user_home/.rhosts" | cut -c1)
            if [[ $u17_rhosts_perm -le 6 ]];then
                echo "$u17_user_home/.rhosts íŒŒì¼ì˜ ê¶Œí•œì´ 600ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
                if ! grep -qE "$u17_user_home/.rhosts";then
                    echo "$u17_user_home/.rhosts íŒŒì¼ì— + ì„¤ì •ì´ ë˜ì–´ìˆì§€ ì•Šì•„ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
                else
                    echo "$u17_user_home/.rhosts íŒŒì¼ì— + ì„¤ì •ì´ ë˜ì–´ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                    u17_safe_check=$((u17_safe_check+1))
                fi
            else
                echo "$u17_user_home/.rhosts íŒŒì¼ì˜ ê¶Œí•œì´ 600ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ì·¨ì•½í•©ë‹ˆë‹¤."  >> $target
                u17_safe_check=$((u17_safe_check+1))
            fi
        else
            echo "$u17_user_home/.rhostsíŒŒì¼ì˜ ì†Œìœ ì‘ $u17_check_userë¡œ ì„¤ì •ë˜ì–´ ìˆì§€ ì•Šì•„ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
            u17_safe_check=$((u17_safe_check+1))
        fi
    else
        echo "$u17_user_home/.rhosts íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
done
if [ -e "/etc/hosts.equiv" ];then
    u17_equivfile_owner=$(stat -c "%U" "/etc/hosts.equiv")
    if [[ "$u17_equivfile_owner" == "root" || "$u17_equivfile_owner" == "$u17_check_users" ]];then
        echo "/etc/hosts.equiv íŒŒì¼ì˜ ì†Œìœ ìê°€ ë˜ëŠ”, í•´ë‹¹ ê³„ì •ìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
        u17_equivfile_perm=$(stat -c "%a" "/etc/hosts.equiv")
        if [[ $u17_equivfile_perm -le 600 ]];then
             echo "/etc/hosts.equiv íŒŒì¼ì˜ ê¶Œí•œì´ 600ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
            if ! grep -qE "etc/hosts.equiv";then
                echo "/etc/hosts íŒŒì¼ì— + ì„¤ì •ì´ ë˜ì–´ìˆì§€ ì•Šì•„ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
            else
                echo "/etc/hosts íŒŒì¼ì— + ì„¤ì •ì´ ë˜ì–´ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                u17_safe_check=$((u17_safe_check+1))
            fi
        else
            echo "/etc/hosts.equiv íŒŒì¼ì˜ ê¶Œí•œì´ 600ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ì·¨ì•½í•©ë‹ˆë‹¤."  >> $target
            u17_safe_check=$((u17_safe_check+1))
        fi
    else
        echo "/etc/hosts.equiv íŒŒì¼ì˜ ì†Œìœ ì‘ rootë¡œ ì„¤ì •ë˜ì–´ ìˆì§€ ì•Šì•„ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
        u17_safe_check=$((u17_safe_check+1))
    fi
else
    echo "/etc/hosts.equiv íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

u17_service_checks=("login" "shell" "exec")
u17_service_count=0

for u17_service_check in "${u17_service_checks[@]}"; do
    if systemctl is-active --quiet "$u17_service_check"; then
        echo "login, shell, execì™€ ê°™ì€ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
        u17_safe_check=$((u17_safe_check+1))
    else
        u17_service_count=$((u17_service_count+1))
    fi
done
if [[ $u17_service_count -ge 1 ]];then
    echo "login, shell, exec ì™€ ê°™ì€ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆì§€ ì•Šì•„ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
fi



if [[ $u17_safe_check -ge 1 ]];then
    u17=$((u17+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u17 -ge 1 ]];then
    High=$((High+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u17_Files_Directory_Management=1
fi


cat << EOF
===== [U-18] Access IP and Port Restrictions              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-18 ì ‘ì† IP ë° í¬íŠ¸ ì œí•œ             " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : í—ˆìš©í•œ í˜¸ìŠ¤íŠ¸ë§Œ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê²Œ í•˜ì—¬ ì„œë¹„ìŠ¤ ì·¨ì•½ì ì„ ì´ìš©í•œ ì™¸ë¶€ì ê³µê²©ì„ ë°©ì§€í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ :  í—ˆìš©í•  í˜¸ìŠ¤íŠ¸ì— ëŒ€í•œ IP ë° í¬íŠ¸ì œí•œì´ ì ìš©ë˜ì§€ ì•Šì€ ê²½ìš°, Telnet, FTPê°™ì€ ë³´ì•ˆì— ì·¨ì•½í•œ ë„¤íŠ¸ì›Œí¬ ì„œë¹„ìŠ¤ë¥¼ í†µí•˜ì—¬ ë¶ˆë²•ì ì¸ ì ‘ê·¼ ë° ì‹œìŠ¤í…œ ì¹¨í•´ì‚¬ê³ ê°€ ë°œìƒí•  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ì ‘ì†ì„ í—ˆìš©í•  íŠ¹ì • í˜¸ìŠ¤íŠ¸ì— ëŒ€í•œ IP ì£¼ì†Œ ë° í¬íŠ¸ ì œí•œì„ ì„¤ì •í•œ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ì ‘ì†ì„ í—ˆìš©í•  íŠ¹ì • í˜¸ìŠ¤íŠ¸ì— ëŒ€í•œ IP ì£¼ì†Œ ë° í¬íŠ¸ ì œí•œì„ ì„¤ì •í•˜ì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-17 ì ê²€ ê²°ê³¼" >> $result
u18_Files_Directory_Management=0
u18_safe_check=0
u18=0
u18_allowcheck=10
if command -v iptables &> /dev/null; then
    echo "IPtables ì„œë¹„ìŠ¤ê°€ ì„¤ì¹˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
    if systemctl is-active --quiet "iptables";then
        echo "IPtables ì„œë¹„ìŠ¤ê°€ ì‚¬ìš©ì¤‘ì…ë‹ˆë‹¤." >> $target
        # ëª¨ë“  ACCEPT ê·œì¹™ì´ *ì™€ 0.0.0.0/0ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
        iptables -L -v -n | grep "ACCEPT" | grep -vE "^Chain" | while read -r u18_iptables_line; do
            # í•„ë“œë¥¼ ë¶„ë¦¬í•©ë‹ˆë‹¤.
            IFS=' ' read -r -a u18_iptables_fields <<< "$u18_iptables_line"
            # íŠ¸ë˜í”½ í—ˆìš© ì—¬ë¶€ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.
            if [[ "${u18_iptables_fields[5]}" == "*" && \
                "${u18_iptables_fields[6]}" == "*" && \
                "${u18_iptables_fields[7]}" == "0.0.0.0/0" && \
                "${u18_iptables_fields[8]}" == "0.0.0.0/0" ]]; then
                # ì²´í¬í•  ì²´ì¸ ë°°ì—´
                u18_chains=("INPUT" "OUTPUT" "FORWARD")

                # ê° ì²´ì¸ì— ëŒ€í•´ ê¸°ë³¸ ì •ì±…ê³¼ ê·œì¹™ í™•ì¸
                for u18_chain in "${u18_chains[@]}"; do
                    # ê¸°ë³¸ ì •ì±… í™•ì¸
                    u18_default_policy=$(iptables -L $u18_chain -n | grep "Chain $u18_chain" | awk '{print $4}')

                    # ê¸°ë³¸ ì •ì±…ì´ DROPì¸ì§€ í™•ì¸
                    if [ "$u18_default_policy" == "DROP" ]; then
                        # ê·œì¹™ì´ ìˆëŠ”ì§€ í™•ì¸
                        u18_rules=$(iptables -L $u18_chain -v -n | grep -v "^Chain")

                        # ê·œì¹™ì´ ì—†ëŠ” ê²½ìš°
                        if [ -z "$u18_rules" ]; then
                            echo "DROP ì •ì±…ì´ ê¸°ë³¸ ì •ì±…ìœ¼ë¡œ ë˜ì–´ ìˆì§€ë§Œ ê·œì¹™ì´ ì—†ìœ¼ë©°, ëª¨ë“  íŠ¸ë˜í”½ì„ í—ˆìš©í•˜ëŠ” ì •ì±…ì´ ì„¤ì •ë˜ì–´ ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                            echo "ëª¨ë“  íŠ¸ë˜í”½ì„ í—ˆìš©í•˜ëŠ” ê·œì¹™: $u18_iptables_line" >> $target
                            u18_allowcheck=$((u18_allowcheck-1))
                            u18_safe_check=$((u18_safe_check+1))
                            break
                        else
                            echo "DROP ì •ì±…ì´ ê¸°ë³¸ ì •ì±…ìœ¼ë¡œ ë˜ì–´ ìˆì§€ë§Œ ê·œì¹™ì´ ì¡´ì¬í•˜ë©°, ëª¨ë“  íŠ¸ë˜í”½ì„ í—ˆìš©í•˜ëŠ” ì •ì±…ì´ ì„¤ì •ë˜ì–´ ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                            echo "ëª¨ë“  íŠ¸ë˜í”½ì„ í—ˆìš©í•˜ëŠ” ê·œì¹™: $u18_iptables_line" >> $target
                            u18_allowcheck=$((u18_allowcheck-1))
                            u18_safe_check=$((u18_safe_check+1))
                            break
                        fi
                    else
                        echo "ê¸°ë³¸ ì •ì±…ì´ DROPì´ ì•„ë‹ˆë©°, ëª¨ë“  íŠ¸ë˜í”½ì„ í—ˆìš©í•˜ëŠ” ì •ì±…ì´ ì„¤ì •ë˜ì–´ ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                        echo "ëª¨ë“  íŠ¸ë˜í”½ì„ í—ˆìš©í•˜ëŠ” ê·œì¹™: $u18_iptables_line" >> $target
                        u18_allowcheck=$((u18_allowcheck-1))
                        u18_safe_check=$((u18_safe_check+1))
                        break
                    fi
                done
            fi
        done
        if [[ $u18_allowcheck -eq 10 ]];then
            echo "ëª¨ë“  íŠ¸ë˜í”½ì„ í—ˆìš©í•˜ëŠ” ì •ì±…ì´ ì„¤ì •ë˜ì–´ ìˆì§€ ì•Šì•„ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
        fi
    else
        echo "IPtables ì„œë¹„ìŠ¤ê°€ ì‚¬ìš©ì¤‘ì´ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
else
    echo "IPtables ì„œë¹„ìŠ¤ê°€ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤."  >> $target
fi
if [ -f "/sbin/ipf" ];then
    ehco "IPfilterë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
    u18_ipfilterfiles=("/etc/ipf/ipf.conf" "/etc/ipf/ipf.rules")
    for u18_ipfilterfile in "${u18_ipfilterfiles[@]}";do
        if [ -e "$u18_ipfilterfile" ];then
            if grep -q "pass" "$u18_ipfilterfile" && ! grep -q "block" "$u18_ipfilterfile"; then
                echo "ê¸°ë³¸ ì •ì±…ì´ ëª¨ë“  íŠ¸ë˜í”½ì„ í—ˆìš©í•˜ëŠ” ê²ƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                u18_safe_check=$((u18_safe_check+1))
                if ipf -l | grep -E "pass in|pass out"; then
                    echo "ëª¨ë“  íŠ¸ë˜í”½ì„ í—ˆìš©í•˜ëŠ” ê·œì¹™ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤." >> $target
                    u18_allowcheck=$((u18_allowcheck+1))
                    u18_safe_check=$((u18_safe_check+1))
                else
                    echo "ëª¨ë“  íŠ¸ë˜í”½ì„ í—ˆìš©í•˜ëŠ” ê·œì¹™ì´ ì—†ìŠµë‹ˆë‹¤." >> $target
                fi
            else
                echo "ê¸°ë³¸ ì •ì±…ì— ë¸”ë¡ ê·œì¹™ì´ í¬í•¨ë˜ì–´ ìˆê±°ë‚˜ ëª¨ë“  íŠ¸ë˜í”½ì„ í—ˆìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
            fi
        else    
            echo "ipfilterì„¤ì •íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        fi 
    done
else
    echo "IPfilterë¥¼ ì‚¬ìš©í•˜ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi
# TCP Wrapperë¥¼ ì‚¬ìš©í•˜ëŠ”ì§€ í™•ì¸
if [[ -f "/usr/sbin/tcpd" || -x "$(command -v tcpd)" ]]; then
    echo "TCP Wrapperë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target

    # /etc/hosts.allow íŒŒì¼ ì ê²€
    if [ -f "/etc/hosts.allow" ]; then
        if grep -vq "^\s*#" "/etc/hosts.allow";then
            if grep -iE "^\s*ALL:ALL\s*" "/etc/hosts.allow" | grep -qv "^\s*#"; then
                echo "/etc/hosts.allow íŒŒì¼ì— ALL:ALL ì„¤ì •ì´ ë˜ì–´ ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                u18_allowcheck=$((u18_allowcheck+1))
                u18_safe_check=$((u18_safe_check+1))
            else
                echo "/etc/hosts.allow íŒŒì¼ì— ALL:ALL ì„¤ì •ì´ ë˜ì–´ ìˆì§€ ì•Šì•„ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
            fi
        else
            echo "/etc/hosts.allow íŒŒì¼ ë‚´ì— ì„¤ì •ê°’ë“¤ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        fi
    else
        echo "/etc/hosts.allow íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi

    # /etc/hosts.deny íŒŒì¼ ì ê²€
    if [ -f "/etc/hosts.deny" ]; then
        if grep -vq "^\s*#" "/etc/hosts.deny";then
            if grep -iE "^\s*ALL:ALL\s*" "/etc/hosts.deny" | grep -qv "^\s*#"; then
                echo "/etc/hosts.deny íŒŒì¼ì— ALL:ALL ì„¤ì • í•­ëª©ì´ ì¡´ì¬í•˜ì—¬ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
            else
                echo "/etc/hosts.deny íŒŒì¼ì— ALL:ALL ì„¤ì • í•­ëª©ì´ ì¡´ì¬í•˜ì§€ ì•Šì•„ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                u18_allowcheck=$((u18_allowcheck+1))
                u18_safe_check=$((u18_safe_check+1))
            fi
        else
            echo "/etc/hosts.deny íŒŒì¼ ë‚´ì— ì„¤ì •ê°’ë“¤ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        fi
    else
        echo "/etc/hosts.deny íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi

else
    echo "TCP Wrapperë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [[ $u18_safe_check -ge 1 ]];then
    u18=$((u18+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u18 -ge 1 ]];then
    High=$((High+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u18_Files_Directory_Management=1
fi

cat << EOF
===== [U-19] Access IP and Port Restrictions              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-19 Finger ì„œë¹„ìŠ¤ ë¹„í™œì„±í™”             " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : Finger(ì‚¬ìš©ì ì •ë³´ í™•ì¸ ì„œë¹„ìŠ¤)ë¥¼ í†µí•´ì„œ ë„¤íŠ¸ì›Œí¬ ì™¸ë¶€ì—ì„œ í•´ë‹¹ ì‹œìŠ¤í…œì— ë“±ë¡ëœ ì‚¬ìš©ì ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆì–´ ë¹„ì¸ê°€ìì—ê²Œ ì‚¬ìš©ì ì •ë³´ê°€ ì¡°íšŒë˜ëŠ” ê²ƒì„ ì°¨ë‹¨í•˜ê³ ì í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ë¹„ì¸ê°€ìì—ê²Œ ì‚¬ìš©ì ì •ë³´ê°€ ì¡°íšŒë˜ì–´ íŒ¨ìŠ¤ì›Œë“œ ê³µê²©ì„ í†µí•œ ì‹œìŠ¤í…œ ê¶Œí•œ íƒˆì·¨ ê°€ëŠ¥ì„±ì´ ìˆìœ¼ë¯€ë¡œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ í•´ë‹¹ ì„œë¹„ìŠ¤ë¥¼ ì¤‘ì§€í•˜ì—¬ì•¼ í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: Finger ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„±í™” ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: Finger ì„œë¹„ìŠ¤ê°€ í™œì„±í™” ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-19 ì ê²€ ê²°ê³¼" >> $result
u19_Service_Management=0
u19_safe_check=0
u19=0
#finger ì„œë¹„ìŠ¤ëŠ” ë³´í†µ systemctlì´ë‚˜ pgrep ëª…ë ¹ì–´ë¡œëŠ” ë°”ë¡œ í™•ì¸í•  ìˆ˜ ì—†ìŒ
if [ -f "/etc/inetd.conf" ];then
    if grep -iqE "^\s*finger\s*stream\s*tcp\s*nowait\s*bin" "/etc/inetd.conf";then
        echo "/etc/inetd.conf íŒŒì¼ì— Finger ì„œë¹„ìŠ¤ê°€ í™œì„±í™” ë˜ì–´ ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
        u19_safe_check=$((u19_safe_check+1))
    elif grep -iqE "^#\s*finger\s*stream\s*tcp\s*nowait\s*bin" "/etc/inetd.conf";then
        echo "/etc/inetd.conf íŒŒì¼ì— Finger ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„±í™” ë˜ì–´ ìˆì–´ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
    else
        echo "/etc/inetd.conf íŒŒì¼ ë‚´ì— Finger ì„¤ì • í•­ëª©ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
elif [ -f "/etc/xinetd.d/finger" ];then
    u19_fingerconf=$(sed -n '/service finger/,/}/p' "/etc/xinetd.d/finger" | grep -v "^#" | grep -iE "^\s*disable" | awk '{print tolower($3)}' | sed -n '1p')
    u19_lower_string=$(echo "$u19_fingerconf" | tr '[:upper:]' '[:lower:]')
    if [[ $u19_lower_string == "no" ]];then
        echo "/etc/xinerd.d/finger ì„¤ì • íŒŒì¼ ë‚´ì— finger ì„œë¹„ìŠ¤ê°€ í™œì„±í™” ë˜ì–´ ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
        u19_safe_check=$((u19_safe_check+1))
    elif [[ $u19_lower_string == "yes" ]];then
        echo "/etc/xinetd.d/finger ì„¤ì • íŒŒì¼ ë‚´ì— finger ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„±í™” ë˜ì–´ ìˆì–´ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
    else
        echo "/etc/xinetd.d/finger ì„¤ì • íŒŒì¼ ë‚´ì— finger ì„œë¹„ìŠ¤ í•­ëª©ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
else
    echo "/etc/inetd.conf íŒŒì¼ ë° /etc/xinetd.d/finger íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [[ $u19_safe_check -ge 1 ]];then
    u19=$((u19+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u19 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u19_Service_Management=1
fi

cat << EOF
===== [U-20] Disable Finger Service              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-20  Anonymous FTP ë¹„í™œì„±í™”             " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ì‹¤í–‰ì¤‘ì¸ FTP ì„œë¹„ìŠ¤ì— ìµëª… FTP ì ‘ì†ì´ í—ˆìš©ë˜ê³  ìˆëŠ”ì§€ í™•ì¸í•˜ì—¬ ì ‘ì†í—ˆìš©ì„ ì°¨ë‹¨í•˜ëŠ” ê²ƒì„ ëª©ì ìœ¼ë¡œ í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : Anonymous FTP(ìµëª… FTP)ë¥¼ ì‚¬ìš© ì‹œ anonymous ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ í›„ ë””ë ‰í„°ë¦¬ì— ì“°ê¸° ê¶Œí•œì´ ì„¤ì •ë˜ì–´ ìˆë‹¤ë©´ ì•…ì˜ì ì¸ ì‚¬ìš©ìê°€ local exploitì„ ì‚¬ìš©í•˜ì—¬ ì‹œìŠ¤í…œì— ëŒ€í•œ ê³µê²©ì„ ê°€ëŠ¥í•˜ê²Œ í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: Anonymous FTP (ìµëª… ftp) ì ‘ì†ì„ ì°¨ë‹¨í•œ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: Anonymous FTP (ìµëª… ftp) ì ‘ì†ì„ ì°¨ë‹¨í•˜ì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-20 ì ê²€ ê²°ê³¼" >> $result
u20_Service_Management=0
u20_safe_check=0
u20=0
u20_ftpusers=("ftp" "anonymous")
u20_safe_check=0
for u20_ftpuser in "${u20_ftpusers[@]}";do
    if grep -q "$u20_ftpuser" "/etc/passwd";then
        u20_shellcheck_ftp=$(cat /etc/passwd | grep "$u20_ftpuser" | awk -F':' '{print $7}' | awk -F'/' '{print $3}')
        if [[ $u20_shellcheck == "nologin" ]];then
            echo "$u20_ftpuser ê³„ì •ì´ ì¡´ì¬í•˜ë©°, ì‰˜ ì„¤ì •ì´ nologin ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ftp ê³„ì¦ìœ¼ë¡œì˜ ë¡œê·¸ì¸ì„ ì œí•œí•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
        else
            echo "$u20_ftpuser ê³„ì •ì´ ì¡´ì¬í•˜ë©°, ì‰˜ ì„¤ì •ì´ nologinì´ ì•„ë‹™ë‹ˆë‹¤. í•´ë‹¹ ê³„ì •ì— ëŒ€í•œ ì‚­ì œì¡°ì¹˜ê°€ ì´ë£¨ì–´ì ¸ì•¼ í•©ë‹ˆë‹¤." >> $target
            u20_safe_check=$((u20_safe_check+1))
        fi
    else
        echo "$u20_ftpuser ê³„ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
done

u20_vsftpd_files=("/etc/vsftpd/vsftpd.conf" "/etc/vsftpd.conf")

for u20_vsftpd_file in "${u20_vsftpd_files[@]}";do
    if [ -f "$u20_vsftpd_file" ];then
        echo "$u20_vsftpd_file ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        u20_ftpoption=$(grep "anonymous_enable" $u20_vsftpd_file | grep -v "^\s*#" | awk -F'=' '{print $2}' | tr -d ' ')
        u20_lower_vsftpd=$(echo "$u20_ftpoption" | tr '[:upper:]' '[:lower:]')
        if [[ $u20_lower_vsftpd == "no" ]];then
            echo "$u20_vsftpd_file íŒŒì¼ì— Anonymous ì„¤ì •ì´ ì ì ˆí•˜ê²Œ ë¹„í™œì„±í™” ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
        else
            echo "$u20_vsftpd_file íŒŒì¼ì— Anonymous ì„¤ì •ì´ í™œì„±í™” ë˜ì–´ ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤."  >> $target
            u20_safe_check=$((u20_safe_check+1))
        fi
    else
        echo "$u20_vsftpd_file ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
done

u20_proftpd_files=("/etc/proftpd/proftpd.conf" "/etc/proftpd.conf")
for u20_proftpd_file in "${u20_proftpd_files[@]}"; do
    if [ -f "$u20_proftpd_file" ]; then
        echo "$u20_proftpd_file íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤" >> $target
        u20_proftpdoption=$(sed -n '/<Anonymous/,/<\/Anonymous>/p' "$u20_proftpd_file" | sed -n '/<Limit LOGIN/,/<\/Limit>/p' | grep -i "DenyAll")
        u20_lower_proftpd=$(echo "$u20_proftpdoption" | tr '[:upper:]' '[:lower:]')

        if sed -n '/<Anonymous/,/<\/Anonymous>/p' "$u20_proftpd_file" | grep -Eq "^\s*#"; then
            echo "Anonymous ë¸”ë¡ì´ ì£¼ì„ì²˜ë¦¬ ë˜ì–´ ìˆì–´ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
        else
            if sed -n '/<Anonymous/,/<\/Anonymous>/p' "$u20_proftpd_file" | grep -q "<Anonymous"; then
                if [[ "$u20_lower_proftpd" == *"denyall"* ]]; then
                    echo "Anonymous ê³„ì •ì— ëŒ€í•œ ì ‘ê·¼ì„ í—ˆìš©í•˜ì§€ ì•Šê³  ìˆì–´ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
                else
                    echo "Anonymous ê³„ì •ì— ëŒ€í•œ ì ‘ê·¼ì„ ê±°ë¶€í•˜ëŠ” ì„¤ì •ì´ ì¡´ì¬í•˜ì§€ ì•Šì•„ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                    u20_safe_check=$((u20_safe_check+1))
                fi
            else
                echo "Anonymous ë¸”ë¡ì´ ì¡´ì¬í•˜ì§€ ì•Šì•„ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
            fi
        fi
    else
        echo "$u20_proftpd_file íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
done

if [[ $u20_safe_check -ge 1 ]];then
    u20=$((u20+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u20 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u20_Service_Management=1
fi

cat << EOF
===== [U-21] Disabling r Family Services              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-21  r ê³„ì—´ ì„œë¹„ìŠ¤ ë¹„í™œì„±í™”             " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : r-command ì‚¬ìš©ì„ í†µí•œ ì›ê²© ì ‘ì†ì€ NET Backup ë˜ëŠ” í´ëŸ¬ìŠ¤í„°ë§ ë“± ìš©ë„ë¡œ ì‚¬ìš©ë˜ê¸°ë„ í•˜ë‚˜, ì¸ì¦ ì—†ì´ ê´€ë¦¬ì ì›ê²©ì ‘ì†ì´ ê°€ëŠ¥í•˜ì—¬ ì´ì— ëŒ€í•œ ë³´ì•ˆìœ„í˜‘ì„ ë°©ì§€í•˜ê³ ì í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ :  rsh, rlogin, rexec ë“±ì˜ r commandë¥¼ ì´ìš©í•˜ì—¬ ì›ê²©ì—ì„œ ì¸ì¦ì ˆì°¨ ì—†ì´ í„°ë¯¸ë„ ì ‘ì†, ì‰˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰ì´ ê°€ëŠ¥í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ë¶ˆí•„ìš”í•œ r ê³„ì—´ ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„±í™” ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ë¶ˆí•„ìš”í•œ r ê³„ì—´ ì„œë¹„ìŠ¤ê°€ í™œì„±í™” ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-21 ì ê²€ ê²°ê³¼" >> $result
u21_Service_Management=0
u21_safe_check=0
u21=0
u21_checkrcommands=("rsh" "rlogin" "rexec" "shell" "login" "exec")
u21_checkports=("514" "513" "512")

check_service_status "${u21_checkports}" "${u21_checkrcommands[@]}"
if [[ $? -eq 1 ]]; then
    echo "r ê³„ì—´ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
    u24_safe_check=$((u24_safe_check+1))
else
    echo "r ê³„ì—´ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [[ $u21_safe_check -ge 1 ]];then
    u21=$((u21+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi

if [[ $u21 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u21_Service_Management=1
fi

cat << EOF
===== [U-22] Crond file owner and permission settings              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-22  crond íŒŒì¼ ì†Œìœ ì ë° ê¶Œí•œ ì„¤ì •             " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : ê´€ë¦¬ìì™¸ cron ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë„ë¡ ì„¤ì •í•˜ê³  ìˆëŠ”ì§€ ì ê²€í•˜ëŠ” ê²ƒì„ ëª©ì ìœ¼ë¡œ í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : root ì™¸ ì¼ë°˜ì‚¬ìš©ìì—ê²Œë„ crontab ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•  ê²½ìš°, ê³ ì˜ ë˜ëŠ” ì‹¤ìˆ˜ë¡œ ë¶ˆë²•ì ì¸ ì˜ˆì•½ íŒŒì¼ ì‹¤í–‰ìœ¼ë¡œ ì‹œìŠ¤í…œ í”¼í•´ë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: crontab ëª…ë ¹ì–´ ì¼ë°˜ì‚¬ìš©ì ê¸ˆì§€ ë° cron ê´€ë ¨ íŒŒì¼ 640 ì´í•˜ì¸ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: crontab ëª…ë ¹ì–´ ì¼ë°˜ì‚¬ìš©ì ì‚¬ìš©ê°€ëŠ¥í•˜ê±°ë‚˜, crond ê´€ë ¨ íŒŒì¼ 640 ì´ìƒì¸ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-22 ì ê²€ ê²°ê³¼" >> $result
u22_cron_checkfiles=("crontab" "cron.allow" "cron.deny")
u22_cron_checkdirs=("cron.d" "cron.hourly" "cron.daily" "cron.weekly" "cron.monthly")
u22_cron_spools=("/var/spool/cron" "/var/spool/cron/crontabs")
u22=0
u22_Service_Management=0
u22_safe_check=0
# ëª…ë ¹ì–´ ì¶œë ¥ì„ ì½ì–´ ë°°ì—´ì— ì €ì¥
u22_crontab_pass_s=($(type -a crontab | sort | uniq))
for u22_crontab_pass in "${u22_crontab_pass_s[@]}";do
    if [ -f "$u22_crontab_pass" ];then
        u22_crontab_perm=$(stat -c "%a" "$u22_crontab_pass" | cut -c1)
        u22_crontab_group=$(stat -c "%a" "$u22_crontab_pass" | cut -c2)
        u22_crontab_other=$(stat -c "%A" "$u22_crontab_pass" | awk '{print substr($1, 8, 3)}')
        u22_crontab_owner=$(stat -c "%U" "$u22_crontab_pass")
        if [[ $u22_crontab_perm -lt 6 && $u22_crontab_group -lt 4 ]];then
            if [[ $u22_crontab_other == "---" ]];then
                if [[ $u22_crontab_owner == "root" ]];then
                    echo "$u22_crontab_pass íŒŒì¼ì— ëŒ€í•œ ì†Œìœ ì ë° ê¶Œí•œ ì„¤ì •ì´ ì ì ˆí•˜ê²Œ ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                else
                    echo "$u22_crontab_pass íŒŒì¼ì— ëŒ€í•œ 3.5 DoS ê³µê²©ì— ì·¨ì•½í•œ ì„œë¹„ìŠ¤ ë¹„í™œì„±í™”ìœ ìê°€ root ì†Œìœ ìê°€ ì•„ë‹Œ $u22_crontab_owenrë¡œ ì„¤ì •ë˜ì–´ ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                    u22_safe_check=$((u22_safe_check+1))
                fi
            else
                echo "$u22_crontab_pass íŒŒì¼ì— ëŒ€í•œ ê¸°íƒ€ ì‚¬ìš©ì(Other)ì— ëŒ€í•œ ê¶Œí•œì´ $u22_crontab_other ì„¤ì •ë˜ì–´ ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                u22_safe_check=$((u22_safe_check+1))
            fi
        else
            echo "$u22_crontab_pass íŒŒì¼ì˜ ê¶Œí•œì´ $u22_crontab_perm ìœ¼ë¡œ 640 ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©° ê¸°íƒ€ ì‚¬ìš©ì(Other)ì— ëŒ€í•œ ê¶Œí•œì´ ì„¤ì •ë˜ì–´ ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
            u22_safe_check=$((u22_safe_check+1))
        fi
    fi
done
for u22_cron_checkfile in "${u22_cron_checkfiles[@]}";do
    if [ -f "/etc/$u22_cron_checkfile" ];then
        u22_crontab_file_perm=$(stat -c "%a" "/etc/$u22_cron_checkfile" | cut -c1)
        u22_crontab_file_group=$(stat -c "%a" "/etc/$u22_cron_checkfile" | cut -c2)
        u22_crontab_file_other=$(stat -c "%A" "/etc/$u22_cron_checkfile" | awk '{print substr($1, 8, 3)}')
        u22_crontab_file_owner=$(stat -c "%U" "/etc/$u22_cron_checkfile")
        if [[ $u22_crontab_file_perm -lt 6 && $u22_crontab_file_group -lt 4 ]];then
            if [[ $u22_crontab_file_other == "---" ]];then
                if [[ $u22_crontab_file_owner == "root" ]];then
                    echo "/etc/$u22_cron_checkfile íŒŒì¼ì— ëŒ€í•œ ì†Œìœ ì ë° ê¶Œí•œ ì„¤ì •ì´ ì ì ˆí•˜ê²Œ ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                else
                    echo "/etc/$u22_cron_checkfile íŒŒì¼ì— ëŒ€í•œ ì†Œìœ ìê°€ root ì†Œìœ ìê°€ ì•„ë‹Œ $u22_crontab_file_perm ì„¤ì •ë˜ì–´ ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                    u22_safe_check=$((u22_safe_check+1))
                fi
            else
                echo "/etc/$u22_cron_checkfile íŒŒì¼ì— ëŒ€í•œ ê¸°íƒ€ ì‚¬ìš©ì(Other)ì— ëŒ€í•œ ê¶Œí•œì´ $u22_crontab_file_other ì„¤ì •ë˜ì–´ ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                u22_safe_check=$((u22_safe_check+1))
            fi
        else
            echo "/etc/$u22_cron_checkfile íŒŒì¼ì˜ ê¶Œí•œì´ $u22_crontab_file_perm ìœ¼ë¡œ 640 ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©° ê¸°íƒ€ ì‚¬ìš©ì(Other)ì— ëŒ€í•œ ê¶Œí•œì´ ì„¤ì •ë˜ì–´ ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
            u22_safe_check=$((u22_safe_check+1))
        fi
    else
        echo "/etc/$u22_cron_checkfile íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
done
for u22_cron_checkdir in "${u22_cron_checkdirs[@]}";do
    if [ -d "/etc/$u22_cron_checkdir" ];then
        u22_cron_dirinfiles=($(ls -al "/etc/$u22_cron_checkdir" | awk '{print $9}' | grep -v "^\." | sed '1d'))
        if [ -n "$u22_cron_dirinfiles" ];then
            for u22_cron_dirinfile in "${u22_cron_dirinfiles[@]}";do
                if [ -f "/etc/$u22_cron_checkdir/$u22_cron_dirinfile" ];then
                    u22_crontab_dirf_perm=$(stat -c "%a" "/etc/$u22_cron_checkdir/$u22_cron_dirinfile" | cut -c1)
                    u22_crontab_dirf_group=$(stat -c "%a" "/etc/$u22_cron_checkdir/$u22_cron_dirinfile" | cut -c2)
                    u22_crontab_dirf_other=$(stat -c "%A" "/etc/$u22_cron_checkdir/$u22_cron_dirinfile" | awk '{print substr($1, 8, 3)}')
                    u22_crontab_dirf_owner=$(stat -c "%U" "/etc/$u22_cron_checkdir/$u22_cron_dirinfile")
                    if [[ $u22_crontab_dirf_perm -lt 6 && $u22_crontab_dirf_group -lt 4 ]];then
                        if [[ $u22_crontab_dirf_other == "---" ]];then
                            if [[ $u22_crontab_dirf_owner == "root" ]];then
                                echo "/etc/$u22_cron_checkdir/$u22_cron_dirinfile íŒŒì¼ì— ëŒ€í•œ ì†Œìœ ì ë° ê¶Œí•œ ì„¤ì •ì´ ì ì ˆí•˜ê²Œ ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            else
                                echo "/etc/$u22_cron_checkdir/$u22_cron_dirinfile íŒŒì¼ì— ëŒ€í•œ ì†Œìœ ìê°€ root ì†Œìœ ìê°€ ì•„ë‹Œ $u22_crontab_dirf_perm ì„¤ì •ë˜ì–´ ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                                u22_safe_check=$((u22_safe_check+1))
                            fi
                        else
                            echo "/etc/$u22_cron_checkdir/$u22_cron_dirinfile íŒŒì¼ì— ëŒ€í•œ ê¸°íƒ€ ì‚¬ìš©ì(Other)ì— ëŒ€í•œ ê¶Œí•œì´ $u22_crontab_dirf_other ì„¤ì •ë˜ì–´ ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                            u22_safe_check=$((u22_safe_check+1))
                        fi
                    else
                        echo "/etc/$u22_cron_checkdir/$u22_cron_dirinfile íŒŒì¼ì˜ ê¶Œí•œì´ $u22_crontab_dirf_owner ìœ¼ë¡œ 640 ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©° ê¸°íƒ€ ì‚¬ìš©ì(Other)ì— ëŒ€í•œ ê¶Œí•œì´ ì„¤ì •ë˜ì–´ ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                        u22_safe_check=$((u22_safe_check+1))
                    fi
                fi
            done
        else
            echo "/etc/$u22_cron_checkdir ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•˜ë‚˜, íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        fi
    else
        echo "/etc/$u22_cron_checkdir ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
done
for u22_cron_spool in "${u22_cron_spools[@]}";do
    if [ -d "$u22_cron_spool" ];then
        u22_cron_spoolinfiles=($(ls -al $u22_cron_spool | awk '{print $9}' | grep -v "^\." | sed '1d'))
        if [ -n "$u22_cron_spoolinfiles" ];then
            for u22_cron_spoolinfile in "${u22_Cron_spoolinfiles[@]}";do
                if [ -f "$u22_cron_spool/$u22_cron_spoolinfile" ];then
                    u22_crontab_spool_perm=$(stat -c "%a" "$u22_cron_spool/$u22_cron_spoolinfile" | cut -c1)
                    u22_crontab_spool_group=$(stat -c "%a" "$u22_cron_spool/$u22_cron_spoolinfile" | cut -c2)
                    u22_crontab_spool_other=$(stat -c "%A" "$u22_cron_spool/$u22_cron_spoolinfile" | awk '{print substr($1, 8, 3)}')
                    u22_crontab_spool_owner=$(stat -c "%U" "$u22_cron_spool/$u22_cron_spoolinfile")
                    if [[ $u22_crontab_spool_perm -lt 6 && $u22_crontab_spool_group -lt 4 ]];then
                        if [[ $u22_crontab_spool_other == "---" ]];then
                            if [[ $u22_crontab_spool_owner == "root" ]];then
                                echo "$u22_cron_spool/$u22_cron_spoolinfile íŒŒì¼ì— ëŒ€í•œ ì†Œìœ ì ë° ê¶Œí•œ ì„¤ì •ì´ ì ì ˆí•˜ê²Œ ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            else
                                echo "$u22_cron_spool/$u22_cron_spoolinfile íŒŒì¼ì— ëŒ€í•œ ì†Œìœ ìê°€ root ì†Œìœ ìê°€ ì•„ë‹Œ $u22_crontab_spool_perm ì„¤ì •ë˜ì–´ ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                                u22_safe_check=$((u22_safe_check+1))
                            fi
                        else
                            echo "$u22_cron_spool/$u22_cron_spoolinfile íŒŒì¼ì— ëŒ€í•œ ê¸°íƒ€ ì‚¬ìš©ì(Other)ì— ëŒ€í•œ ê¶Œí•œì´ $u22_crontab_spool_other ì„¤ì •ë˜ì–´ ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                            u22_safe_check=$((u22_safe_check+1))
                        fi
                    else
                        echo "$u22_cron_spool/$u22_cron_spoolinfile íŒŒì¼ì˜ ê¶Œí•œì´ $u22_crontab_spool_owner ìœ¼ë¡œ 640 ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©° ê¸°íƒ€ ì‚¬ìš©ì(Other)ì— ëŒ€í•œ ê¶Œí•œì´ ì„¤ì •ë˜ì–´ ìˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                        u22_safe_check=$((u22_safe_check+1))
                    fi
                fi
            done
        else
            echo "$u22_cron_spool ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•˜ë‚˜ íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        fi
    else
        echo "$u22_cron_spool ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
done

if [[ $u22_safe_check -ge 1 ]];then
    u22=$((u22+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u22 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u22_Service_Management=1
fi

cat << EOF
===== [U-23] Disabling a Service Vulnerable to DoS Attacks              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-23 DoS ê³µê²©ì— ì·¨ì•½í•œ ì„œë¹„ìŠ¤ ë¹„í™œì„±í™”               " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : ì‹œìŠ¤í…œ ë³´ì•ˆì„±ì„ ë†’ì´ê¸° ìœ„í•´ ì·¨ì•½ì ì´ ë§ì´ ë°œí‘œëœ echo, discard, daytime, chargen, ntp, snmp ë“± ì„œë¹„ìŠ¤ë¥¼ ì¤‘ì§€í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ :  í•´ë‹¹ ì„œë¹„ìŠ¤ê°€ í™œì„±í™”ë˜ì–´ ìˆëŠ” ê²½ìš° ì‹œìŠ¤í…œ ì •ë³´ ìœ ì¶œ ë° DoS(ì„œë¹„ìŠ¤ ê±°ë¶€ ê³µê²©)ì˜ ëŒ€ìƒì´ ë  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” DoS ê³µê²©ì— ì·¨ì•½í•œ ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„±í™” ëœ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” DoS ê³µê²©ì— ì·¨ì•½í•œ ì„œë¹„ìŠ¤ê°€ í™œì„±í™” ëœ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-23 ì ê²€ ê²°ê³¼" >> $result
# ntp ì„œë¹„ìŠ¤ëŠ” ë³´í†µ ë³„ë„ì˜ ë°ëª¬(ntpd, chronyd)ìœ¼ë¡œ ê´€ë¦¬ë¨ (inetd.confì—ëŠ” ì—†ìŒ)
# snmp ì„œë¹„ìŠ¤ëŠ” ë³„ë„ì˜ ë°ëª¬(snmpd)ìœ¼ë¡œ ê´€ë¦¬ë¨ (inetd.confì—ëŠ” ì—†ìŒ)
# dns ì„œë¹„ìŠ¤ëŠ” ë³´í†µ ë³„ë„ì˜ ë°ëª¬(named, systemd-resolved)ìœ¼ë¡œ ê´€ë¦¬ë¨ (inetd.confì—ëŠ” ì—†ìŒ)
# smtp ì„œë¹„ìŠ¤ëŠ” ë³´í†µ ë³„ë„ì˜ ë°ëª¬(postfix, exim, sendmail)ìœ¼ë¡œ ê´€ë¦¬ë¨ (inetd.confì—ëŠ” ì—†ìŒ)

# ntpd ë˜ëŠ” chronydëŠ” /etc/xinetd.d íŒŒì¼ì´ ì•„ë‹Œ ë³„ë„ì˜ ë°ëª¬ìœ¼ë¡œ ê´€ë¦¬ë˜ë©°, /etc/xinetd.dì—ëŠ” í•­ëª©ì´ ì—†ìŒ systemctlë¡œ ìƒíƒœë¥¼ í™•ì¸í•˜ê³  ì„¤ì •í•  ìˆ˜ ìˆìŒ
# snmp ëŠ” /etc/xinetd.d íŒŒì¼ì´ ì•„ë‹Œ ë³„ë„ì˜ ë°ëª¬ìœ¼ë¡œ ê´€ë¦¬ë˜ë©°, /etc/xinetd.dì—ëŠ” í•­ëª©ì´ ì—†ìŒ systemctlë¡œ ìƒíƒœë¥¼ í™•ì¸í•˜ê³  ì„¤ì •í•  ìˆ˜ ìˆìŒ
# named (BIND) ë˜ëŠ” systemd-resolvedëŠ” /etc/xinetd.d íŒŒì¼ì´ ì•„ë‹Œ ë³„ë„ì˜ ë°ëª¬ìœ¼ë¡œ ê´€ë¦¬ë˜ë©°, /etc/xinetd.dì—ëŠ” í•­ëª©ì´ ì—†ìŒ. ëŒ€ì‹  systemctlë¡œ ìƒíƒœë¥¼ í™•ì¸í•˜ê³  ì„¤ì •í•  ìˆ˜ ìˆìŒ
# (smtp) postfix, exim, ë˜ëŠ” sendmailì€ /etc/xinetd.d íŒŒì¼ì´ ì•„ë‹Œ ë³„ë„ì˜ ë°ëª¬ìœ¼ë¡œ ê´€ë¦¬ë˜ë©°, /etc/xinetd.dì—ëŠ” í•­ëª©ì´ ì—†ìŒ. ëŒ€ì‹  systemctlë¡œ ìƒíƒœë¥¼ í™•ì¸í•˜ê³  ì„¤ì •í•  ìˆ˜ ìˆìŒ:
u23=0
u23_Service_Management=0
u23_safe_check=0
u23_service_checks=("echo" "discard" "daytime" "chargen" "ntp" "snmp" "tcpmux" "time" "smtp" "domain")
u23_service_ports=("7" "9" "13" "19" "123" "161" "68" "37" "25" "53")
u23_inetd_checks=("echo" "discard" "daytime" "chargen" "tcpmux" "time")
u23_xinetd_checks=("echo" "discard" "daytime" "chargen" "tcpmux" "time")
u23_systemctl_checks=("ntpd" "chronyd" "snmpd" "named" "systemd-resolved" "postfix" "exim" "sendmail")
u23_length=${#u23_service_checks[@]}
# systemctl ì„œë¹„ìŠ¤ ì²´í¬
for u23_systemctl_check in "${u23_systemctl_checks[@]}"; do
    if systemctl is-active --quiet "$u23_systemctl_check"; then
        echo "í˜„ì¬ ì‹œìŠ¤í…œì— $u23_systemctl_check ì„œë¹„ìŠ¤ê°€ í™œì„±í™” ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ë¹„í™œì„±í™”ê°€ ì´ë£¨ì–´ì ¸ì•¼ í•©ë‹ˆë‹¤." >> $target
        u23_safe_check=$((u23_safe_check+1))
    else
        echo "í˜„ì¬ ì‹œìŠ¤í…œì— $u23_systemctl_check ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„±í™” ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
    fi
done

# ë„¤íŠ¸ì›Œí¬ í¬íŠ¸ ì²´í¬
u23_netstat_ports=$(netstat -tuln | awk '{print $4}' | awk -F':' '{print $2}')

for ((i=0; i<$u23_length; i++)); do
    u23_port=${u23_service_ports[$i]}
    u23_service=${u23_service_checks[$i]}
    
    if echo "$u23_netstat_ports" | grep -qE "^$u23_port$"; then
        echo "$u23_service ì„œë¹„ìŠ¤ê°€ $u23_port ë²ˆ í¬íŠ¸ë²ˆí˜¸ë¡œ ì„œë¹„ìŠ¤ê°€ ë™ì‘ì¤‘ì…ë‹ˆë‹¤." >> $target
    else
        u23_newport=$(grep -wE "^$u23_service\s+" /etc/services | awk '{print $2}' | awk -F'/' '{print $1}' | head -n 1)
        if [ -n "$u23_newport" ]; then
            echo "$u23_service ì„œë¹„ìŠ¤ê°€ $u23_newport í¬íŠ¸ë²ˆí˜¸ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            if echo "$u23_netstat_ports" | grep -qE "^$u23_newport$"; then
                echo "$u23_service ì„œë¹„ìŠ¤ê°€ $u23_newport í¬íŠ¸ë²ˆí˜¸ë¡œ ì„œë¹„ìŠ¤ê°€ ë™ì‘ì¤‘ì…ë‹ˆë‹¤." >> $target
                u23_safe_check=$((u23_safe_check+1))
            else
                echo "$u23_service ì„œë¹„ìŠ¤ê°€ $u23_newport í¬íŠ¸ë²ˆí˜¸ë¡œ ë™ì‘ì¤‘ì¸ ì„œë¹„ìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤." >> $target
            fi
        else
            echo "$u23_service ì„œë¹„ìŠ¤ê°€ /etc/services íŒŒì¼ì— ì •ì˜ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        fi
    fi        
done

# inetd ì„œë¹„ìŠ¤ ì²´í¬
if [ -f "/etc/inetd.conf" ]; then
    for u23_inetd_check in "${u23_inetd_checks[@]}"; do
        if grep -qiwE "^\s*$u23_inetd_check" /etc/inetd.conf; then
            echo "/etc/inetd.conf íŒŒì¼ì—ì„œ $u23_inetd_check ì„œë¹„ìŠ¤ê°€ í™œì„±í™” ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            u23_safe_check=$((u23_safe_check+1))
        else
            echo "/etc/inetd.conf íŒŒì¼ì—ì„œ $u23_inetd_check ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„±í™” ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
        fi
    done
else
    echo "/etc/inetd.conf íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

# xinetd ì„œë¹„ìŠ¤ ì²´í¬
if [ -d "/etc/xinetd.d" ]; then
    for u23_xinetd_check in "${u23_xinetd_checks[@]}"; do
        if [ -f "/etc/xinetd.d/$u23_xinetd_check" ]; then
            u23_xinetd_conf=$(grep -iE "\s*disable" "/etc/xinetd.d/$u23_xinetd_check" | grep -v "^#" | awk '{print $3}' | head -n 1)
            if [[ "$u23_xinetd_conf" == "no" ]]; then
                echo "/etc/xinetd.d/$u23_xinetd_check íŒŒì¼ë‚´ì— $u23_xinetd_check í•­ëª©ì´ í™œì„±í™” ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                u23_safe_check=$((u23_safe_check+1))
            else
                echo "/etc/xinetd.d/$u23_xinetd_check íŒŒì¼ë‚´ì— $u23_xinetd_check í•­ëª©ì´ ë¹„í™œì„±í™” ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            fi
        else
            echo "/etc/xinetd.d/$u23_xinetd_check íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        fi
    done
else
    echo "/etc/xinetd.d ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [[ $u23_safe_check -ge 1 ]];then
    u23=$((u23+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u23 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u23_Service_Management=1
fi

cat << EOF
===== [U-24] Disable NFS Service              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-24 NFS ì„œë¹„ìŠ¤ ë¹„í™œì„±í™”               " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : NFS(Network File System) ì„œë¹„ìŠ¤ëŠ” í•œ ì„œë²„ì˜ íŒŒì¼ì„ ë§ì€ ì„œë¹„ìŠ¤ ì„œë²„ë“¤ì´ ê³µìœ í•˜ì—¬ ì‚¬ìš©í•  ë•Œ ë§ì´ ì´ìš©ë˜ëŠ” ì„œë¹„ìŠ¤ì´ì§€ë§Œ ì´ë¥¼ ì´ìš©í•œ ì¹¨í•´ì‚¬ê³  ìœ„í—˜ì„±ì´ ë†’ìœ¼ë¯€ë¡œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²½ìš° ì¤‘ì§€í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : NFS ì„œë¹„ìŠ¤ëŠ” ì„œë²„ì˜ ë””ìŠ¤í¬ë¥¼ í´ë¼ì´ì–¸íŠ¸ì™€ ê³µìœ í•˜ëŠ” ì„œë¹„ìŠ¤ë¡œ ì ì •í•œ ë³´ì•ˆì„¤ì •ì´ ì ìš©ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´ ë¶ˆí•„ìš”í•œ íŒŒì¼ ê³µìœ ë¡œ ì¸í•œ ìœ ì¶œìœ„í—˜ì´ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ë¶ˆí•„ìš”í•œ NFS ì„œë¹„ìŠ¤ ê´€ë ¨ ë°ëª¬ì´ ë¹„í™œì„±í™” ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ë¶ˆí•„ìš”í•œ NFS ì„œë¹„ìŠ¤ ê´€ë ¨ ë°ëª¬ì´ í™œì„±í™” ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-24 ì ê²€ ê²°ê³¼" >> $result
u24=0
u24_Service_Management=0
u24_safe_check=0
u24_nfs_daemons=("nfs" "nfsd" "rpc.mountd" "rpcbind" "statd" "lockd" "nfs-kernel-server")
u24_nfs_ports=("111" "2049")

check_service_status "${u24_nfs_ports}" "${u24_nfs_daemons[@]}"
if [[ $? -eq 1 ]]; then
    echo "nfs ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
    u24_safe_check=$((u24_safe_check+1))
else
    echo "nfs ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [[ $u24_safe_check -ge 1 ]];then
    u24=$((u24+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u24 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u24_Service_Management=1
fi


cat << EOF
===== [U-25] NFS access control              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-25 NFS ì ‘ê·¼ í†µì œ               " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : ì ‘ê·¼ê¶Œí•œì´ ì—†ëŠ” ë¹„ì¸ê°€ìì˜ ì ‘ê·¼ì„ í†µì œí•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : ì ‘ê·¼ì œí•œ ì„¤ì •ì´ ì ì ˆí•˜ì§€ ì•Šì„ ê²½ìš° ì¸ì¦ì ˆì°¨ ì—†ì´ ë¹„ì¸ê°€ìì˜ ë””ë ‰í„°ë¦¬ë‚˜ íŒŒì¼ì˜ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë©°, í•´ë‹¹ ê³µìœ  ì‹œìŠ¤í…œì— ì›ê²©ìœ¼ë¡œ ë§ˆìš´íŠ¸í•˜ì—¬ ì¤‘ìš” íŒŒì¼ì„ ë³€ì¡°í•˜ê±°ë‚˜ ìœ ì¶œí•  ìœ„í—˜ì´ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ë¶ˆí•„ìš”í•œ NFS ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê±°ë‚˜, ë¶ˆê°€í”¼í•˜ê²Œ ì‚¬ìš© ì‹œ everyone ê³µìœ ë¥¼ ì œí•œí•œ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ë¶ˆí•„ìš”í•œ NFS ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆê³ , everyone ê³µìœ ë¥¼ ì œí•œí•˜ì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-25 ì ê²€ ê²°ê³¼" >> $result
u25=0
u25_Service_Management=0
u25_safe_check=0

if [ -f "/etc/exports" ];then
    echo "/etc/exports íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤" >> $target
    u25_nfsoptions=$(grep -Ev "^\s*#" /etc/exports | grep "*" | awk -F'(' '{print $2}' | sed 's/[\(|\)]//g')
    if [ -n "$u25_nfsoptions" ];then
        echo "NFS ì„¤ì • íŒŒì¼ ë‚´ì—  everyone ì„¤ì •ì„ í†µí•´ ëª¨ë“  ì‚¬ìš©ìê°€ ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
        u25_safe_check=$((u25_safe_check+1))
        echo "ì„¤ì •ëœ ê°’ : $u25_nfsoptions" >> $target
        IFS=',' read -ra u25_nfsoptions_arry <<< "$u25_nfsoptions"
        for u25_nfsoption in "${u25_nfsoptions_arry[@]}";do
            case "$u25_nfsoption" in
                rw)
                    echo "$u25_nfsoption ì˜µì…˜ì´ ì„¤ì •ë˜ì–´ ì½ê¸°/ì“°ê¸° ëª¨ë“œë¥¼ í—ˆìš©í•©ë‹ˆë‹¤." >> $target
                    ;;
                sync)
                    echo "$u25_nfsoption ì˜µì…˜ì´ ì„¤ì •ë˜ì–´ ë°ì´í„°ë¥¼ ë””ìŠ¤í¬ì— ì¦‰ì‹œ ì“°ê³  ì‘ë‹µí•©ë‹ˆë‹¤." >> $target
                    ;;
                no_root_squash)
                    echo "$u25_nfsoption ì˜µì…˜ì´ ì„¤ì •ë˜ì–´ í´ë¼ì´ì–¸íŠ¸ì˜ ë£¨íŠ¸ ì‚¬ìš©ìë„ ì„œë²„ì—ì„œëŠ” ì¼ë°˜ ì‚¬ìš©ì ê¶Œí•œìœ¼ë¡œ ì ‘ê·¼í•˜ë„ë¡ í—ˆìš©ë©ë‹ˆë‹¤." >> $target
                    ;;  
                no_subtree_check)
                    echo "$u25_nfsoption ì˜µì…˜ì´ ì„¤ì •ë˜ì–´ ì„œë¸ŒíŠ¸ë¦¬ ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    ;;
                *)
                    echo "$u25_nfsoption ì˜µì…˜ì´ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    ;;
            esac
        done
    else
        echo "/etc/exports íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ë§Œ ê´€ë ¨ ì„¤ì • ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
else
    echo "/etc/exports íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."  >> $target
fi

if [[ $u25_safe_check -ge 1 ]];then
    u25=$((u25+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u25 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u25_Service_Management=1
fi

cat << EOF
===== [U-26] Remove automountd              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-26 automountd ì œê±°               " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : ë¡œì»¬ ê³µê²©ìê°€ automountd ë°ëª¬ì— RPC(Remote Procedure Call)ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆëŠ” ì·¨ì•½ì ì´ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— í•´ë‹¹ ì„œë¹„ìŠ¤ê°€ ì‹¤í–‰ì¤‘ì¼ ê²½ìš° ì„œë¹„ìŠ¤ë¥¼ ì¤‘ì§€ì‹œí‚¤ê¸° ìœ„í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : íŒŒì¼ ì‹œìŠ¤í…œì˜ ë§ˆìš´íŠ¸ ì˜µì…˜ì„ ë³€ê²½í•˜ì—¬ root ê¶Œí•œì„ íšë“í•  ìˆ˜ ìˆìœ¼ë©°, ë¡œì»¬ ê³µê²©ìê°€ automountd í”„ë¡œì„¸ìŠ¤ ê¶Œí•œìœ¼ë¡œ ì„ì˜ì˜ ëª…ë ¹ì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: automountd ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„±í™” ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: automountd ì„œë¹„ìŠ¤ê°€ í™œì„±í™” ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-26 ì ê²€ ê²°ê³¼" >> $result
u26_Service_Management=0
u26_safe_check=0
u26=0
u26_automount_checks=("automoun" "autofs" "automountd") 
u26_ports=("0")

check_service_status "${u26_ports[@]}" "${u26_automount_checks[@]}"
if [ $? -eq 1 ]; then
    echo "automountd í”„ë¡œí† ì½œë§Œì„ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
    u26_safe_check=$((u26_safe_check+1))
else
    echo "automountd í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ìˆìŠµë‹ˆë‹¤." >> $target
fi

for u26_automount_check in "${u26_automount_checks[@]}";do
    u26_automount_rc=$(find /etc/init.d/ -type f -name  "$u26_automount_check")
    if [ -n "$u26_automount_rc" ];then
        echo "$u26_automount_rc ì‹œë™ ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹ë³„ë˜ì—ˆìŠµë‹ˆë‹¤. ì‚­ì œ ë˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ ì´ë¦„ì„ ë³€ê²½í•˜ì‹­ì‹œì˜¤." >> $target
        u26_safe_check=$((u26_safe_check+1))
    else
        echo "/etc/init.d/ ê²½ë¡œì—ì„œ $u26_automount_check ì‹œë™ ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹ë³„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤." >> $target
    fi
done

if [[ $u26_safe_check -ge 1 ]];then
    u26=$((u26+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u26 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u26_Service_Management=1
fi

cat << EOF
===== [U-27] Check RPC service              =====
=====                  Checking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-27 RPC ì„œë¹„ìŠ¤ í™•ì¸               " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : ë‹¤ì–‘í•œ ì·¨ì•½ì„±(ë²„í¼ ì˜¤ë²„í”Œë¡œìš°, Dos, ì›ê²©ì‹¤í–‰ ë“±)ì´ ì¡´ì¬í•˜ëŠ” RPC ì„œë¹„ìŠ¤ë¥¼ ì ê²€í•˜ì—¬ í•´ë‹¹ ì„œë¹„ìŠ¤ë¥¼ ë¹„í™œì„±í™” í•˜ë„ë¡ í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : ë²„í¼ ì˜¤ë²„í”Œë¡œìš°(Buffer Overflow), Dos, ì›ê²©ì‹¤í–‰ ë“±ì˜ ì·¨ì•½ì„±ì´ ì¡´ì¬í•˜ëŠ” RPC ì„œë¹„ìŠ¤ë¥¼ í†µí•´ ë¹„ì¸ê°€ìì˜ root ê¶Œí•œ íšë“ ë° ì¹¨í•´ì‚¬ê³  ë°œìƒ ìœ„í—˜ì´ ìˆìœ¼ë¯€ë¡œ ì„œë¹„ìŠ¤ë¥¼ ì¤‘ì§€í•˜ì—¬ì•¼ " >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ë¶ˆí•„ìš”í•œ RPC ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„±í™” ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ë¶ˆí•„ìš”í•œ RPC ì„œë¹„ìŠ¤ê°€ í™œì„±í™” ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-27 ì ê²€ ê²°ê³¼" >> $result
u27=0
u27_Service_Management=0
u27_safe_check=0
u27_services=(
    "rpc.cmsd"
    "rpc.ttdbserverd"
    "sadmind"
    "rusersd"
    "walld"
    "sprayd"
    "rstatd"
    "rpc.nisd"
    "rexd"
    "rpc.pcnfsd"
    "rpc.statd"
    "rpc.ypupdated"
    "rpc.rquotad"
    "kcms_server"
    "cachefsd"
    "rpc.lockd"
    "rpc.mountd"
    "rpc.quotad"
    "rpc.smserverd"
    "rpc.vxid"
    "rpc.ypserv"
    "rpc.yppasswdd"
    "rpc.bootparamd"
)
u27_ports=("111" "512" "150001" "875" "2108" "20048")

check_service_status "${u27_ports}" "${u27_services[@]}"
if [ $? -eq 1 ]; then
    echo "ë¶ˆí•„ìš”í•œ RPC ì„œë¹„ìŠ¤ë¥¼  ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
    u27_safe_check=$((u27_safe_check+1))
else
    echo "ë¶ˆí•„ìš”í•œ RPC ì„œë¹„ìŠ¤ë¥¼  ì‚¬ìš©í•˜ì§€ ì•Šê³  ìˆìŠµë‹ˆë‹¤." >> $target
fi

if [[ $u27_safe_check -ge 1 ]];then
    u27=$((u27+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u27 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u27_Service_Management=1
fi

cat << EOF
===== [U-28] NIS, NIS+ check              =====
=====                  Checking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-28 NIS, NIS+ ì ê²€               " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : ì•ˆì „í•˜ì§€ ì•Šì€ NIS ì„œë¹„ìŠ¤ë¥¼ ë¹„í™œì„±í™” í•˜ê³  ì•ˆì „í•œ NIS+ ì„œë¹„ìŠ¤ë¥¼ í™œì„±í™” í•˜ì—¬ ì‹œìŠ¤í…œ ë³´ì•ˆìˆ˜ì¤€ì„ í–¥ìƒí•˜ê³ ì í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : ë³´ì•ˆìƒ ì·¨ì•½í•œ ì„œë¹„ìŠ¤ì¸ NISë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ë¹„ì¸ê°€ìê°€ íƒ€ì‹œìŠ¤í…œì˜ root ê¶Œí•œ íšë“ì´ ê°€ëŠ¥í•˜ë¯€ë¡œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ê°€ì¥ ë°”ëŒì§í•˜ë‚˜ ë§Œì•½ NISë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ê²½ìš° ì‚¬ìš©ì ì •ë³´ë³´ì•ˆì— ë§ì€ ë¬¸ì œì ì„ ë‚´í¬í•˜ê³  ìˆëŠ” NISë³´ë‹¤ NIS+ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•¨ " >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: NIS ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„±í™” ë˜ì–´ ìˆê±°ë‚˜, í•„ìš” ì‹œ NIS+ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: NIS ì„œë¹„ìŠ¤ê°€ í™œì„±í™” ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-28 ì ê²€ ê²°ê³¼" >> $result
u28=0
u28_Service_Management=0
u28_safe_check=0
u28_services=(
    "ypserv"
    "ypbind"
    "ypxfrd"
    "rpc.yppasswdd"
    "rpc.ypupdated"
)
u28_port=("111")

check_service_status "${u28_port[@]}" "${u28_services[@]}"
if [ $? -eq 1 ]; then
    echo "ë¶ˆí•„ìš”í•œ RPC ì„œë¹„ìŠ¤ë¥¼  ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
    u28_safe_check=$((u28_safe_check+1))
else
    echo "ë¶ˆí•„ìš”í•œ RPC ì„œë¹„ìŠ¤ë¥¼  ì‚¬ìš©í•˜ì§€ ì•Šê³  ìˆìŠµë‹ˆë‹¤." >> $target
fi

for u28_service in "${u28_services[@]}"; do
    u28_nic_rc=$(find /etc/init.d/ -type f -name "*$u28_service*")
    if [ -n "$u28_nic_rc" ]; then
        echo "$u28_nic_rc ì‹œë™ ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹ë³„ë˜ì—ˆìŠµë‹ˆë‹¤. ì‚­ì œ ë˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ ì´ë¦„ì„ ë³€ê²½í•˜ì‹­ì‹œì˜¤." >> $target
        u28=$((u28+1))
    else
        echo "/etc/init.d/ ê²½ë¡œì—ì„œ $u28_service ì‹œë™ ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹ë³„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤." >> $target
    fi
done

if [[ $u28_safe_check -ge 1 ]];then
    u28=$((u28+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u28 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u28_Service_Management=1
fi

cat << EOF
===== [U-29] tftp, talk service disabled              =====
=====                  Checking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-29 tftp, talk ì„œë¹„ìŠ¤ ë¹„í™œì„±í™”               " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : ì•ˆì „í•˜ì§€ ì•Šê±°ë‚˜ ë¶ˆí•„ìš”í•œ ì„œë¹„ìŠ¤ë¥¼ ì œê±°í•¨ìœ¼ë¡œì¨ ì‹œìŠ¤í…œ ë³´ì•ˆì„± ë° ë¦¬ì†ŒìŠ¤ì˜ íš¨ìœ¨ì  ìš´ìš©" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì„œë¹„ìŠ¤ë‚˜ ì·¨ì•½ì ì´ ë°œí‘œëœ ì„œë¹„ìŠ¤ ìš´ìš© ì‹œ ê³µê²© ì‹œë„ ê°€ëŠ¥" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: tftp, talk, ntalk ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„±í™” ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: tftp, talk, ntalk ì„œë¹„ìŠ¤ê°€ í™œì„±í™” ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-28 ì ê²€ ê²°ê³¼" >> $result
u29=0
u29_Service_Management=0
u29_safe_check=0
u29_services=("tftp" "talk" "ntalk")
u29_ports=("69" "517" "518")

check_service_status "${u29_ports}" "${u29_services[@]}"
if [ $? -eq 1 ]; then
    echo "ë¶ˆí•„ìš”í•œ RPC ì„œë¹„ìŠ¤ë¥¼  ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
    u29_safe_check=$((u29_safe_check+1))
else
    echo "ë¶ˆí•„ìš”í•œ RPC ì„œë¹„ìŠ¤ë¥¼  ì‚¬ìš©í•˜ì§€ ì•Šê³  ìˆìŠµë‹ˆë‹¤." >> $target
fi

if [[ $u29_safe_check -ge 1 ]];then
    u29=$((u29+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u29 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u29_Service_Management=1
fi

cat << EOF
===== [U-30] Check Sendmail version              =====
=====                  Checking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-30 Sendmail ë²„ì „ ì ê²€               " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : Sendmail ì„œë¹„ìŠ¤ ì‚¬ìš© ëª©ì  ê²€í†  ë° ì·¨ì•½ì ì´ ì—†ëŠ” ë²„ì „ì˜ ì‚¬ìš© ìœ ë¬´ ì ê²€ìœ¼ë¡œ ìµœì í™”ëœ Sendmail ì„œë¹„ìŠ¤ì˜ ìš´ì˜" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : ì·¨ì•½ì ì´ ë°œê²¬ëœ Sendmail ë²„ì „ì˜ ê²½ìš° ë²„í¼ ì˜¤ë²„í”Œë¡œìš°(Buffer Overflow) ê³µê²©ì— ì˜í•œ ì‹œìŠ¤í…œ ê¶Œí•œ íšë“ ë° ì£¼ìš” ì •ë³´ ìš”ì¶œ ê°€ëŠ¥ì„±ì´ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: Sendmail ë²„ì „ì´ ìµœì‹ ë²„ì „ì¸ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: Sendmail ë²„ì „ì´ ìµœì‹ ë²„ì „ì´ ì•„ë‹Œ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-30 ì ê²€ ê²°ê³¼" >> $result
u30=0
u30_Service_Management=0
u30_safe_check=0
u30_sendmail_ver=$(apt-cache policy sendmail | sed -n '3p' | awk '{print $2}' | awk -F'-' '{print $1}')
u30_sendmail_latest=$(apt-cache policy sendmail | sed -n '3p' | awk '{print $2}' | awk -F'-' '{print $1}')

check_service_status "${u31_ports}" "${u31_service[@]}"
if [[ $? -eq 1 ]]; then
    echo "sendmail ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
    if [[ "$u30_sendmail_ver" == "$u30_sendmail_latest" ]]; then
        echo "í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ ì„œë¹„ìŠ¤ê°€ ìµœì‹ ë²„ì „ê³¼ ë™ì¼í•©ë‹ˆë‹¤." >> $target
        echo "í˜„ì¬ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” sendmail ì„œë¹„ìŠ¤ ë²„ì „ : $u30_sendmail_ver" >> $target
        echo "ìµœì‹  sendmail ì„œë¹„ìŠ¤ ë²„ì „ : $u30_sendmail_latest" >> $target
    else
        echo "í˜„ì¬ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” sendmail ì„œë¹„ìŠ¤ì˜ ë²„ì „ì´ ìµœì‹ ë²„ì „ê³¼ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        echo "í˜„ì¬ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” sendmail ì„œë¹„ìŠ¤ ë²„ì „ : $u30_sendmail_ver" >> $target
        echo "ìµœì‹  sendmail ì„œë¹„ìŠ¤ ë²„ì „ : $u30_sendmail_latest" >> $target
        u30_safe_check=$((u30_safe_check+1))
    fi
else
    echo "sendmail ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    if [[ "$u30_sendmail_ver" == "$u30_sendmail_latest" ]]; then
        echo "í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ ì„œë¹„ìŠ¤ê°€ ìµœì‹ ë²„ì „ê³¼ ë™ì¼í•©ë‹ˆë‹¤." >> $target
        echo "í˜„ì¬ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” sendmail ì„œë¹„ìŠ¤ ë²„ì „ : $u30_sendmail_ver" >> $target
        echo "ìµœì‹  sendmail ì„œë¹„ìŠ¤ ë²„ì „ : $u30_sendmail_latest" >> $target
    else
        echo "í˜„ì¬ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” sendmail ì„œë¹„ìŠ¤ì˜ ë²„ì „ì´ ìµœì‹ ë²„ì „ê³¼ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        echo "í˜„ì¬ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” sendmail ì„œë¹„ìŠ¤ ë²„ì „ : $u30_sendmail_ver" >> $target
        echo "ìµœì‹  sendmail ì„œë¹„ìŠ¤ ë²„ì „ : $u30_sendmail_latest" >> $target
        u30_safe_check=$((u30_safe_check+1))
    fi
fi

if [[ $u30_safe_check -ge 1 ]];then
    u30=$((u30+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u30 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u30_Service_Management=1
fi

cat << EOF
===== [U-31] Spam mail relay restrictions              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-31 ìŠ¤íŒ¸ ë©”ì¼ ë¦´ë ˆì´ ì œí•œ              " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : ìŠ¤íŒ¸ ë©”ì¼ ì„œë²„ë¡œì˜ ì•…ìš©ë°©ì§€ ë° ì„œë²„ ê³¼ë¶€í•˜ì˜ ë°©ì§€ë¥¼ ìœ„í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : SMTP ì„œë²„ì˜ ë¦´ë ˆì´ ê¸°ëŠ¥ì„ ì œí•œí•˜ì§€ ì•ŠëŠ” ê²½ìš°, ì•…ì˜ì ì¸ ì‚¬ìš©ëª©ì ì„ ê°€ì§„ ì‚¬ìš©ìë“¤ì´ ìŠ¤íŒ¸ë©”ì¼ ì„œë²„ë¡œ ì‚¬ìš©í•˜ê±°ë‚˜ Dosê³µê²©ì˜ ëŒ€ìƒì´ ë  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: SMTP ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê±°ë‚˜ ë¦´ë ˆì´ ì œí•œì´ ì„¤ì •ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: SMTP ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©° ë¦´ë ˆì´ ì œí•œì´ ì„¤ì •ë˜ì–´ ìˆì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-31 ì ê²€ ê²°ê³¼" >> $result
u31=0
u31_Service_Management=0
u31_safe_check=0
u31_service=("sendmail" "postfix" "exim" "sendmail.service" "postfix.service" "exim.service")
u31_ports=("25" "465" "587")
u31_logic() {
    if [ -f "/etc/mail/sendmail.cf" ];then
        echo "/etc/mail/sendmail.cf íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        if grep -iv "^\s*#" "/etc/mail/sendmail.cf" | grep -iqE 'R\$\*\s*\$:\s*\$1\s*RELAY';then
            echo "ëª¨ë“  ì¡°ê±´ì—ì„œ ëª¨ë“  ë¦´ë ˆì´ë¥¼ í—ˆìš©í•˜ëŠ” ê·œì¹™ì´ ì •ì˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            u31_safe_check=$((u31_safe_check+1))
        elif grep -ivE "^\s*#" "/etc/mail/sendmail.cf" | grep -iE 'R\$\s*' | grep -iqE '\$@\s*5\.7\.1|(Relaying|Relay?ing)\s*(denie?d|denied)';then
            echo "ë¦´ë ˆì´ë¥¼ ì œí•œí•˜ëŠ” ê·œì¹™ì´ ì •ì˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
        else
            echo "/etc/mail/sendmail.cf íŒŒì¼ ë‚´ì—ì„œ ëª¨ë“  ì¡°ê±´ì—ì„œ ëª¨ë“  ë¦´ë ˆì´ë¥¼ í—ˆìš©í•˜ëŠ” ê·œì¹™ ë° ë¦´ë ˆì´ë¥¼ ì œí•œí•˜ëŠ” ê·œì¹™ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        fi
    else
        echo "/etc/mail/sendmail.cf íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
    if [ -f "/etc/mail/access" ];then
        echo "/etc/mail/access íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        if grep -vE "^\s*#" "/etc/mail/access" | grep -iqE "\s*Connect:ALL\s*RELAY";then
            echo "ëª¨ë“  ì—°ê²°ì— ëŒ€í•œ ë¦´ë ˆì´ ì„¤ì •ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
            u31_safe_check=$((u31_safe_check+1))
        else
            if grep -vE "^\s*#" "/etc/mail/access" | grep -iE "relay$" | awk '{print $1}' | awk -F':' '{print $2}' | grep -ivqE "localhost.localdomain|localhost|127.0.0.1|127|IPv6:::1|IPv6";then
                echo "localhostë¥¼ ì œì™¸í•œ IP, domain, Email Addressì— ëŒ€í•œ ë¦´ë ˆì´ í—ˆìš© ì„¤ì •ê°’ì´ ì¡´ì¬í•©ë‹ˆë‹¤."  >> $target
            else
                echo "localhostë¥¼ ì œì™¸í•œ IP, domain, Email Addressì— ëŒ€í•œ ë¦´ë ˆì´ í—ˆìš©ì„ ì œì™¸í•œ ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
            fi
        fi
    else
        echo "/etc/mail/access íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
}

check_service_status "${u31_ports}" "${u31_service[@]}"
if [[ $? -eq 1 ]]; then
    echo "sendmail ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
    u31_logic
    u31_safe_check=$((u31_safe_check+1))
else
    echo "sendmail ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    u31_logic
fi

if [[ $u31_safe_check -ge 1 ]];then
    u31=$((u31+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u31 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u31_Service_Management=1
fi

cat << EOF
===== [U-32] Prevent end-user Sendmail execution              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-32 ì¼ë°˜ì‚¬ìš©ìì˜ Sendmail ì‹¤í–‰ ë°©ì§€              " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : ì¼ë°˜ì‚¬ìš©ìì˜ q ì˜µì…˜ì„ ì œí•œí•˜ì—¬ Sendmail ì„¤ì • ë° ë©”ì¼íë¥¼ ê°•ì œì ìœ¼ë¡œ drop ì‹œí‚¬ ìˆ˜ ì—†ê²Œ í•˜ì—¬ ë¹„ì¸ê°€ìì— ì˜í•œ SMTP ì„œë¹„ìŠ¤ ì˜¤ë¥˜ ë°©ì§€" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : ì¼ë°˜ ì‚¬ìš©ìê°€ q ì˜µì…˜ì„ ì´ìš©í•´ì„œ ë©”ì¼í, Sendmail ì„¤ì •ì„ ë³´ê±°ë‚˜ ë©”ì¼íë¥¼ ê°•ì œì ìœ¼ë¡œ drop ì‹œí‚¬ ìˆ˜ ìˆì–´ ì•…ì˜ì ìœ¼ë¡œ SMTP ì„œë²„ì˜ ì˜¤ë¥˜ë¥¼ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: SMTP ì„œë¹„ìŠ¤ ë¯¸ì‚¬ìš© ë˜ëŠ”, ì¼ë°˜ ì‚¬ìš©ìì˜ Sendmail ì‹¤í–‰ ë°©ì§€ê°€ ì„¤ì •ëœ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: SMTP ì„œë¹„ìŠ¤ ì‚¬ìš© ë° ì¼ë°˜ ì‚¬ìš©ìì˜ Sendmail ì‹¤í–‰ ë°©ì§€ê°€ ì„¤ì •ë˜ì–´ ìˆì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-32 ì ê²€ ê²°ê³¼" >> $result
u32=0
u32_Service_Management=0
u32_safe_check=0
u32_service=("sendmail" "postfix" "exim" "sendmail.service" "postfix.service" "exim.service")
u32_ports=("25" "465" "587")

check_service_status "${u32_ports}" "${u32_service[@]}"
if [[ $? -eq 1 ]]; then
    echo "sendmail ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
    u32_sendmail_conf=$(grep -vE "^\s*#" "/etc/mail/sendmail.cf" | grep -i "PrivacyOptions")
    if grep -vE "^\s*#" "/etc/mail/sendmail.cf" | grep -i "PrivacyOptions" | grep -qi "restrictqrun";then
        echo "ë©”ì¼ í(queue)ì— ëŒ€í•œ ì¼ë°˜ ì‚¬ìš©ìì˜ ì ‘ê·¼ì„ ì œí•œí•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
        echo "í˜„ì¬ ì„¤ì •ëœ ê°’ : $u32_sendmail_conf" >> $target
    else
        echo "ë©”ì¼ í(queue)ì— ëŒ€í•œ ì¼ë°˜ ì‚¬ìš©ìì˜ ì ‘ê·¼ì„ ì œí•œí•˜ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        echo "í˜„ì¬ ì„¤ì •ëœ ê°’ : $u32_sendmail_conf" >> $target
        u32_safe_check=$((u32_safe_check+1))
    fi
    u32_safe_check=$((u32_safe_check+1))
else
    echo "sendmail ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    u32_sendmail_conf=$(grep -vE "^\s*#" "/etc/mail/sendmail.cf" | grep -i "PrivacyOptions")
    if grep -vE "^\s*#" "/etc/mail/sendmail.cf" | grep -i "PrivacyOptions" | grep -qi "restrictqrun";then
        echo "ë©”ì¼ í(queue)ì— ëŒ€í•œ ì¼ë°˜ ì‚¬ìš©ìì˜ ì ‘ê·¼ì„ ì œí•œí•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
        echo "í˜„ì¬ ì„¤ì •ëœ ê°’ : $u32_sendmail_conf" >> $target
    else
        echo "ë©”ì¼ í(queue)ì— ëŒ€í•œ ì¼ë°˜ ì‚¬ìš©ìì˜ ì ‘ê·¼ì„ ì œí•œí•˜ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        echo "í˜„ì¬ ì„¤ì •ëœ ê°’ : $u32_sendmail_conf" >> $target
        u32_safe_check=$((u32_safe_check+1))
    fi
fi

if [[ $u32_safe_check -ge 1 ]];then
    u32=$((u32+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u32 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u32_Service_Management=1
fi

cat << EOF
===== [U-33] DNS Security Version Patch              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-33 DNS ë³´ì•ˆ ë²„ì „ íŒ¨ì¹˜              " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : ì·¨ì•½ì ì´ ë°œí‘œë˜ì§€ ì•Šì€ BIND ë²„ì „ì˜ ì‚¬ìš©ì„ ëª©ì ìœ¼ë¡œ í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : ìµœì‹ ë²„ì „(2016.01 ê¸°ì¤€ 9.10.3-P2) ì´í•˜ì˜ ë²„ì „ì—ì„œëŠ” ì„œë¹„ìŠ¤ê±°ë¶€ ê³µê²©, ë²„í¼ì˜¤ë²„í”Œë¡œìš°(Buffer Overflow) ë° DNS ì„œë²„ ì›ê²© ì¹¨ì… ë“±ì˜ ì·¨ì•½ì„±ì´ ì¡´ì¬í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: DNS ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê±°ë‚˜ ì£¼ê¸°ì ìœ¼ë¡œ íŒ¨ì¹˜ë¥¼ ê´€ë¦¬í•˜ê³  ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: DNS ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©° ì£¼ê¸°ì ìœ¼ë¡œ íŒ¨ì¹˜ë¥¼ ê´€ë¦¬í•˜ê³  ìˆì§€ ì•ŠëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-33 ì ê²€ ê²°ê³¼" >> $result
# Inverse Query ì·¨ì•½ì  (Buffer Overflow) : BIND 4.9.7ì´ì „ ë²„ì „ê³¼ BIND 8.1.2 ì´ì „ ë²„ì „
# NXTë²„ê·¸ (buffer overflow) : BIND 8.2, 8.2 p1, 8.2.1ë²„ì „

# solingerë²„ê·¸ (Denial of Service) : BIND 8.1 ì´ìƒë²„ì „
# fdmax ë²„ê·¸ (Denial of Service) : BIND 8.1 ì´ìƒë²„ì „
# Remote Execution of Code(Buffer Overflow) : BIND 4.9.5 to 4.9.10, 8.1, 8.2 to 8.2.6, 8.3.0 to 8.3.3 ë²„ì „
# Multiple Denial of Service: BIND 8.3.0 - 8.3.3, 8.2 - 8.2.6 ë²„ì „
# LIBRESOLV: buffer overrun(Buffer Overflow) : BIND 4.9.2 to 4.9.10 ë²„ì „
# OpenSSL (buffer overflow) : BIND 9.1, BIND 9.2 if built with OpenSSL(configure --with-openssl)
# libbind (buffer overflow) : BIND 4.9.11, 8.2.7, 8.3.4, 9.2.2 ì´ì™¸ì˜ ëª¨ë“  ë²„ì „
# DoS internal consistency check (Denial of Service) : BIND 9 ~ 9.2.0 ë²„ì „
# tsig bug (Access possible) : BIND 8.2 ~ 8.2.3 ë²„ì „
# complain bug (Stack corruption, possible remote access) : BIND 4.9.x ê±°ì˜ ëª¨ë“  ë²„ì „
# zxfr bug (Denial of service) : BIND 8.2.2, 8.2.2 patchlevels 1 through 6 ë²„ì „
# sigdiv0 bug (Denial of service) : BIND 8.2, 8.2 patchlevel 1, 8.2.2 ë²„ì „
# srv bug(Denial of service): BIND 8.2, 8.2 patchlevel 1, 8.2.1, 8.2.2, 8.2.2 patchlevels 1-6 ë²„ì „
# nxt bug (Access possible) : BIND 8.2, 8.2 patchlevel 1, 8.2.1 ë²„ì „

# BIND 4.9.8 ì´ì „ ë²„ì „, 8.2.3 ì´ì „ ë²„ì „ê³¼ ê´€ë ¨ëœ ì·¨ì•½ì 
# - TSIG í•¸ë“¤ë§ ë²„í¼ì˜¤ë²„í”Œë¡œìš° ì·¨ì•½ì 
# - nslookupComplain() ë²„í¼ì˜¤ë²„í”Œë¡œìš° ì·¨ì•½ì 
# - nslookupComplain() input validation ì·¨ì•½ì 
# - information leak ì·¨ì•½ì 
# - sig bug Denial of service ì·¨ì•½ì 
# - naptr bug Denial of service ì·¨ì•½ì 
# - maxdname bug Denial of service ì·¨ì•½ì 
u33=0
u33_Service_Management=0
u33_safe_check=0
u33_current_ver=$(dpkg -s bind9 | grep '^Version' | awk '{print $2}')
u33_latest_ver=$(apt-cache show bind9 | grep '^Version' | head -n 1 | awk '{print $2}')
u33_services=("named" "dnsmasq" "unbound" "pdns_server" "bind9.service" "pdns_server" "bind9" "dnsmasq.service" "unbound.service" "pdns.service")
u33_ports=("53" "853 " "443")

check_service_status "${u33_ports}" "${u33_services[@]}"
if [[ $? -eq 1 ]]; then
    echo "DNS ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
    if [[ "$u33_current_ver" == "$u33_latest_ver" ]];then
        echo "í˜„ì¬ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” DNS(named) ì„œë¹„ìŠ¤ì˜ ë²„ì „ì´ ìµœì‹ ë²„ì „ê³¼ ì¼ì¹˜í•©ë‹ˆë‹¤." >> $target
        echo "í˜„ì¬ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” DNS(named) ì„œë¹„ìŠ¤ ë²„ì „ : $u33_current_ver" >> $target
        echo "ìµœì‹  DNS(named) ì„œë¹„ìŠ¤ ë²„ì „ : $u33_latest_ver" >> $target
    else
        echo "í˜„ì¬ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” DNS(named) ì„œë¹„ìŠ¤ì˜ ë²„ì „ì´ ìµœì‹ ë²„ì „ê³¼ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        echo "í˜„ì¬ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” DNS(named) ì„œë¹„ìŠ¤ ë²„ì „ : $u33_current_ver" >> $target
        echo "ìµœì‹  DNS(named) ì„œë¹„ìŠ¤ ë²„ì „ : $u33_latest_ver" >> $target
        u33_safe_check=$((u33_safe_check+1))
    fi
    u33_safe_check=$((u33_safe_check+1))
else
    echo "DNS ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    if [[ "$u33_current_ver" == "$u33_latest_ver" ]];then
        echo "í˜„ì¬ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” DNS(named) ì„œë¹„ìŠ¤ì˜ ë²„ì „ì´ ìµœì‹ ë²„ì „ê³¼ ì¼ì¹˜í•©ë‹ˆë‹¤." >> $target
        echo "í˜„ì¬ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” DNS(named) ì„œë¹„ìŠ¤ ë²„ì „ : $u33_current_ver" >> $target
        echo "ìµœì‹  DNS(named) ì„œë¹„ìŠ¤ ë²„ì „ : $u33_latest_ver" >> $target
    else
        echo "í˜„ì¬ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” DNS(named) ì„œë¹„ìŠ¤ì˜ ë²„ì „ì´ ìµœì‹ ë²„ì „ê³¼ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        echo "í˜„ì¬ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” DNS(named) ì„œë¹„ìŠ¤ ë²„ì „ : $U33_cuu33_current_verrrent_ver" >> $target
        echo "ìµœì‹  DNS(named) ì„œë¹„ìŠ¤ ë²„ì „ : $u33_latest_ver" >> $target
        u33_safe_check=$((u33_safe_check+1))
    fi
fi

if [[ $u33_safe_check -ge 1 ]];then
    u33=$((u33+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u33 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u33_Service_Management=1
fi


cat << EOF
===== [U-34] DNS Area Transfer Settings              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-34 DNS Zone Transfer ì„¤ì •              " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : í—ˆê°€ë˜ì§€ ì•ŠëŠ” ì‚¬ìš©ìì—ê²Œ Zone Transferë¥¼ ì œí•œí•¨ìœ¼ë¡œì¨ í˜¸ìŠ¤íŠ¸ ì •ë³´, ì‹œìŠ¤í…œ ì •ë³´ ë“± ì •ë³´ ìœ ì¶œì˜ ë°©ì§€ë¥¼ ëª©ì ìœ¼ë¡œ í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : ë¹„ì¸ê°€ì Zone Transferë¥¼ ì´ìš©í•´ Zone ì •ë³´ë¥¼ ì „ì†¡ë°›ì•„ í˜¸ìŠ¤íŠ¸ ì •ë³´, ì‹œìŠ¤í…œ ì •ë³´, ë„¤íŠ¸ì›Œí¬ êµ¬ì„± í˜•íƒœ ë“±ì˜ ë§ì€ ì •ë³´ë¥¼ íŒŒì•…í•  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: DNS ì„œë¹„ìŠ¤ ë¯¸ì‚¬ìš© ë˜ëŠ”, Zone Transferë¥¼ í—ˆê°€ëœ ì‚¬ìš©ìì—ê²Œë§Œ í—ˆìš©í•œ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: DNS ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©° Zone Transferë¥¼ ëª¨ë“  ì‚¬ìš©ìì—ê²Œ í—ˆìš©í•œ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-34 ì ê²€ ê²°ê³¼" >> $result
u34=0
u34_Service_Management=0
u34_safe_check=0
u34_services=("named" "dnsmasq" "unbound" "pdns_server" "bind9.service" "pdns_server" "bind9" "dnsmasq.service" "unbound.service" "pdns.service")
u34_ports=("53" "853 " "443")

check_service_status "${u34_ports}" "${u34_services[@]}"
if [[ $? -eq 1 ]]; then
    echo "DNS ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
    if grep -vE "^\s*#" "/etc/bind/named.conf" | grep -qi "allow-transfer";then
        echo "íŠ¹ì • ipì— ëŒ€í•´ì„œ Zone Transferë¥¼ í—ˆìš©í•˜ë„ë¡ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
        echo "í˜„ì¬ Zone Transfer ì„¤ì • ê°’ :$(grep -vE "^\s#" "/etc/bind/named.conf" | grep -i "allow-transfer")" >> $target
    elif grep -vE "^\s*#" "/etc/bind/named.conf" | grep -qi "xfrnets";then
        echo "íŠ¹ì • ipì— ëŒ€í•´ì„œ Zone Transfer í—ˆìš©í•˜ë„ë¡ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
        echo "í˜„ì¬ Zone Transfer ì„¤ì • ê°’ :$(grep -vE "^\s#" "/etc/bind/named.conf" | grep -i "xfrnets")" >> $target
    else
        echo "allow-transfer ë° xfrnets ì˜µì…˜ì´ ì„¤ì •ë˜ì§€ ì•Šì•„ ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ê°€ Zone Transferë¥¼ ìš”ì²­í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤" >> $target
        u34_safe_check=$((u34_safe_check+1))
    fi
    u34_safe_check=$((u34_safe_check+1))
else
    echo "DNS ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    if grep -vE "^\s*#" "/etc/bind/named.conf" | grep -qi "allow-transfer";then
        echo "íŠ¹ì • ipì— ëŒ€í•´ì„œ Zone Transferë¥¼ í—ˆìš©í•˜ë„ë¡ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
        echo "í˜„ì¬ Zone Transfer ì„¤ì • ê°’ :$(grep -vE "^\s#" "/etc/bind/named.conf" | grep -i "allow-transfer")" >> $target
    elif grep -vE "^\s*#" "/etc/bind/named.conf" | grep -qi "xfrnets";then
        echo "íŠ¹ì • ipì— ëŒ€í•´ì„œ Zone Transfer í—ˆìš©í•˜ë„ë¡ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
        echo "í˜„ì¬ Zone Transfer ì„¤ì • ê°’ :$(grep -vE "^\s#" "/etc/bind/named.conf" | grep -i "xfrnets")" >> $target
    else
        echo "allow-transfer ë° xfrnets ì˜µì…˜ì´ ì„¤ì •ë˜ì§€ ì•Šì•„ ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ê°€ Zone Transferë¥¼ ìš”ì²­í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤" >> $target
        u34_safe_check=$((u34_safe_check+1))
    fi
fi

if [[ $u34_safe_check -ge 1 ]];then
    u34=$((u34+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u34 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u34_Service_Management=1
fi

cat << EOF
===== [U-35] Removing a Web Service Directory Listing              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-35 ì›¹ì„œë¹„ìŠ¤ ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ… ì œê±°              " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : ì™¸ë¶€ì—ì„œ ë””ë ‰í„°ë¦¬ ë‚´ì˜ ëª¨ë“  íŒŒì¼ì— ëŒ€í•œ ì ‘ê·¼ ë° ì—´ëŒì„ ì œí•œí•¨ì„ ëª©ì ìœ¼ë¡œ í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : ë””ë ‰í„°ë¦¬ ê²€ìƒ‰ ê¸°ëŠ¥ì´ í™œì„±í™” ë˜ì–´ ìˆì„ ê²½ìš°, ì‚¬ìš©ìì—ê²Œ ë””ë ‰í„°ë¦¬ë‚´ íŒŒì¼ì´ í‘œì‹œë˜ì–´ WEB ì„œë²„ êµ¬ì¡° ë…¸ì¶œë¿ë§Œ ì•„ë‹ˆë¼ ë°±ì—… íŒŒì¼ì´ë‚˜ ì†ŒìŠ¤íŒŒì¼, ê³µê°œë˜ì–´ì„œëŠ” ì•ˆë˜ëŠ” íŒŒì¼ ë“±ì´ ë…¸ì¶œ ê°€ëŠ¥í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ë””ë ‰í„°ë¦¬ ê²€ìƒ‰ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ë””ë ‰í„°ë¦¬ ê²€ìƒ‰ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-35 ì ê²€ ê²°ê³¼" >> $result
u35=0
u35_Service_Management=0
u35_safe_check=0
u35_apache_files=("/etc/apache2/conf-available/*.conf" "/etc/apache2/sites-available/*.conf" "/etc/apache2/sites-enabled/*.conf" "/etc/apache2/conf-enabled/*.conf" ".htaccess")
u35_nginx_files=("/etc/nginx/conf.d/*.conf" "/etc/nginx/sites-available/*.conf" "/etc/nginx/sites-enabled/*.conf")
u35_acount=0
u35_ncount=0
u35_apache_home_checks=("httpd.conf" "apache2.conf" ".htaccess")
u35_idx=0
u35_break=0
echo "â€»Ubuntu ê¸°ì¤€ Apache ë©”ì¸ ì„¤ì •íŒŒì¼ì¸ /etc/apache2/apache2.conf ê²½ë¡œì™€ Nginx ë©”ì¸ ì„¤ì • íŒŒì¼ì¸ /etc/nginx/nginx.confë¥¼ ì ê²€í•©ë‹ˆë‹¤. í•´ë‹¹ ê²½ë¡œê°€ ì¡´ì¬í•˜ì§€ ì•Šì„ ê²½ìš°, ì•„íŒŒì¹˜ ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ëª…ì„ í† ëŒ€ë¡œ íŒŒì¼ íƒìƒ‰ í›„ ì ê²€ì´ ì§„í–‰ë©ë‹ˆë‹¤. ì¤‘ë³µëœ íŒŒì¼ëª…ì´ ì¡´ì¬í•  ê²½ìš° ìˆ˜ë™ ì ê²€ì„ ê¶Œì¥í•©ë‹ˆë‹¤.â€»"  >> $target
for u35_apache_home_check in "${u35_apache_home_checks[@]}";do
    u35_apache_home=$(find / -type f -name "$u35_apache_home_check" 2> /dev/null | egrep -v "tmp|temp|swap|swp")
    if [ -f "$u35_apache_home" ];then
        echo "$u35_apache_home íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        u35_dir_lisconfs_a=($(grep -vE "^\s*#" "$u35_apache_home" | sed -n '/<Directory/,/<\/Directory>/p' | grep -i "^\s*options" | grep -i indexes | awk '{print $1}' ))
        u35_check_dirpath_a=($(grep -vE "^\s*#" "$u35_apache_home" | awk 'BEGIN { inBlock = 0; block = "" }/<Directory/ {block = $0;inBlock = 1;dirPath = $2; gsub("\"", "", dirPath)}/<\/Directory>/ {block = block "\n" $0;inBlock = 0;if (block ~ /Indexes/) { print dirPath }block = ""}inBlock && ! /<\/Directory>/ { block = block "\n" $0 }' | tr -d '>'))
        for u35_dir_lisconf_a in "${u35_dir_lisconfs_a[@]}";do
            if [ -n $u35_dir_lisconf_a ];then
                echo "ì›¹ ì„œë¹„ìŠ¤ ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ…ì´ í™œì„±í™” ìˆìŠµë‹ˆë‹¤." >> $target
                echo "ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ…ì´ í™œì„±í™”ëœ ë””ë ‰í† ë¦¬ ê²½ë¡œ : ${u35_check_dirpath_a[$u35_idx]}" >> $target
                u35_safe_check=$((u35_safe_check+1))
                u35_idx=$((u35_idx+1))
            else
                echo "ì›¹ ì„œë¹„ìŠ¤ ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ…ì´ ë¹„í™œì„±í™” ë˜ì–´ ìˆìŠµë‹ˆë‹¤" >> $target
                echo "ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ…ì´ ë¹„í™œì„±í™”ëœ ë””ë ‰í† ë¦¬ ê²½ë¡œ : ${u35_check_dirpath_a[$u35_idx]}" >> $target
                u35_idxn=$((u35_idxn+1))
            fi
        done
        break
    else
        u35_idx=0
        if [[ $u35_break -eq 1 ]];then
            break
        fi
        u35_break=$((u35_break+1))
        echo "Apache ë©”ì¸ ì„¤ì • íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©°, ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ëª…ì„ í† ëŒ€ë¡œ ì ê²€ì„ ì§„í–‰í•©ë‹ˆë‹¤." >> $target
        for u35_apache_file in "${u35_apache_files[@]}";do
            for u35_apache_check in $u35_apache_file;do
                if [ -f "$u35_apache_check" ];then
                    u35_adected_filecks=$(grep -vE "^\s*#" "$u35_apache_check"  | grep -iw "options" | grep -iw "indexes" | grep -iwv "\-indexes" )
                    for u35_adected_fileck in "${u35_adected_filecks[@]}";do
                        if [[ -n "$u35_adected_fileck" ]];then
                            echo "$u35_apache_check íŒŒì¼ì—ì„œ ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ…ì„ í—ˆìš©í•˜ëŠ” indexes ì„¤ì •ê°’ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
                            echo "ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ…ì´ í™œì„±í™”ëœ ë””ë ‰í† ë¦¬ ê²½ë¡œ : ${u35_check_dirpath_a[$u35_idx]}" >> $target
                            u35_safe_check=$((u35_safe_check+1))
                            u35_idx=$((u35_idx+1))
                        else
                            echo "$u35_apache_check íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ë§Œ ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ…ì„ í—ˆìš©í•˜ëŠ” indexes ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                            u35_idxn=$((u35_idxn+1))
                        fi
                    done
                fi
            done
        done
        echo "ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ë“¤ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¶”ê°€ì ì¸ ìˆ˜ë™ ì ê²€ì„ ê¶Œì¥í•©ë‹ˆë‹¤." >> $target
        u35_idx=0
    fi
done
if [ -f "/etc/nginx/nginx.conf" ];then
    echo "/etc/nginx/nginx.conf íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
    u35_dir_lisconf=$(grep -vE "^\s*#" "/etc/nginx/nginx.conf" | sed -n '/server {/,/}/p' | grep -i "^\s*autoindex" | awk '{print tolower($2)}' | tr -d ';')
    if [[ $u35_dir_lisconf == "on" ]];then
        echo "ì›¹ ì„œë¹„ìŠ¤ ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ…ì´ í™œì„±í™” ìˆìŠµë‹ˆë‹¤." >> $target
        echo "ì„¤ì • ê°’ : $u35_dir_lisconf" >> $target
        u35_safe_check=$((u35_safe_check+1))
    else
        echo "ì›¹ ì„œë¹„ìŠ¤ ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ…ì´ ë¹„í™œì„±í™” ë˜ì–´ ìˆìŠµë‹ˆë‹¤" >> $target
    fi
else 
    echo "/etc/nginx/nginx.conf íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©°, ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ëª…ì„ í† ëŒ€ë¡œ ì ê²€ì„ ì§„í–‰í•©ë‹ˆë‹¤." >> $target
    for u35_ngnix_file in ${u35_nginx_files[@]};do
        for u35_nginx_check in $u35_ngnix_file;do
            if [ -f "$u35_nginx_check" ];then
                u35_ncount=$((u35_ncount+1))
                u35_ndected_fileck=$(grep -vE "^\s*#" "$u35_nginx_check" 2> /dev/null| grep -iw "autoindex" | grep -iw "on")
                if [ -n "$u35_ndected_fileck" ];then
                    echo "$u35_nginx_check íŒŒì¼ì—ì„œ ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ…ì„ í—ˆìš©í•˜ëŠ” autoindex ì„¤ì •ê°’ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
                    echo "ì„¤ì • ê°’ : $u35_ndected_fileck" >> $target
                    u35_safe_check=$((u35_safe_check+1))
                else
                    echo "$u35_nginx_check íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ë§Œ ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ…ì„ í—ˆìš©í•˜ëŠ” autoindex ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                fi
            fi
        done
    done
    if [ $u35_ncount -eq 0 ];then
        echo "ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ë“¤ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¶”ê°€ì ì¸ ìˆ˜ë™ ì ê²€ì„ ê¶Œì¥í•©ë‹ˆë‹¤." >> $target
    fi
fi

if [[ $u35_safe_check -ge 1 ]];then
    u35=$((u35+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u35 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u35_Service_Management=1
fi

cat << EOF
===== [U-36] Restrict Web Services Web Process Permissions              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-36 ì›¹ì„œë¹„ìŠ¤ ì›¹ í”„ë¡œì„¸ìŠ¤ ê¶Œí•œ ì œí•œ              " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : Apache ë°ëª¬ì„ root ê¶Œí•œìœ¼ë¡œ êµ¬ë™í•˜ì§€ ì•Šê³  ë³„ë„ì˜ ê¶Œí•œìœ¼ë¡œ êµ¬ë™í•¨ìœ¼ë¡œì¨ ì¹¨í•´ì‚¬ê³  ë°œìƒ ì‹œ í”¼í•´ë²”ìœ„ í™•ì‚° ë°©ì§€ë¥¼ ëª©ì ìœ¼ë¡œ í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : ì›¹ì„œë¹„ìŠ¤ ë°ëª¬ì„ root ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰ì‹œ ì›¹ì„œë¹„ìŠ¤ê°€ íŒŒì¼ì„ ìƒì„±, ìˆ˜ì •í•˜ëŠ” ê³¼ì •ì—ì„œ ì›¹ì„œë¹„ìŠ¤ì— í•´ë‹¹í•˜ì§€ ì•ŠëŠ” íŒŒì¼ë„ root ê¶Œí•œì— ì˜í•´ ì“°ê¸°ê°€ ê°€ëŠ¥í•˜ë©° í•´í‚¹ ë°œìƒì‹œ root ê¶Œí•œì´ ë…¸ì¶œ ë  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: Apache ë°ëª¬ì´ root ê¶Œí•œìœ¼ë¡œ êµ¬ë™ë˜ì§€ ì•ŠëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: Apache ë°ëª¬ì´ root ê¶Œí•œìœ¼ë¡œ êµ¬ë™ë˜ëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-36 ì ê²€ ê²°ê³¼" >> $result
u36_safe_check=0
u36_Service_Management=0
u36=0
u36_break=0
u36_apache_files=("/etc/apache2/conf-available/*.conf" "/etc/apache2/sites-available/*.conf" "/etc/apache2/sites-enabled/*.conf")
u36_nginx_files=("/etc/nginx/conf.d/*.conf" "/etc/nginx/sites-available/*.conf" "/etc/nginx/sites-enabled/*.conf")
u36_apache_home_checks=("httpd.conf" "apache2.conf" ".htaccess")
echo "â€»Cent OS 7 ê¸°ì¤€ Apache ë©”ì¸ ì„¤ì •íŒŒì¼ ê²½ë¡œì™€ Nginx ë©”ì¸ ì„¤ì • íŒŒì¼ì¸ /etc/nginx/nginx.confë¥¼ ì ê²€í•©ë‹ˆë‹¤. í•´ë‹¹ ê²½ë¡œê°€ ì¡´ì¬í•˜ì§€ ì•Šì„ ê²½ìš°, ì•„íŒŒì¹˜ ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ëª…ì„ í† ëŒ€ë¡œ íŒŒì¼ íƒìƒ‰ í›„ ì ê²€ì´ ì§„í–‰ë©ë‹ˆë‹¤. ì¤‘ë³µëœ íŒŒì¼ëª…ì´ ì¡´ì¬í•  ê²½ìš° ìˆ˜ë™ ì ê²€ì„ ê¶Œì¥í•©ë‹ˆë‹¤.â€»"  >> $target
for u36_apache_home_check in "${u36_apache_home_checks[@]}";do
    u36_apache_home=$(find / -type f -name "$u36_apache_home_check" 2> /dev/null | egrep -v "tmp|temp|swap|swp")
    if [ -f "$u36_apache_home" ];then
        echo "$u36_apache_home íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        u36_apache_user=$(grep -vE "^\s*#" "$u36_apache_home" | grep -wiE "^\s*user" | awk '{print tolower($2)}')
        u36_apache_group=$(grep -vE "^\s*#" "$u36_apache_home" | grep -wiE "^\s*group" | awk '{print tolower($2)}')
        if [ -n "$u36_apache_user" ] || [ -n "$u36_apache_group" ];then
            if [ "$u36_apache_user" == "www-data" ] || [ "$u36_apache_user" == "apache" ];then
                echo "Apache ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ User ê¶Œí•œì´ www-data í˜¹ì€ apacheë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                if [ "$u36_apache_group" == "www-data" ] || [ "$u36_apache_group" == "apache" ];then
                    echo "Apache ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ www-data í˜¹ì€ apacheë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                else
                    if [ "$u36_apache_group" == "root" ];then
                        echo "Apache ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ root ê³„ì •ìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        u35_safe_check=$((u35_safe_check+1))
                    else
                        echo "Apache ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ ì—†ê±°ë‚˜ root ë¥¼ ì œì™¸í•œ ë³„ë„ì˜ ê³„ì •ìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    fi
                fi
            else
                if [[ "$u36_apache_user" == "root" ]];then
                    echo "Apache ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ User ê¶Œí•œì´ root ê³„ì •ìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    u35_safe_check=$((u35_safe_check+1))
                else
                    echo "Apache ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ User ê¶Œí•œì´ ì—†ê±°ë‚˜ root ë¥¼ ì œì™¸í•œ ë³„ë„ì˜ ê³„ì •ìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    if [ "$u36_apache_group" == "www-data" ] || [ "$u36_apache_group" == "apache" ];then
                        echo "Apache ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ wwww-data í˜¹ì€ apacheë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    else
                        if [ "$u36_apache_group" == "root" ];then
                            echo "Apache ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ root ê³„ì •ìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        else
                            echo "Apache ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ ì—†ê±°ë‚˜ root ë¥¼ ì œì™¸í•œ ë³„ë„ì˜ ê³„ì •ìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        fi
                    fi
                fi
            fi
        else
            echo "$u36_apache_home íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ë§Œ, User ë° Group ì„¤ì • ì˜µì…˜ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        fi
    else 
        if [ $u36_break -eq 1 ];then
            break
        fi
        u36_break=$((u35_break+1))
        for u36_apache_file in "${u36_apache_files[@]}";do
            for u36_apache_check in $u36_apache_file;do
                if [ -f "$u36_apache_check" ];then
                    echo "$u36_apache_check íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
                    u36_apache_user=$(grep -vE "^\s*#" "$u36_apache_check" | grep -wiE "^\s*user" | awk '{print tolower($2)}')
                    u36_apache_group=$(grep -vE "^\s*#" "$u36_apache_check" | grep -wiE "^\s*group" | awk '{print tolower($2)}')
                    if [ -n "$u36_apache_user" ] || [ -n "$u36_apache_group" ];then
                        if [ "$u36_apache_user" == "www-data" ] || [ "$u36_apache_user" == "apache" ];then
                            echo "$u36_apache_check ì„¤ì •íŒŒì¼ì˜ User ê¶Œí•œì´ www-data í˜¹ì€ apacheë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            if [ "$u36_apache_group" == "www-data" ] || [ "$u36_apache_group" == "apache" ];then
                                echo "$u36_apache_check ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ www-data í˜¹ì€ apacheë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            else
                                if [ "$u36_apache_group" == "root" ];then
                                    echo "$u36_apache_check ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ root ê³„ì •ìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                                    u35_safe_check=$((u35_safe_check+1))
                                else
                                    echo "$u36_apache_check ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ ì—†ê±°ë‚˜ root ë¥¼ ì œì™¸í•œ ë³„ë„ì˜ ê³„ì •ìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                                fi
                            fi
                        else
                            if [[ "$u36_apache_user" == "root" ]];then
                                echo "$u36_apache_check ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ root ê³„ì •ìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                                u35_safe_check=$((u35_safe_check+1))
                            else
                                echo "$u36_apache_check ì„¤ì •íŒŒì¼ì˜ User ê¶Œí•œì´ ì—†ê±°ë‚˜ root ë¥¼ ì œì™¸í•œ ë³„ë„ì˜ ê³„ì •ìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                                if [ "$u36_apache_group" == "www-data" ] || [ "$u36_apache_group" == "apache" ];then
                                    echo "$u36_apache_check ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ wwww-data í˜¹ì€ apacheë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                                else
                                    if [ "$u36_apache_group" == "root" ];then
                                        echo "$u36_apache_check ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ root ê³„ì •ìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                                        u35_safe_check=$((u35_safe_check+1))
                                    else
                                        echo "$u36_apache_check ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ ì—†ê±°ë‚˜ root ë¥¼ ì œì™¸í•œ ë³„ë„ì˜ ê³„ì •ìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                                    fi
                                fi
                            fi
                        fi
                    else
                        echo "$u36_apache_check íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ë§Œ, User ë° Group ì„¤ì • ì˜µì…˜ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    fi
                fi
            done
        done
        echo "ì¶”ê°€ì ì¸ ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ë“¤ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¶”ê°€ì ì¸ ìˆ˜ë™ ì ê²€ì„ ê¶Œì¥í•©ë‹ˆë‹¤." >> $target
    fi
done

if [ -f "/etc/nginx/nginx.conf" ];then
    echo "/etc/nginx/nginx.conf íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
    u36_nginx_user=$(grep -vE "^\s*#" "/etc/nginx/nginx.conf" | grep -wiE "^\s*user" | awk '{print tolower($2)}')
    u36_nginx_group=$(grep -vE "^\s*#" "/etc/nginx/nginx.conf" | grep -wiE "^\s*user" | awk '{print tolower($3)}')
    if [ -n "$u36_nginx_user" ] || [ -n "$u36_nginx_group" ];then
        if [ "$u36_nginx_user" == "www-data" ] || [ "$u36_nginx_user" == "nginx" ];then
            echo "Nginx ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ User ê¶Œí•œì´ www-data í˜¹ì€ nginxë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            if [ "$u36_nginx_group" == "www-data" ] || [ "$u36_nginx_group" == "nginx" ];then
                echo "Nginx ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ www-data í˜¹ì€ nginxë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            else
                if [[ "$u36_nginx_group" == "root" ]];then
                    echo "Nginx ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ root ê³„ì •ìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    u35_safe_check=$((u35_safe_check+1))
                else
                    echo "Nginx ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ ì—†ê±°ë‚˜ root ë¥¼ ì œì™¸í•œ ë³„ë„ì˜ ê³„ì •ìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                fi
            fi
        else
            if [[ "$u36_nginx_user" == "root" ]];then
                echo "Nginx ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ root ê³„ì •ìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                u35_safe_check=$((u35_safe_check+1))
            else
                echo "Nginx ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ User ê¶Œí•œì´ ì—†ê±°ë‚˜ root ë¥¼ ì œì™¸í•œ ë³„ë„ì˜ ê³„ì •ìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                if [ "$u36_nginx_group" == "www-data" ] || [ "$u36_nginx_group" == "nginx" ];then
                    echo "Nginx ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ wwww-data í˜¹ì€ apacheë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                else
                    if [ "$u36_nginx_group" == "root" ];then
                        echo "Nginx ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ root ê³„ì •ìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        u35_safe_check=$((u35_safe_check+1))
                    else
                        echo "Nginx ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ ì—†ê±°ë‚˜ root ë¥¼ ì œì™¸í•œ ë³„ë„ì˜ ê³„ì •ìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    fi
                fi
            fi
        fi
    else
        echo "/etc/nginx/nginx.conf íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ë§Œ, User ë° Group ì„¤ì • ì˜µì…˜ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
else 
    echo "/etc/nginx/nginx.conf íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©°, ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ëª…ì„ í† ëŒ€ë¡œ ì ê²€ì„ ì§„í–‰í•©ë‹ˆë‹¤." >> $target
    for u36_ngnix_file in "${u36_nginx_files[@]}";do
        for u36_nginx_check in $u36_ngnix_file;do
            if [ -f "$u36_nginx_check" ];then
                echo "$u36_nginx_check íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
                u36_nginx_user=$(grep -vE "^\s*#" "$u36_nginx_check" | grep -wiE "^\s*user" | awk '{print $2}')
                u36_nginx_group=$(grep -vE "^\s*#" "$u36_nginx_check" | grep -wiE "^\s*user" | awk '{print $3}')
                if [ -n "$u36_nginx_user" ] || [ -n "$u36_nginx_group" ];then
                    if [ "$u36_nginx_user" == "www-data" ] || [ "$u36_nginx_user" == "nginx" ];then
                        echo "Nginx ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ User ê¶Œí•œì´ www-data í˜¹ì€ nginxë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        if [ "$u36_nginx_group" == "www-data" ] || [ "$u36_nginx_group" == "nginx" ];then
                            echo "Nginx ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ www-data í˜¹ì€ nginxë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        else
                            if [[ "$u36_nginx_group" == "root" ]];then
                                echo "Nginx ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ root ê³„ì •ìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                                u35_safe_check=$((u35_safe_check+1))
                            else
                                echo "Nginx ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ ì—†ê±°ë‚˜ root ë¥¼ ì œì™¸í•œ ë³„ë„ì˜ ê³„ì •ìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            fi
                        fi
                    else
                        if [[ "$u36_nginx_user" == "root" ]];then
                            echo "Nginx ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ root ê³„ì •ìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            u35_safe_check=$((u35_safe_check+1))
                        else
                            echo "Nginx ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ User ê¶Œí•œì´ ì—†ê±°ë‚˜ root ë¥¼ ì œì™¸í•œ ë³„ë„ì˜ ê³„ì •ìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            if [ "$u36_nginx_group" == "www-data" ] || [ "$u36_nginx_group" == "nginx" ];then
                                echo "Nginx ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ wwww-data í˜¹ì€ apacheë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            else
                                if [ "$u36_nginx_group" == "root" ];then
                                    echo "Nginx ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ root ê³„ì •ìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                                    u35_safe_check=$((u35_safe_check+1))
                                else
                                    echo "Nginx ì›¹ ì„œë¹„ìŠ¤ ì„¤ì •íŒŒì¼ì˜ Group ê¶Œí•œì´ ì—†ê±°ë‚˜ root ë¥¼ ì œì™¸í•œ ë³„ë„ì˜ ê³„ì •ìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                                fi
                            fi
                        fi
                    fi
                else
                    echo "$u36_nginx_check íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ë§Œ, User ë° Group ì„¤ì • ì˜µì…˜ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                fi
            fi
        done
    done
    echo "ì¶”ê°€ì ì¸ ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ë“¤ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¶”ê°€ì ì¸ ìˆ˜ë™ ì ê²€ì„ ê¶Œì¥í•©ë‹ˆë‹¤." >> $target
fi

if [[ $u36_safe_check -ge 1 ]];then
    u36=$((u36+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u36 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u36_Service_Management=1
fi

cat << EOF
===== [U-37] Do not access the web service parent directory              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-37 ì›¹ì„œë¹„ìŠ¤ ìƒìœ„ ë””ë ‰í† ë¦¬ ì ‘ê·¼ ê¸ˆì§€              " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : ìƒìœ„ ê²½ë¡œ ì´ë™ ëª…ë ¹ìœ¼ë¡œ ë¹„ì¸ê°€ìì˜ íŠ¹ì • ë””ë ‰í„°ë¦¬ì— ëŒ€í•œ ì ‘ê·¼ ë° ì—´ëŒì„ ì œí•œí•˜ì—¬ ì¤‘ìš” íŒŒì¼ ë° ë°ì´í„° ë³´í˜¸ë¥¼ ëª©ì ìœ¼ë¡œ í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : ìƒìœ„ ê²½ë¡œë¡œ ì´ë™í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•  ê²½ìš° ì ‘ê·¼í•˜ê³ ì í•˜ëŠ” ë””ë ‰í„°ë¦¬ì˜ í•˜ìœ„ ê²½ë¡œì— ì ‘ì†í•˜ì—¬ ìƒìœ„ê²½ë¡œë¡œ ì´ë™í•¨ìœ¼ë¡œì¨ ì•…ì˜ì ì¸ ëª©ì ì„ ê°€ì§„ ì‚¬ìš©ìì˜ ì ‘ê·¼ì´ ê°€ëŠ¥í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ìƒìœ„ ë””ë ‰í„°ë¦¬ì— ì´ë™ì œí•œì„ ì„¤ì •í•œ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ìƒìœ„ ë””ë ‰í„°ë¦¬ì— ì´ë™ì œí•œì„ ì„¤ì •í•˜ì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-37 ì ê²€ ê²°ê³¼" >> $result
u37=0
u37_safe_check=0
u37_Service_Management=0
u37_apache_files=("/etc/apache2/conf-available/*.conf" "/etc/apache2/sites-available/*.conf" "/etc/apache2/sites-enabled/*.conf")
u37_nginx_files=("/etc/nginx/conf.d/*.conf" "/etc/nginx/sites-available/*.conf" "/etc/nginx/sites-enabled/*.conf")
u37_idx=0
u37_apache_home_checks=("httpd.conf" "apache2.conf" ".htaccess")
u37_break=0
echo "â€»Cent OS 7 ê¸°ì¤€ Apache ë©”ì¸ ì„¤ì •íŒŒì¼ ê²½ë¡œì™€ Nginx ë©”ì¸ ì„¤ì • íŒŒì¼ì¸ /etc/nginx/nginx.confë¥¼ ì ê²€í•©ë‹ˆë‹¤. í•´ë‹¹ ê²½ë¡œê°€ ì¡´ì¬í•˜ì§€ ì•Šì„ ê²½ìš°, ì•„íŒŒì¹˜ ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ëª…ì„ í† ëŒ€ë¡œ íŒŒì¼ íƒìƒ‰ í›„ ì ê²€ì´ ì§„í–‰ë©ë‹ˆë‹¤. ì¤‘ë³µëœ íŒŒì¼ëª…ì´ ì¡´ì¬í•  ê²½ìš° ìˆ˜ë™ ì ê²€ì„ ê¶Œì¥í•©ë‹ˆë‹¤.â€»"  >> $target
echo "apache, nginx ì˜ ì£¼ìš” ì„¤ì •íŒŒì¼ì„ í† ëŒ€ë¡œ apache í™ˆ ë””ë ‰í„°ë¦¬ ì ê²€ í›„ ì¶”ê°€ ì„¤ì • íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ë¥¼ ì ê²€í•˜ë¯€ë¡œ, ì¤‘ë³µëœ ê²°ê³¼ê°€ ì¡´ì¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤." >> $target
for u37_apache_home_check in "${u37_apache_home_checks[@]}";do
    u37_apache_home=$(find / -type f -name "$u37_apache_home_check" 2> /dev/null | egrep -v "tmp|temp|swap|swp")
    if [ -f "$u37_apache_home" ];then
        echo "$u37_apache_home íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        u37_dir_pathconfs_a=($(grep -vE "^\s*#" "$u37_apache_home" | sed -n '/<Directory/,/<\/Directory>/p' | grep -i "^\s*AllowOverride" | awk '{print tolower($2)}'))
        u37_check_dirpath_a=($(grep -vE "^\s*#" "$u37_apache_home" | awk 'BEGIN { inBlock = 0; block = "" }/<Directory/ {block = $0;inBlock = 1;dirPath = $2; gsub("\"", "", dirPath)}/<\/Directory>/ {block = block "\n" $0;inBlock = 0;if (block ~ /AllowOverride/) { print dirPath }block = ""}inBlock && ! /<\/Directory>/ { block = block "\n" $0 }' | tr -d '>'))
        for u37_dir_pathconf_a in "${u37_dir_pathconfs_a[@]}";do
            if [ -n "$u37_dir_pathconf_a" ];then
                if [[ "$u37_dir_pathconf_a" == "none" ]];then
                    echo "AllowOverride ì§€ì‹œìì˜ ì˜µì…˜ì´ $u37_dir_pathconf_a ë¡œ ì„¤ì •ë˜ì–´ ìƒìœ„ ë””ë ‰í† ë¦¬ë¡œì˜ ì ‘ê·¼ì„ í—ˆìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
                    #u37_result=$(grep -vE "^\s*#" "/etc/httpd/conf/httpd.conf" | awk 'BEGIN { IGNORECASE = 1 }/<Directory/ { block = $0; inBlock = 1 }/<\/Directory>/ { block = block "\n" $0; inBlock = 0; if (block ~ /AllowOverride\s+all/) { print block; block="" } }inBlock && !/<\/Directory>/ { block = block "\n" $0 }' | sed '1d')
                    #echo "$u37_result"
                    echo "$u37_dir_pathconf_a ë¡œ ì„¤ì •ëœ ê²½ë¡œ : ${u37_check_dirpath_a[$u37_idx]}"   >> $target
                    u37_safe_check=$((u37_safe_check+1))
                    u37_idx=$((u37_idx+1))
                elif [ "$u37_dir_pathconf_a" == "authconfig" ] || [ "$u37_dir_pathconf_a" == "all" ];then
                    echo "AllowOverride ì§€ì‹œìì˜ ì˜µì…˜ì´ $u37_dir_pathconf_a ë¡œ ì„¤ì •ë˜ì–´ ìƒìœ„ ë””ë ‰í† ë¦¬ë¡œì˜ ì ‘ê·¼ì„ ê±°ë¶€í•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
                    echo "$u37_dir_pathconf_a ë¡œ ì„¤ì •ëœ ê²½ë¡œ : ${u37_check_dirpath_a[$u37_idx]}" >> $target
                    u37_idx=$((u37_idx+1))
                else
                    echo "AllowOverride ì§€ì‹œìì˜ ì˜µì…˜ì´ $u37_dir_pathconf_a ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ê´€ë¦¬ìì™€ì˜ ìƒì˜ë°”ëë‹ˆë‹¤." >> $target
                fi
            else
                echo "$u37_apache_home íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ë§Œ, ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
            fi
        done
        break
    else 
        u37_idx=0
        if [ $u37_break -eq 1 ];then
            continue
        fi
        u37_break=$((u37_break+1))
        echo "$u37_apache_home_check íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©°, ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ëª…ì„ í† ëŒ€ë¡œ ì ê²€ì„ ì§„í–‰í•©ë‹ˆë‹¤." >> $target
        for u37_apache_file in "${u37_apache_files[@]}";do
            for u37_apache_check in $u37_apache_file;do
                if [ -f "$u37_apache_check" ];then
                    echo "$u37_apache_check íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
                    u37_dir_pathconfs=($(grep -vE "^\s*#" "$u37_apache_check" | sed -n '/<Directory/,/<\/Directory>/p' | grep -i "^\s*AllowOverride" | awk '{print tolower($2)}'))
                    u37_check_dirpath=($(grep -vE "^\s*#" "$u37_apache_check" | awk 'BEGIN { inBlock = 0; block = "" }/<Directory/ {block = $0;inBlock = 1;dirPath = $2; gsub("\"", "", dirPath)}/<\/Directory>/ {block = block "\n" $0;inBlock = 0;if (block ~ /AllowOverride/) { print dirPath }block = ""}inBlock && ! /<\/Directory>/ { block = block "\n" $0 }' | tr -d '>'))
                    if [ ${#u37_dir_pathconfs[@]} -gt 0 ];then
                        for u37_dir_pathconf in "${u37_dir_pathconfs[@]}";do
                            if [[ "$u37_dir_pathconf" == "none" ]];then
                                echo "$u37_apache_check íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ë§Œ, AllowOverride ì§€ì‹œìì˜ ì˜µì…˜ì´ $u37_dir_pathconf ë¡œ ì„¤ì •ë˜ì–´ ìƒìœ„ ë””ë ‰í† ë¦¬ë¡œì˜ ì ‘ê·¼ì„ í—ˆìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
                                #u37_result=$(grep -vE "^\s*#" "$u37_apache_check" | awk 'BEGIN { IGNORECASE = 1 }/<Directory/ { block = $0; inBlock = 1 }/<\/Directory>/ { block = block "\n" $0; inBlock = 0; if (block ~ /AllowOverride\s+all/) { print block; block="" } }inBlock && !/<\/Directory>/ { block = block "\n" $0 }' | sed '1d')
                                #echo "$u37_result"
                                echo "$u37_dir_pathconf ë¡œ ì„¤ì •ëœ ê²½ë¡œ : ${u37_check_dirpath[$u37_idx]}"   >> $target
                                u37_safe_check=$((u37_safe_check+1))
                                u37_idx=$((u37_idx+1))
                            elif [ "$u37_dir_pathconf" == "authconfig" ] || [ "$u37_dir_pathconf" == "all" ];then
                                echo "AllowOverride ì§€ì‹œìì˜ ì˜µì…˜ì´ $u37_dir_pathconf ë¡œ ì„¤ì •ë˜ì–´ ìƒìœ„ ë””ë ‰í† ë¦¬ë¡œì˜ ì ‘ê·¼ì„ ê±°ë¶€í•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
                                #u37_result=$(grep -vE "^\s*#" "$u37_apache_check" | awk 'BEGIN { IGNORECASE = 1 }/<Directory/ { block = $0; inBlock = 1 }/<\/Directory>/ { block = block "\n" $0; inBlock = 0; if (block ~ /AllowOverride\s+all/) { print block; block="" } }inBlock && !/<\/Directory>/ { block = block "\n" $0 }' | sed '1d')
                                #echo "$u37_result"
                                echo "$u37_dir_pathconf ë¡œ ì„¤ì •ëœ ê²½ë¡œ : ${u37_check_dirpath[$u37_idx]}" >> $target
                                u37_idx=$((u37_idx+1))
                            else
                                echo "$u37_apache_check íŒŒì¼ì´ ì¡´ì¬í•˜ë©°, AllowOverride ì§€ì‹œìì˜ ì˜µì…˜ì´ $u37_dir_pathconf ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ê´€ë¦¬ìì™€ì˜ ìƒì˜ë°”ëë‹ˆë‹¤." >> $target
                            fi
                        done
                    else
                        echo "$u37_apache_check íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ë§Œ, ê´€ë ¨ ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    fi
                fi
            done
        done
        echo "ì¶”ê°€ì ì¸ ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ë“¤ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¶”ê°€ì ì¸ ìˆ˜ë™ ì ê²€ì„ ê¶Œì¥í•©ë‹ˆë‹¤." >> $target
        u37_idx=0
    fi
done
u37_idx=0
if [ -f "/etc/nginx/nginx.conf" ];then
    echo "/etc/nginx/nginx.conf íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
    u37_dir_pathconfs_n=($(cat /etc/nginx/nginx.conf | sed -n '/location ~\* \/\\.\\. /,/}/p' | grep -i 'deny' | awk '{print $2}' | tr -d ';'))
    if [ -n "$u37_dir_pathconfs_n" ];then
        for u37_dir_pathconf_n in "${u37_dir_pathconfs_n[@]}";do
            if [[ "$u37_dir_pathconf_n" == "all" ]];then 
                echo "/etc/nginx/nginx.conf íŒŒì¼ì—ì„œ ìƒìœ„ ë””ë ‰í† ë¦¬ë¡œì˜ ì ‘ê·¼ ì œí•œ ì„¤ì • deny ê°’ì´ allë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                u37_idx=$((u37_idx+1))
            else
                echo "/etc/nginx/nginx.conf íŒŒì¼ì—ì„œ ìƒìœ„ ë””ë ‰í† ë¦¬ë¡œì˜ ì ‘ê·¼ ì œí•œ ì„¤ì • deny ê°’ì´ allë¡œ ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                u37_safe_check=$((u37_safe_check+1))
            fi
        done
        if [[ $u37_idx -ge 1 ]];then
            echo "/etc/nginx/nginx.conf íŒŒì¼ì—ì„œ ìƒìœ„ ë””ë ‰í† ë¦¬ë¡œì˜ ì´ë™ì´ í—ˆìš©ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            echo "ì„¤ì • ê°’ : $u37_dir_pathconf_n" >> $target
            echo "ì´ $u37_idx ê°œì˜ ì·¨ì•½í•œ all ì„¤ì •ì´ ì¡´ì¬í•©ë‹ˆë‹¤. /etc/nginx/nginx.conf íŒŒì¼ì„ í™•ì¸í•˜ì‹­ì‹œì˜¤." >> $target
        else
            echo "/etc/nginx/nginx.conf íŒŒì¼ì—ì„œ ìƒìœ„ ë””ë ‰í† ë¦¬ë¡œì˜ ì´ë™ì´ í—ˆìš©ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        fi
    else
        echo "/etc/nginx/nginx.conf íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ë§Œ, ìƒìœ„ ë””ë ‰í† ë¦¬ì˜ ì ‘ê·¼ì„ ì œí•œí•˜ëŠ” ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
else 
    echo "/etc/nginx/nginx.conf íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©°, ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ëª…ì„ í† ëŒ€ë¡œ ì ê²€ì„ ì§„í–‰í•©ë‹ˆë‹¤." >> $target
    for u37_ngnix_file in "${u37_nginx_files[@]}";do
        for u37_nginx_check in $u37_ngnix_file;do 
            if [ -f "$u37_nginx_check" ];then
                echo "$u37_nginx_check íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
                u37_dir_pathconfs_n=($(cat "$u37_nginx_check" | sed -n '/location ~\* \/\\.\\. /,/}/p' | grep -i 'deny' | awk '{print $2}' | tr -d ';'))
                if [ ${#u37_dir_pathconfs_n[@]} -gt 0];then
                    for u37_dir_pathconf_n in "${u37_dir_pathconfs_n[@]}";do
                        if [[ "$u37_dir_pathconf_n" == "all" ]];then
                            echo "/etc/nginx/nginx.conf íŒŒì¼ì—ì„œ ìƒìœ„ ë””ë ‰í† ë¦¬ë¡œì˜ ì ‘ê·¼ ì œí•œ ì„¤ì • deny ê°’ì´ allë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            u37_idx=$((u37_idx+1))
                        else
                            echo "$u37_nginx_check íŒŒì¼ì€ ì¡´ì¬í•˜ë‚˜, ìƒìœ„ ë””ë ‰í† ë¦¬ë¡œì˜ ì´ë™ì´ ì œí•œ ì„¤ì •ê°’ì´ deny allë¡œ ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                            u37_safe_check=$((u37_safe_check+1))
                        fi
                    done
                else
                    echo echo "$u37_nginx_check íŒŒì¼ì€ ì¡´ì¬í•˜ë‚˜, ìƒìœ„ ë””ë ‰í† ë¦¬ë¡œì˜ ì´ë™ì´ ì œí•œ ì„¤ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                fi
                if [[ $u37_idx -ge 1 ]];then
                    echo "$u37_nginx_check íŒŒì¼ì—ì„œ ìƒìœ„ ë””ë ‰í† ë¦¬ë¡œì˜ ì´ë™ì´ í—ˆìš©ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    echo "ì„¤ì • ê°’ : $u37_dir_pathconf_n" >> $target
                    echo "ì´ $u37_idx ê°œì˜ ì·¨ì•½í•œ all ì„¤ì •ì´ ì¡´ì¬í•©ë‹ˆë‹¤. $u37_nginx_check íŒŒì¼ì„ í™•ì¸í•˜ì‹­ì‹œì˜¤." >> $target
                fi
            fi
        done
    done
    echo "ì¶”ê°€ì ì¸ ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ë“¤ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¶”ê°€ì ì¸ ìˆ˜ë™ ì ê²€ì„ ê¶Œì¥í•©ë‹ˆë‹¤." >> $target
fi

if [[ $u37_safe_check -ge 1 ]];then
    u37=$((u37+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u37 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u37_Service_Management=1
fi

cat << EOF
===== [U-38] Remove unnecessary Web Services files              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-38 ì›¹ì„œë¹„ìŠ¤ ë¶ˆí•„ìš”í•œ íŒŒì¼ ì œê±°              " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : Apache ì„¤ì¹˜ ì‹œ ë””í´íŠ¸ë¡œ ì„¤ì¹˜ë˜ëŠ” ë¶ˆí•„ìš”í•œ íŒŒì¼ì„ ì œê±°í•¨ì„ ëª©ì ìœ¼ë¡œ í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : Apache ì„¤ì¹˜ ì‹œ htdocs ë””ë ‰í„°ë¦¬ ë‚´ì— ë§¤ë‰´ì–¼ íŒŒì¼ì€ ì‹œìŠ¤í…œ ê´€ë ¨ì •ë³´ë¥¼ ë…¸ì¶œí•˜ê±°ë‚˜ í•´í‚¹ì— ì•…ìš©ë  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ê¸°ë³¸ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ë¶ˆí•„ìš”í•œ íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ê°€ ì œê±°ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ê¸°ë³¸ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ë¶ˆí•„ìš”í•œ íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ê°€ ì œê±°ë˜ì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-38 ì ê²€ ê²°ê³¼" >> $result
u38=0
u38_safe_check=0
u38_Service_Management=0
echo "Apache ë° Nginx ì— ëŒ€í•´ ì„¤ì¹˜ ì‹œ ë””í´íŠ¸ë¡œ ì„¤ì¹˜ë˜ëŠ” ë¶ˆí•„ìš”í•œ íŒŒì¼ì„ íƒìƒ‰í•©ë‹ˆë‹¤." >> $target
u38_unnecessary_dirs=(
    "/usr/share/doc/apache2"
    "/usr/share/examples/apache2"
    "/var/www/error/"
    "/var/www/icons/"
    "/var/www/cgi-bin/"
    "/usr/share/doc/nginx/"
    "/usr/share/nginx/modules/"
    "/usr/share/nginx/html/"
    "/usr/share/examples/nginx"
)
u38_unnecessary_files=(
    "/etc/apache2/sites-available/000-default.conf"
    "/usr/share/man/man8/httpd.8.gz"
    "/etc/apache2/conf-enabled/autoindex.conf"
    "/var/www/html/index.html"
    "/var/www/html/favicon.ico"
    "/usr/share/man/man1/apache2.1.gz"
    "/usr/share/nginx/html/index.html"
    "/usr/share/nginx/html/50x.html"
    "/usr/share/nginx/html/favicon.ico"
    "/etc/nginx/sites-available/default"
    "/usr/share/man/man1/nginx.1.gz"
    "/usr/share/man/man8/nginx.8.gz"
)
u38_unnecessary_files_sample=(
    "/var/www/html/*.png"
    "/var/www/html/*.gif"
)
u38_apache_home_checks=("httpd.conf" "apache2.conf" ".htaccess")
u38_idx=0
#/etc/nginx/sites-available/default -> debian 
# /etc/httpd/conf.d/welcome.conf -> REHL
echo "apache, nginx ì˜ ì£¼ìš” ì„¤ì •íŒŒì¼ì„ í† ëŒ€ë¡œ apache í™ˆ ë””ë ‰í„°ë¦¬ ì ê²€ í›„ ì¶”ê°€ ì„¤ì • íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ë¥¼ ì ê²€í•˜ë¯€ë¡œ, ì¤‘ë³µëœ ê²°ê³¼ê°€ ì¡´ì¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤." >> $target
for u38_apache_home_check in "${u38_apache_home_checks[@]}";do
    u38_apache_home=$(find / -type f -name "$u38_apache_home_check" 2> /dev/null | egrep -v "tmp|temp|swap|swp")
    if [ -f "$u38_apache_home" ];then
        u38_documentroot=$(grep -i 'documentroot' "$u38_apache_home" | grep -v "#" | awk '{print $2}' | tr -d '"')
        if [ -n "$u38_documentroot" ];then
            u38_unnecessary_apache_home=$(ls -d "$u38_documentroot/htdocs/manual" 2> /dev/null)
            if [ -d "$u38_unnecessary_apache_home" ];then
                echo "$u38_unnecessary_apache_home ê²½ë¡œê°€ ì¡´ì¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëë‹ˆë‹¤." >> $target
                u38_safe_check=$((u38_safe_check+1))
                for u38_unnecessary_apache_file in "$u38_unnecessary_apache_home/*";do
                    if [ -f "$u38_unnecessary_apache_file" ];then
                        echo "$u38_unnecessary_apache_file íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëë‹ˆë‹¤." >> $target
                        u38_safe_check=$((u38_safe_check+1))
                    elif [ -d "$u38_unnecessary_apache_file" ];then
                        echo "$u38_unnecessary_apache_file ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëë‹ˆë‹¤." >> $target
                        u38_safe_check=$((u38_safe_check+1))
                        echo "$u38_unnecessary_apache_file ë””ë ‰í„°ë¦¬ë¥¼ ì¬ê·€ì ìœ¼ë¡œ íƒìƒ‰í•©ë‹ˆë‹¤." >> $target
                        echo "$(tree $u38_unnecessary_apache_file)" >> $target
                    else
                        u38_idx=$((u38_idx+1))
                    fi
                done
                if [ $u38_idx -eq 0 ];then
                    echo "$u38_unnecessary_apache_home ê²½ë¡œ ë‚´ì— íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                fi
            else
                u38_unnecessary_apache_home=$(ls -d "$u38_documentroot/manual" 2> /dev/null)
                if [ -d "$u38_unnecessary_apache_home" ];then
                    echo "$u38_unnecessary_apache_home ê²½ë¡œê°€ ì¡´ì¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëë‹ˆë‹¤." >> $target
                    u38_safe_check=$((u38_safe_check+1))
                    for u38_unnecessary_apache_file in "$u38_unnecessary_apache_home/*";do
                        if [ -f "$u38_unnecessary_apache_file" ];then
                            echo "$u38_unnecessary_apache_file íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëë‹ˆë‹¤." >> $target
                            u38_safe_check=$((u38_safe_check+1))
                        elif [ -d "$u38_unnecessary_apache_file" ];then
                            echo "$u38_unnecessary_apache_file ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëë‹ˆë‹¤." >> $target
                            u38_safe_check=$((u38_safe_check+1))
                            echo "$u38_unnecessary_apache_file ë””ë ‰í„°ë¦¬ë¥¼ ì¬ê·€ì ìœ¼ë¡œ íƒìƒ‰í•©ë‹ˆë‹¤." >> $target
                            echo "$(tree $u38_unnecessary_apache_file)" >> $target
                        else
                            u38_idx=$((u38_idx+1))

                        fi
                    done
                    if [ $u38_idx -eq 0 ];then
                        echo "$u38_unnecessary_apache_home ê²½ë¡œ ë‚´ì— íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    fi
                fi
            fi
        else
            for i in "/etc/httpd/conf.d/*";do
                u38_documentroot=$(grep -iR 'documentroot' /etc/apache2/* | grep -v "#" | awk -F':' '{print $2}' | awk '{print $2}' | tr -d '"')
                if [ -n "$u38_documentroot" ];then
                    u38_unnecessary_apache_home=$(ls -ld "$u38_documentroot/htdocs/manual" 2> /dev/null)
                    if [ -d "$u38_unnecessary_apache_home" ];then
                        echo "$u38_unnecessary_apache_home ê²½ë¡œê°€ ì¡´ì¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëë‹ˆë‹¤." >> $target
                        u38_safe_check=$((u38_safe_check+1))
                        for u38_unnecessary_apache_file in "$u38_unnecessary_apache_home/*";do
                            if [ -f "$u38_unnecessary_apache_file" ];then
                                echo "$u38_unnecessary_apache_file íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëë‹ˆë‹¤." >> $target
                                u38_safe_check=$((u38_safe_check+1))
                            elif [ -d "$u38_unnecessary_apache_file" ];then
                                echo "$u38_unnecessary_apache_file ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëë‹ˆë‹¤." >> $target
                                u38_safe_check=$((u38_safe_check+1))
                                echo "$u38_unnecessary_apache_file ë””ë ‰í„°ë¦¬ë¥¼ ì¬ê·€ì ìœ¼ë¡œ íƒìƒ‰í•©ë‹ˆë‹¤." >> $target
                                echo "$(tree $u38_unnecessary_apache_file)" >> $target
                            else
                                u38_idx=$((u38_idx+1))

                            fi
                        done
                        if [ $u38_idx -eq 0 ];then
                            echo "$u38_unnecessary_apache_home ê²½ë¡œ ë‚´ì— íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                        fi
                    else
                        u38_unnecessary_apache_home=$(ls -ld "$u38_documentroot/manual" 2> /dev/null)
                        if [ -d "$u38_unnecessary_apache_home" ];then
                            echo "$u38_unnecessary_apache_home ê²½ë¡œê°€ ì¡´ì¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëë‹ˆë‹¤." >> $target
                            u38_safe_check=$((u38_safe_check+1))
                            for u38_unnecessary_apache_file in "$u38_unnecessary_apache_home/*";do
                                if [ -f "$u38_unnecessary_apache_file" ];then
                                    echo "$u38_unnecessary_apache_file íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëë‹ˆë‹¤." >> $target
                                    u38_safe_check=$((u38_safe_check+1))
                                elif [ -d "$u38_unnecessary_apache_file" ];then
                                    echo "$u38_unnecessary_apache_file ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëë‹ˆë‹¤." >> $target
                                    u38_safe_check=$((u38_safe_check+1))
                                    echo "$u38_unnecessary_apache_file ë””ë ‰í„°ë¦¬ë¥¼ ì¬ê·€ì ìœ¼ë¡œ íƒìƒ‰í•©ë‹ˆë‹¤." >> $target
                                    echo "$(tree $u38_unnecessary_apache_file)" >> $target
                                else
                                    u38_idx=$((u38_idx+1))

                                fi
                            done
                            if [ $u38_idx -eq 0 ];then
                                echo "$u38_unnecessary_apache_home ê²½ë¡œ ë‚´ì— íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                            fi
                        fi
                    fi
                fi
            done
        fi     
    fi
done
u38_idx=0
for u38_unnecessary_dir in "${u38_unnecessary_dirs[@]}";do
    echo "$u38_unnecessary_dir ê²½ë¡œì— ëŒ€í•´ ì ê²€í•©ë‹ˆë‹¤." >> $target
    if [ -d "$u38_unnecessary_dir" ];then
         for u38_dected_file in "$u38_unnecessary_dir";do
            if [ -f "$u38_dected_file" ];then
                echo "$u38_unnecessary_dir ê²½ë¡œì—ì„œ $u38_dected_file íŒŒì¼ì´ ì‹ë³„ë˜ì—ˆìŠµë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ íŒŒì¼ì¼ ê²½ìš° ì‚­ì œ ë°”ëë‹ˆë‹¤." >> $target
                u38_safe_check=$((u38_safe_check+1))
            elif [ -d "$u38_dected_file" ];then
                echo "$u38_dected_file ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëë‹ˆë‹¤." >> $target
                u38_safe_check=$((u38_safe_check+1))
                echo "$u38_dected_file ë””ë ‰í„°ë¦¬ë¥¼ ì¬ê·€ì ìœ¼ë¡œ íƒìƒ‰í•©ë‹ˆë‹¤." >> $target
                echo "$(tree $u38_dected_file)" >> $target
            else
                u38_idx=$((u38_idx+1))

            fi
         done
    else
        echo "$u38_unnecessary_dir ê²½ë¡œê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi  
done

for u38_unnecessary_file in "${u38_unnecessary_files[@]}";do
    if [ -f "$u38_unnecessary_file" ];then
        echo "$u38_unnecessary_file íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œê²½ìš° ì‚­ì œ ë°”ëë‹ˆë‹¤." >> $target
        u38_safe_check=$((u38_safe_check+1))
        u38_idx=$((u38_idx+1))
    else
        echo "$u38_unnecessary_file íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
done
if [ $u38_idx -eq 0 ];then
    echo "ê¸°ë³¸ì ìœ¼ë¡œ ë¶ˆí•„ìš”í•œ íŒŒì¼ì€ ë°œê²¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì¶”ê°€ì ì¸ ìˆ˜ë™ ì ê²€ì„ ê¶Œì¥í•©ë‹ˆë‹¤." >> $target
fi
for u38_unnecessary_file_sample in "$u38_unnecessary_files_sample";do
    if [ -f "$u38_unnecessary_file_sample" ];then >> $target
        echo "$u38_unnecessary_file_sample íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ë°”ëë‹ˆë‹¤." >> $target
        u38_safe_check=$((u38_safe_check+1))
    fi
done

if [[ $u38_safe_check -ge 1 ]];then
    u38=$((u38+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u38 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u38_Service_Management=1
fi

cat << EOF
===== [U-39] Disabling Web Service Links              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-39 ì›¹ì„œë¹„ìŠ¤ ë§í¬ ì‚¬ìš©ê¸ˆì§€              " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  :  ë¬´ë¶„ë³„í•œ ì‹¬ë³¼ë¦­ ë§í¬, aliases ì‚¬ìš©ì œí•œìœ¼ë¡œ ì‹œìŠ¤í…œ ê¶Œí•œì˜ íƒˆì·¨ ë°©ì§€ë¥¼ ëª©ì ìœ¼ë¡œ í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : ì›¹ ë£¨íŠ¸ í´ë”(DocumentRoot)ì— root ë””ë ‰í„°ë¦¬(/)ë¥¼ ë§í¬í•˜ëŠ” íŒŒì¼ì´ ìˆìœ¼ë©° ë””ë ‰í„°ë¦¬ ì¸ë±ì‹± ê¸°ëŠ¥ì´ ì°¨ë‹¨ë˜ì–´ ìˆì–´ë„ root ë””ë ‰í„°ë¦¬ ì—´ëŒì´ ê°€ëŠ¥í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ì‹¬ë³¼ë¦­ ë§í¬, aliases ì‚¬ìš©ì„ ì œí•œí•œ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ì‹¬ë³¼ë¦­ ë§í¬, aliases ì‚¬ìš©ì„ ì œí•œí•˜ì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-39 ì ê²€ ê²°ê³¼" >> $result
u39=0
u39_safe_check=0
u39_Service_Management=0
u39_apache_files=("/etc/apache2/conf-available/*.conf" "/etc/apache2/sites-available/*.conf" "/etc/apache2/sites-enabled/*.conf")
u39_nginx_files=("/etc/nginx/conf.d/*.conf" "/etc/nginx/sites-available/*.conf" "/etc/nginx/sites-enabled/*.conf")
u39_apache_home_checks=("httpd.conf" "apache2.conf" ".htaccess")
u39_idx=0
u39_break=0
u39_idxn=0
echo "â€»Cent OS 7 ê¸°ì¤€ Apache ë©”ì¸ ì„¤ì •íŒŒì¼ ê²½ë¡œì™€ Nginx ë©”ì¸ ì„¤ì • íŒŒì¼ì¸ /etc/nginx/nginx.confë¥¼ ì ê²€í•©ë‹ˆë‹¤. í•´ë‹¹ ê²½ë¡œê°€ ì¡´ì¬í•˜ì§€ ì•Šì„ ê²½ìš°, ì•„íŒŒì¹˜ ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ëª…ì„ í† ëŒ€ë¡œ íŒŒì¼ íƒìƒ‰ í›„ ì ê²€ì´ ì§„í–‰ë©ë‹ˆë‹¤. ì¤‘ë³µëœ íŒŒì¼ëª…ì´ ì¡´ì¬í•  ê²½ìš° ìˆ˜ë™ ì ê²€ì„ ê¶Œì¥í•©ë‹ˆë‹¤.â€»"  >> $target
echo "apache, nginx ì˜ ì£¼ìš” ì„¤ì •íŒŒì¼ì„ í† ëŒ€ë¡œ apache í™ˆ ë””ë ‰í„°ë¦¬ ì ê²€ í›„ ì¶”ê°€ ì„¤ì • íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ë¥¼ ì ê²€í•˜ë¯€ë¡œ, ì¤‘ë³µëœ ê²°ê³¼ê°€ ì¡´ì¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤." >> $target
for u39_apache_home_check in "${u39_apache_home_checks[@]}";do
    u39_apache_home=$(find / -type f -name "$u39_apache_home_check" 2> /dev/null | egrep -v "tmp|temp|swap|swp")
    if [ -f "$u39_apache_home" ];then
        echo "$u39_apache_home íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        u39_dir_pathconfs_a=($(grep -vE "^\s*#" "$u39_apache_home" | sed -n '/<Directory/,/<\/Directory>/p' | grep -i "^\s*options" | grep -i "FollowSymLinks" | awk '{print $1}'))
        u39_check_dirpath_a=($(grep -vE "^\s*#" "$u39_apache_home" | awk 'BEGIN { inBlock = 0; block = "" }/<Directory/ {block = $0;inBlock = 1;dirPath = $2; gsub("\"", "", dirPath)}/<\/Directory>/ {block = block "\n" $0;inBlock = 0;if (block ~ /FollowSymLinks/) { print dirPath }block = ""}inBlock && ! /<\/Directory>/ { block = block "\n" $0 }' | tr -d '>'))
        for u39_dir_pathconf_a in "${u39_dir_pathconfs_a[@]}";do
            if [ -n "$u39_dir_pathconfs_a" ];then
                echo "ì›¹ ì„œë¹„ìŠ¤ ë§í¬ê°€ í™œì„±í™” ìˆìŠµë‹ˆë‹¤." >> $target
                echo "ì›¹ ì„œë¹„ìŠ¤ ë§í¬ê°€ í™œì„±í™”ëœ ë””ë ‰í† ë¦¬ ê²½ë¡œ : ${u39_check_dirpath_a[$u39_idx]}" >> $target
                u39_safe_check=$((u39_safe_check+1))
                u39_idx=$((u39_idx+1))
            else
                echo "ì›¹ ì„œë¹„ìŠ¤ ë§í¬ê°€ ë¹„í™œì„±í™” ë˜ì–´ ìˆìŠµë‹ˆë‹¤" >> $target
                echo "ì›¹ ì„œë¹„ìŠ¤ ë§í¬ê°€ ë¹„í™œì„±í™”ëœ ë””ë ‰í† ë¦¬ ê²½ë¡œ : ${u39_check_dirpath_a[$u39_idx]}" >> $target
                u39_idxn=$((u39_idxn+1))
            fi
        done
        break
    else 
        u39_idx=0
        if [ $u39_break -eq 1 ];then
            break
        fi
        u39_break=$((u39_break+1))
        echo "$u39_apache_home íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©°, ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ëª…ì„ í† ëŒ€ë¡œ ì ê²€ì„ ì§„í–‰í•©ë‹ˆë‹¤." >> $target
        for u39_apache_file in "${u39_apache_files[@]}";do
            for u39_apache_check in $u39_apache_file;do
                if [ -f "$u39_apache_check" ];then
                    u39_adected_filecks=$(grep -vE "^\s*#" "$u39_apache_check" | grep -iw "options" | grep -iw "FollowSymLinks" | grep -iwv "\-FollowSymLinks" | awk '{print $1}')
                    u39_check_dirpath_a=($(grep -vE "^\s*#" "$u39_apache_check" | awk 'BEGIN { inBlock = 0; block = "" }/<Directory/ {block = $0;inBlock = 1;dirPath = $2; gsub("\"", "", dirPath)}/<\/Directory>/ {block = block "\n" $0;inBlock = 0;if (block ~ /FollowSymLinks/) { print dirPath }block = ""}inBlock && ! /<\/Directory>/ { block = block "\n" $0 }' | tr -d '>'))
                    if [ ${#u39_adected_filecks[@]} -gt 0 ];then
                        for u39_adected_fileck in "${u39_adected_filecks[@]}";do
                            if [[ -n "$u39_adected_fileck" ]];then
                                echo "$u39_apache_check íŒŒì¼ì—ì„œ ì›¹ ì„œë¹„ìŠ¤ ë§í¬ë¥¼ í—ˆìš©í•˜ëŠ” FollowSymLinks ì„¤ì •ê°’ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
                                echo "ì›¹ ì„œë¹„ìŠ¤ ë§í¬ê°€ ì„¤ì •ëœ ë””ë ‰í† ë¦¬ ê²½ë¡œ : ${u39_check_dirpath_a[$u39_idx]}" >> $target
                                u39_safe_check=$((u39_safe_check+1))
                                u39_idx=$((u39_idx+1))
                            else
                                echo "$u39_apache_check íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ë§Œ ì›¹ ì„œë¹„ìŠ¤ ë§í¬ë¥¼ í—ˆìš©í•˜ëŠ” FollowSymLinks ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                                u39_idxn=$((u39_idxn+1))
                            fi
                        done
                    else
                        echo "$u39_adected_filecks íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ë§Œ, ê´€ë ¨ ì„¤ì •ê°’ì€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."
                    fi
                fi
            done
        done
        echo "ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ë“¤ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¶”ê°€ì ì¸ ìˆ˜ë™ ì ê²€ì„ ê¶Œì¥í•©ë‹ˆë‹¤." >> $target
    fi
    u39_idx=0
done
u39_idx=0
u39_idxn=0
#if [ -f "/etc/nginx/nginx.conf" ];then
#    echo "/etc/nginx/nginx.conf íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
#    u39_dir_lisconfs_n=($(grep -vE "^\s*#" "/etc/nginx/nginx.conf" | grep -iw "^\s*autoindex" | sed 's/^[ \t]*//' | awk '{print tolower($2)}' | tr -d ';'))
#    for u39_dir_lisconf_n in "${u39_dir_lisconfs_n[@]}";do
#         if [[ $u39_dir_lisconf_n == "on" ]];then
#             u39=$((u39+1))
#             u39_idx=$((u39_idx+1))
#         else
#             echo "ì›¹ ì„œë¹„ìŠ¤ ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ…ì´ ë¹„í™œì„±í™” ë˜ì–´ ìˆìŠµë‹ˆë‹¤" >> $target
#             u39_idxn=$((u39_idxn+1))
#         fi
#     done
#     echo "ì›¹ ì„œë¹„ìŠ¤ ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ…ì´ í™œì„±í™” ìˆìŠµë‹ˆë‹¤." >> $target
#     echo "ì„¤ì • ê°’ : $u95_dir_lisconf_n" >> $target
#     echo "ì´ $u39_idx ê°œì˜ ì·¨ì•½í•œ on ì„¤ì •ì´ ì¡´ì¬í•©ë‹ˆë‹¤. /etc/nginx/nginx.conf íŒŒì¼ì„ í™•ì¸í•˜ì‹­ì‹œì˜¤." >> $target
#     echo "ì›¹ ì„œë¹„ìŠ¤ ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ…ì´ ë¹„í™œì„±í™”ëœ $u39_idxn ê°œì˜ ì•ˆì „í•œ  off ì„¤ì •ì´ ì¡´ì¬ í•©ë‹ˆë‹¤. /etc/nginx/nginx.conf íŒŒì¼ì„ í™•ì¸í•˜ì‹­ì‹œì˜¤." >> $target
# else 
#     echo "/etc/nginx/nginx.conf íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©°, ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ëª…ì„ í† ëŒ€ë¡œ ì ê²€ì„ ì§„í–‰í•©ë‹ˆë‹¤." >> $target
#     for u39_ngnix_file in "${u39_nginx_files[@]}";do
#         for u39_nginx_check in $u39_ngnix_file;do
#             u39_dir_lisconfs_n=($(grep -vE "^\s*#" "$u39_nginx_check" | grep -iw "^\s*autoindex" | sed 's/^[ \t]*//' | awk '{print tolower($2)}' | tr -d ';'))
#             if [ -f "$u39_nginx_check" ];then
#                 #u39_ndected_filecks=$(grep -vE "^\s*#" "$u39_nginx_check" | grep -iw "autoindex" | tr -d ';' | grep -iw "on")
#                 for u39_dir_lisconf_n in "${u39_dir_lisconfs_n[@]}";do
#                     if [ -n "$u39_dir_lisconf_n" ];then
#                         if [ -n "$u39_dir_lisconf_n" ];then
#                             u39=$((u39+1))
#                             u39_idx=$((u39_idx+1))
#                         else
#                             echo "$u39_nginx_check íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ë§Œ ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ…ì„ í—ˆìš©í•˜ëŠ” autoindex ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
#                             u39_idxn=$((u39_idxn+1))
#                         fi
#                     else
#                         echo "$u39_nginx_check íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ë§Œ ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ…ì„ í—ˆìš©í•˜ëŠ” autoindex ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
#                         u39_idxn=$((u39_idxn+1))
#                     fi
#                 done
#                 if [[ $u39_idx -ge 1 ]];then
#                     echo "$u39_nginx_check íŒŒì¼ì—ì„œ ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ…ì´ í—ˆìš©ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
#                     echo "ì„¤ì • ê°’ : $u39_dir_lisconf_n" >> $target
#                     echo "ì´ $u39_idx ê°œì˜ ì·¨ì•½í•œ on ì„¤ì •ì´ ì¡´ì¬í•©ë‹ˆë‹¤. $u39_nginx_check íŒŒì¼ì„ í™•ì¸í•˜ì‹­ì‹œì˜¤." >> $target
#                     echo "ì›¹ ì„œë¹„ìŠ¤ ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ…ì´ ë¹„í™œì„±í™”ëœ $u39_idxn ê°œì˜ ì•ˆì „í•œ  off ì„¤ì •ì´ ì¡´ì¬ í•©ë‹ˆë‹¤. $u39_nginx_check íŒŒì¼ì„ í™•ì¸í•˜ì‹­ì‹œì˜¤." >> $target
#                 fi
#             fi
#         done
#     done
#     echo "ì¶”ê°€ì ì¸ ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ë“¤ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¶”ê°€ì ì¸ ìˆ˜ë™ ì ê²€ì„ ê¶Œì¥í•©ë‹ˆë‹¤." >> $target
# fi
if [[ $u39_safe_check -ge 1 ]];then
    u39=$((u39+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u39 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u39_Service_Management=1
fi

cat << EOF
===== [U-40] Upload and downloading web service file files              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-40 ì›¹ì„œë¹„ìŠ¤ íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ ì œí•œ              " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : ê¸°ë°˜ì‹œì„¤ íŠ¹ì„±ìƒ ì›ì¹™ì ìœ¼ë¡œ íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œë¥¼ ê¸ˆì§€í•˜ê³  ìˆì§€ë§Œë¶ˆê°€í”¼í•˜ê²Œ í•„ìš”ì‹œ ìš©ëŸ‰ ì‚¬ì´ì¦ˆë¥¼ ì œí•œí•¨ìœ¼ë¡œì¨ ë¶ˆí•„ìš”í•œ ì—…ë¡œë“œì™€ ë‹¤ìš´ë¡œë“œë¥¼ ë°©ì§€í•´ ì„œë²„ì˜ ê³¼ë¶€í•˜ ì˜ˆë°© ë° ìì›ì„ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê¸° ìœ„í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : ì•…ì˜ì  ëª©ì ì„ ê°€ì§„ ì‚¬ìš©ìê°€ ë°˜ë³µ ì—…ë¡œë“œ ë° ì›¹ ì‰˜ ê³µê²© ë“±ìœ¼ë¡œ ì‹œìŠ¤í…œ ê¶Œí•œì„ íƒˆì·¨í•˜ê±°ë‚˜ ëŒ€ìš©ëŸ‰ íŒŒì¼ì˜ ë°˜ë³µ ì—…ë¡œë“œë¡œ ì„œë²„ìì›ì„ ê³ ê°ˆì‹œí‚¤ëŠ” ê³µê²©ì˜ ìœ„í—˜ì´ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œë¥¼ ì œí•œí•œ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œë¥¼ ì œí•œí•˜ì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-40 ì ê²€ ê²°ê³¼" >> $result
u40=0
u40_safe_check=0
u40_Service_Management=0
u40_apache_files=("/etc/apache2/conf-available/*.conf" "/etc/apache2/sites-available/*.conf" "/etc/apache2/sites-enabled/*.conf")
u40_nginx_files=("/etc/nginx/conf.d/*.conf" "/etc/nginx/sites-available/*.conf" "/etc/nginx/sites-enabled/*.conf")
u40_apache_home_checks=("httpd.conf" "apache2.conf" ".htaccess")
u40_idx=0
u40_break=0
u40_idxn=0
echo "â€»Cent OS 7 ê¸°ì¤€ Apache ë©”ì¸ ì„¤ì •íŒŒì¼ ê²½ë¡œì™€ Nginx ë©”ì¸ ì„¤ì • íŒŒì¼ì¸ /etc/nginx/nginx.confë¥¼ ì ê²€í•©ë‹ˆë‹¤. í•´ë‹¹ ê²½ë¡œê°€ ì¡´ì¬í•˜ì§€ ì•Šì„ ê²½ìš°, ì•„íŒŒì¹˜ ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ëª…ì„ í† ëŒ€ë¡œ íŒŒì¼ íƒìƒ‰ í›„ ì ê²€ì´ ì§„í–‰ë©ë‹ˆë‹¤. ì¤‘ë³µëœ íŒŒì¼ëª…ì´ ì¡´ì¬í•  ê²½ìš° ìˆ˜ë™ ì ê²€ì„ ê¶Œì¥í•©ë‹ˆë‹¤.â€»"  >> $target
echo "apache, nginx ì˜ ì£¼ìš” ì„¤ì •íŒŒì¼ì„ í† ëŒ€ë¡œ apache í™ˆ ë””ë ‰í„°ë¦¬ ì ê²€ í›„ ì¶”ê°€ ì„¤ì • íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ë¥¼ ì ê²€í•˜ë¯€ë¡œ, ì¤‘ë³µëœ ê²°ê³¼ê°€ ì¡´ì¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤." >> $target
for u40_apache_home_check in "${u40_apache_home_checks[@]}";do
    u40_apache_home=$(find / -type f -name "$u40_apache_home_check" 2> /dev/null | egrep -v "tmp|temp|swap|swp")
    if [ -f "$u40_apache_home" ];then
        echo "$u40_apache_home íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        u40_dir_pathconfs_a=($(grep -vE "^\s*#" "$u40_apache_home" | sed -n '/<Directory/,/<\/Directory>/p' | grep -i "^\s*LimitRequestBody" | awk '{print $2}'))
        u40_check_dirpath_a=($(grep -vE "^\s*#" "$u40_apache_home" | awk 'BEGIN { inBlock = 0; block = "" }/<Directory/ {block = $0;inBlock = 1;dirPath = $2; gsub("\"", "", dirPath)}/<\/Directory>/ {block = block "\n" $0;inBlock = 0;if (block ~ /LimitRequestBody/) { print dirPath }block = ""}inBlock && ! /<\/Directory>/ { block = block "\n" $0 }' | tr -d '>'))
        if [ -n "$u40_dir_pathconfs_a" ];then
            for u40_dir_pathconf_a in "${u40_dir_pathconfs_a[@]}";do
                if [[ $u40_dir_pathconf_a -ge 5242880 ]];then
                    echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´ìƒ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´ìƒìœ¼ë¡œ ì„¤ì •ëœ ë””ë ‰í† ë¦¬ ê²½ë¡œ : ${u40_check_dirpath_a[$u40_idx]}" >> $target
                    u40_safe_check=$((u40_safe_check+1))
                    u40_idx=$((u40_idx+1))
                else
                    echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´í•˜ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤.." >> $target
                    echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´ìƒìœ¼ë¡œ ì„¤ì •ëœ ë””ë ‰í† ë¦¬ ê²½ë¡œ : ${u40_check_dirpath_a[$u40_idx]}" >> $target
                    u40_idxn=$((u40_idxn+1))
                fi
            done
            break
        else
            echo "$u40_apache_home íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ë§Œ, íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ ì‚¬ì´ì¦ˆë¥¼ ì„¤ì •í•  ìˆ˜ ìˆëŠ” LimitRequestBody ì§€ì‹œìê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    u40_idxn=$((u40_idxn+1))
        fi
    else 
        u40_idx=0
        if [ "$u40_break" -eq 1 ];then
            break
        fi
        u40_break=$((u40_break+1))
        echo "$u40_apache_home_check íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©°, ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ëª…ì„ í† ëŒ€ë¡œ ì ê²€ì„ ì§„í–‰í•©ë‹ˆë‹¤." >> $target
        for u40_apache_file in "${u40_apache_files[@]}";do
            for u40_apache_check in $u40_apache_file;do
                if [ -f "$u40_apache_check" ];then
                    u40_adected_filecks=$(grep -vE "^\s*#" "$u40_apache_check" | grep -iw "LimitRequestBody" | awk '{print $2}' )
                    for u40_adected_fileck in "${u40_adected_filecks[@]}";do
                        if [ -n "$u40_adected_fileck" ];then
                            if [[ "$u40_adected_fileck" -ge 5242880 ]];then
                                echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´ìƒ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                                echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´ìƒìœ¼ë¡œ ì„¤ì •ëœ ë””ë ‰í† ë¦¬ ê²½ë¡œ : ${u40_apache_check[$u40_idx]}" >> $target
                                u40_safe_check=$((u40_safe_check+1))
                                u40_idx=$((u40_idx+1))
                            else
                                echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´í•˜ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤.." >> $target
                                echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´í•˜ë¡œ ì„¤ì •ëœ ë””ë ‰í† ë¦¬ ê²½ë¡œ : ${u40_check_dirpath_a[$u40_idx]}" >> $target
                                u40_idxn=$((u40_idxn+1))
                            fi
                        else
                            echo "$u40_apache_check íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ë§Œ íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ ì‚¬ì´ì¦ˆë¥¼ ì„¤ì •í•  ìˆ˜ ìˆëŠ” LimitRequestBody ì§€ì‹œìê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                            u40_idxn=$((u40_idxn+1))
                        fi
                    done
                fi
            done
        done
        echo "ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ë“¤ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¶”ê°€ì ì¸ ìˆ˜ë™ ì ê²€ì„ ê¶Œì¥í•©ë‹ˆë‹¤." >> $target
        u40_idx=0
    fi
done
u40_idx=0
u40_idxn=0
if [ -f "/etc/nginx/nginx.conf" ];then
    echo "/etc/nginx/nginx.conf íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
    u40_dir_sizechecks_n=($(grep -vE "^\s*#" "/etc/nginx/nginx.conf" | grep -iw "^\s*client_max_body_size" | sed 's/^[ \t]*//' | awk '{print $2}' | tr -d ';'))
    if [ -n "$u40_dir_sizechecks_n" ];then
        for u40_dir_sizecheck_n in "${u40_dir_sizechecks_n[@]}";do
            if [[ $u40_dir_sizecheck_n -ge 5242880 ]];then
                echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´ìƒ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                u40_safe_check=$((u40_safe_check+1))
                u40_idx=$((u40_idx+1))
            else
                echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´í•˜ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤.." >> $target
                u40_idxn=$((u40_idxn+1))
            fi
        done
    else
        echo "/etc/nginx/nginx.conf íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ë§Œ, íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ ì‚¬ì´ì¦ˆë¥¼ ì„¤ì •í•  ìˆ˜ ìˆëŠ” client_max_body_size ì§€ì‹œìê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi    
else 
    echo "/etc/nginx/nginx.conf íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©°, ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ëª…ì„ í† ëŒ€ë¡œ ì ê²€ì„ ì§„í–‰í•©ë‹ˆë‹¤." >> $target
    for u40_ngnix_file in "${u40_nginx_files[@]}";do
        for u40_nginx_check in $u39_ngnix_file;do
            u40_dir_sizechecks_n=($(grep -vE "^\s*#" "$u40_nginx_check" | grep -iw "^\s*client_max_body_size" | sed 's/^[ \t]*//' | awk '{print $2}' | tr -d ';'))
            if [ -f "$u40_nginx_check" ];then
                echo "$u40_nginx_check íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤."
                #u39_ndected_filecks=$(grep -vE "^\s*#" "$u39_nginx_check" | grep -iw "autoindex" | tr -d ';' | grep -iw "on")
                for u40_dir_sizecheck_n in "${u40_dir_sizechecks_n[@]}";do
                    if [ -n "$u40_dir_sizecheck_n" ];then
                        if [ "$u40_dir_sizecheck_n" -ge 5242880 ];then
                            echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´ìƒ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            u40_safe_check=$((u40_safe_check+1))
                            u40_idx=$((u40_idx+1))
                        else
                            echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ íŒŒì¼ì˜ ì‚¬ì´ì¦ˆê°€ 5M ì´í•˜ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤.." >> $target
                            u40_idxn=$((u40_idxn+1))
                        fi
                    else
                        echo "$u39_nginx_check íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ë§Œ Body ì‚¬ì´ì¦ˆë¥¼ ì œí•œí•˜ëŠ” client_max_body_size ì§€ì‹œìê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                        u40_idxn=$((u40_idxn+1))
                    fi
                done
                if [[ $u40_idx -ge 1 ]];then
                    echo "$u40_nginx_check íŒŒì¼ì—ì„œ íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ ì‚¬ì´ì¦ˆê°€ 5Mì´ìƒìœ¼ë¡œ ì„¤ì •ëœ client_max_body_sizeê°€ ìˆìŠµë‹ˆë‹¤." >> $target
                    echo "ì„¤ì • ê°’ : $u40_dir_sizecheck_n" >> $target
                    echo "ì´ $u40_idx ê°œì˜ ì·¨ì•½í•œ ì‚¬ì´ì¦ˆ ì„¤ì •ì´ ì¡´ì¬í•©ë‹ˆë‹¤. $u40_nginx_check íŒŒì¼ì„ í™•ì¸í•˜ì‹­ì‹œì˜¤." >> $target
                    echo "íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ ì‚¬ì´ì¦ˆê°€ ì ì ˆí•˜ê²Œ ì„¤ì •ëœ $u40_idxn ê°œì˜ ì„¤ì •ì´ ì¡´ì¬ í•©ë‹ˆë‹¤. $u40_nginx_check íŒŒì¼ì„ í™•ì¸í•˜ì‹­ì‹œì˜¤." >> $target
                fi
            fi
        done
    done
    echo "ì¶”ê°€ì ì¸ ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ë“¤ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¶”ê°€ì ì¸ ìˆ˜ë™ ì ê²€ì„ ê¶Œì¥í•©ë‹ˆë‹¤." >> $target
fi

if [[ $u40_safe_check -ge 1 ]];then
    u40=$((u40+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u40 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u40_Service_Management=1
fi

cat << EOF
===== [U-41] Separation of Web Service Areas              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-41 ì›¹ì„œë¹„ìŠ¤ ì˜ì—­ì˜ ë¶„ë¦¬              " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : ì›¹ ì„œë¹„ìŠ¤ ì˜ì—­ê³¼ ì‹œìŠ¤í…œ ì˜ì—­ì„ ë¶„ë¦¬ì‹œì¼œì„œ ì›¹ ì„œë¹„ìŠ¤ì˜ ì¹¨í•´ê°€ ì‹œìŠ¤í…œ ì˜ì—­ìœ¼ë¡œ í™•ì¥ë  ê°€ëŠ¥ì„±ì„ ìµœì†Œí™”í•˜ê¸° ìœ„í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : ì›¹ ì„œë²„ì˜ ë£¨íŠ¸ ë””ë ‰í„°ë¦¬ì™€ OSì˜ ë£¨íŠ¸ ë””ë ‰í„°ë¦¬ë¥¼ ë‹¤ë¥´ê²Œ ì§€ì •í•˜ì§€ ì•Šì•˜ì„ ê²½ìš°, ë¹„ì¸ê°€ìê°€ ì›¹ ì„œë¹„ìŠ¤ë¥¼ í†µí•´ í•´í‚¹ì´ ì„±ê³µí•  ê²½ìš° ì‹œìŠ¤í…œ ì˜ì—­ê¹Œì§€ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ì—¬ í”¼í•´ê°€ í™•ì¥ë  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: DocumentRootë¥¼ ë³„ë„ì˜ ë””ë ‰í„°ë¦¬ë¡œ ì§€ì •í•œ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: DocumentRootë¥¼ ê¸°ë³¸ ë””ë ‰í„°ë¦¬ë¡œ ì§€ì •í•œ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-41 ì ê²€ ê²°ê³¼" >> $result
u41=0
u41_Service_Management=0
u41_safe_check=0
u41_apache_files=("/etc/apache2/conf-available/*.conf" "/etc/apache2/sites-available/*.conf" "/etc/apache2/sites-enabled/*.conf")
u41_nginx_files=("/etc/nginx/conf.d/*.conf" "/etc/nginx/sites-available/*.conf" "/etc/nginx/sites-enabled/*.conf")
u41_apache_home_checks=("httpd.conf" "apache2.conf" ".htaccess")
u41_idx=0
u41_break=0
u41_home_dected=0
echo "apache, nginx ì˜ ì£¼ìš” ì„¤ì •íŒŒì¼ì„ í† ëŒ€ë¡œ apache í™ˆ ë””ë ‰í„°ë¦¬ ì ê²€ í›„ ì¶”ê°€ ì„¤ì • íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ë¥¼ ì ê²€í•˜ë¯€ë¡œ, ì¤‘ë³µëœ ê²°ê³¼ê°€ ì¡´ì¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤." >> $target
for u41_apache_home_check in "${u41_apache_home_checks[@]}";do
    u41_apache_home=$(find / -type f -name "$u41_apache_home_check" 2> /dev/null | egrep -v "tmp|temp|swap|swp")
    if [ -f "$u41_apache_home" ];then
        u41_virutalhost=$(grep -v "#" "$u41_apache_home" | awk '/<VirtualHost/,/<\/VirtualHost>/' | sed -n '/<VirtualHost/,/<\/VirtualHost>/p')
        u41_default_documentroot=$(grep -v "#" $u41_apache_home | grep -m 1 -i "^DocumentRoot" | awk '{print $2}' | tr -d '"')
        echo "$u41_apache_home íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        u41_home_dected=$((u41_home_dected+1))
        if [ -n "$u41_default_documentroot" ];then
            if [[ "$u41_default_documentroot" == "/usr/local/apache/htdocs" || "$u41_default_documentroot" == "/usr/local/apache2/htdocs" || "$u41_default_documentroot" ==  "/var/www/html" ]];then
                echo "ê¸°ë³¸ ì„œë²„ì˜ DocumentRootê°€ $u41_default_documentroot ë¡œ ì„¤ì •ë˜ì–´, ê¸°ë³¸ ë””ë ‰í„°ë¦¬ë¡œ ì§€ì •ë˜ì–´ ìˆëŠ” ì„¤ì •ê°’ì´ ì¡´ì¬í•©ë‹ˆë‹¤. $u41_apache_home íŒŒì¼ì„ í™•ì¸í•˜ì‹­ì‹œì˜¤." >> $target
                u41_safe_check=$((u41_safe_check+1))
            else
                echo "ê¸°ë³¸ ì„œë²„ì˜ DocumentRootê°€ ê¸°ë³¸ ë””ë ‰í„°ë¦¬ ì´ì™¸ì˜ ë³„ë„ì˜ ë””ë ‰í„°ë¦¬ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            fi
        else
            echo "$u41_apache_home_check íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ë§Œ, ê´€ë ¨ ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        fi
        if [ -n "$u41_virutalhost" ];then
            echo "ê°€ìƒ í˜¸ìŠ¤íŠ¸ ì„¤ì •ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
            u41_virutalhost_documentroot=($(grep -v "#" "$u41_apache_home" | awk '/<VirtualHost/,/<\/VirtualHost>/' | sed -n '/<VirtualHost/,/<\/VirtualHost>/p' | grep -E "(DocumentRoot|ServerName)" | grep -i 'DocumentRoot' | awk '{print $2}' | tr -d '"' ))
            u41_virutalhost_servdrname=($(grep -v "#" "$u41_apache_home" | awk '/<VirtualHost/,/<\/VirtualHost>/' | sed -n '/<VirtualHost/,/<\/VirtualHost>/p' | grep -E "(DocumentRoot|ServerName)" | grep -i 'ServerName' | awk '{print $2}' | tr -d '"' ))
            for (( u41_i=0; u41_i<${#u41_virutalhost_documentroot[@]}; u41_i++ )); do
                if [[ "${u41_virutalhost_documentroot[$u41_i]}" == "/usr/local/apache/htdocs" || "${u41_virutalhost_documentroot[$u41_i]}" == "/usr/local/apache2/htdocs" || "${u41_virutalhost_documentroot[$u41_i]}" ==  "/var/www/html" ]]; then
                    echo "ê°€ìƒ í˜¸ìŠ¤íŠ¸ ì£¼ì†Œ ${u41_virutalhost_servdrname[$u41_i]} ì˜ DocumentRoot ê°’ì´ ${u41_virutalhost_documentroot[$u41_i]} ì¸ ê¸°ë³¸ ë””ë ‰í„°ë¦¬ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    u41_safe_check=$((u41_safe_check+1))
                else
                    echo "ê°€ìƒ í˜¸ìŠ¤íŠ¸ ì£¼ì†Œ ${u41_virutalhost_servdrname[$u41_i]} DocumentRoot ê°’ì´ ê¸°ë³¸ ë””ë ‰í„°ë¦¬ ì´ì™¸ì˜ ë³„ë„ì˜ ë””ë ‰í„°ë¦¬ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                fi
            done
            echo "ê°€ìƒ í˜¸ìŠ¤íŠ¸ ì„¤ì •ì˜ ì „ì²´ ê°’" >> $target
            echo "$u41_virutalhost" >> $target
        else
            echo "ê°€ìƒ í˜¸ìŠ¤íŠ¸ ì„¤ì •ì€ ë”°ë¡œ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        fi
    else
        u41_idx=0
        if [[ $u41_break -eq 1 && $u41_home_dected -eq 1 ]];then
            break 
        fi
        u41_break=$((u41_break+1))
        for u41_apache_file in "${u41_apache_files[@]}";do
            for u41_apache_check in $u41_apache_file;do
                if [ -f "$u41_apache_check" ];then
                    u41_virutalhost=$(grep -v "#" "$u41_apache_check" | awk '/<VirtualHost/,/<\/VirtualHost>/' | sed -n '/<VirtualHost/,/<\/VirtualHost>/p')
                    u41_default_documentroot=$(grep -v "#" $u41_apache_check | grep -m 1 -i "^DocumentRoot" | awk '{print $2}' | tr -d '"')
                    echo "$u41_apache_check íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
                    u41_home_dected=$((u41_home_dected+1))
                    if [ -n "$u41_default_documentroot" ];then
                        if [[ "$u41_default_documentroot" == "/usr/local/apache/htdocs" || "$u41_default_documentroot" == "/usr/local/apache2/htdocs" || "$u41_default_documentroot" ==  "/var/www/html" ]];then
                            echo "ê¸°ë³¸ ì„œë²„ì˜ DocumentRootê°€ $u41_default_documentroot ë¡œ ì„¤ì •ë˜ì–´, ê¸°ë³¸ ë””ë ‰í„°ë¦¬ë¡œ ì§€ì •ë˜ì–´ ìˆëŠ” ì„¤ì •ê°’ì´ ì¡´ì¬í•©ë‹ˆë‹¤. $u41_apache_check íŒŒì¼ì„ í™•ì¸í•˜ì‹­ì‹œì˜¤." >> $target
                            u41_safe_check=$((u41_safe_check+1))
                        else
                            echo "ê¸°ë³¸ ì„œë²„ì˜ DocumentRootê°€ ê¸°ë³¸ ë””ë ‰í„°ë¦¬ ì´ì™¸ì˜ ë³„ë„ì˜ ë””ë ‰í„°ë¦¬ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        fi
                    else
                        echo "$u41_apache_check íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ë§Œ, ê´€ë ¨ ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    fi
                    if [ -n "$u41_virutalhost" ];then
                        echo "ê°€ìƒ í˜¸ìŠ¤íŠ¸ ì„¤ì •ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
                        u41_virutalhost_documentroot=($(grep -v "#" "$u41_apache_check" | awk '/<VirtualHost/,/<\/VirtualHost>/' | sed -n '/<VirtualHost/,/<\/VirtualHost>/p' | grep -E "(DocumentRoot|ServerName)" | grep -i 'DocumentRoot' | awk '{print $2}' | tr -d '"' ))
                        u41_virutalhost_servdrname=($(grep -v "#" "$u41_apache_check" | awk '/<VirtualHost/,/<\/VirtualHost>/' | sed -n '/<VirtualHost/,/<\/VirtualHost>/p' | grep -E "(DocumentRoot|ServerName)" | grep -i 'ServerName' | awk '{print $2}' | tr -d '"' ))
                        for (( u41_i=0; u41_i<${#u41_virutalhost_documentroot[@]}; u41_i++ )); do
                            if [[ "${u41_virutalhost_documentroot[$u41_i]}" == "/usr/local/apache/htdocs" || "${u41_virutalhost_documentroot[$u41_i]}" == "/usr/local/apache2/htdocs" || "${u41_virutalhost_documentroot[$u41_i]}" ==  "/var/www/html" ]]; then
                                echo "ê°€ìƒ í˜¸ìŠ¤íŠ¸ ì£¼ì†Œ ${u41_virutalhost_servdrname[$u41_i]} ì˜ DocumentRoot ê°’ì´ ${u41_virutalhost_documentroot[$u41_i]} ì¸ ê¸°ë³¸ ë””ë ‰í„°ë¦¬ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                                u41_safe_check=$((u41_safe_check+1))
                            else
                                echo "ê°€ìƒ í˜¸ìŠ¤íŠ¸ ì£¼ì†Œ ${u41_virutalhost_servdrname[$u41_i]} DocumentRoot ê°’ì´ ê¸°ë³¸ ë””ë ‰í„°ë¦¬ ì´ì™¸ì˜ ë³„ë„ì˜ ë””ë ‰í„°ë¦¬ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            fi
                        done
                        echo "ê°€ìƒ í˜¸ìŠ¤íŠ¸ ì„¤ì •ì˜ ì „ì²´ ê°’" >> $target
                        echo "$u41_virutalhost" >> $target
                    else
                        echo "ê°€ìƒ í˜¸ìŠ¤íŠ¸ ì„¤ì •ì€ ë”°ë¡œ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    fi
                fi
            done
        done
    fi
done

if [ -f "/etc/nginx/nginx.conf" ];then
    echo "/etc/nginx/nginx.conf íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
    u41_default_root=(grep -m 1 -i "root" "/etc/nginx/nginx.conf")
    u41_default_aliass=($(grep -i "alias" "/etc/nginx/nginx.conf"))
    u41_virutalhost_roots=($(grep -i "root" /etc/nginx/nginx.conf | sed '1d'))
    if [ -n "$u41_default_root" ];then
        if [[ "$u41_default_root" == "/usr/share/nginx/html" || "$u41_default_root" == "/var/www/html" ]];then
            echo "nginx ì„¤ì • íŒŒì¼ ë‚´ì— root ì§€ì‹œìë¡œ ì¸í•´ ê¸°ë³¸ ë””ë ‰í„°ë¦¬ì¸ $u41_default_root ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            u41_safe_check=$((u41_safe_check+1))
        else
            echo "nginx ì„¤ì • íŒŒì¼ ë‚´ì— root ì§€ì‹œìê°€ ê¸°ë³¸ ë””ë ‰í„°ë¦¬ ì´ì™¸ì˜ ë””ë ‰í„°ë¦¬ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
        fi
    else
        echo "/etc/nginx/nginx.conf íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ë§Œ ê´€ë ¨ ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
    if [ -n "$u41_default_aliass" ];then
        echo "/etc/nginx/nginx.conf íŒŒì¼ë‚´ì— alias ì„¤ì •ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        u41_count=1
        for u41_default_alias in "${u41_default_aliass[@]}";do
            if [[ "$u41_default_alias" == "/usr/share/nginx/html" || "$u41_default_alias" == "/var/www/html" ]];then
                echo "$u41_count ë²ˆì§¸ë¡œ ì„¤ì •ëœ aliasì— ì„¤ì •ë˜ì–´ ìˆëŠ” ê²½ë¡œê°€ ê¸°ë³¸ ë””ë ‰í„°ë¦¬ì¸ $u41_default_alias ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                u41_safe_check=$((u41_safe_check+1))
            else
                echo "$u41_count ë²ˆì§¸ë¡œ ì„¤ì •ëœ aliasì— ì„¤ì •ë˜ì–´ ìˆëŠ” ê²½ë¡œê°€ $u41_default_alias ë¡œ ì„¤ì •ë˜ì–´, ê¸°ë³¸ ë””ë ‰í„°ë¦¬ ì´ì™¸ì˜ ë””ë ‰í„°ë¦¬ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            fi
            u41_count=$((u41_count+1))
        done
    else
        echo "/etc/nginx/nginx.conf íŒŒì¼ ë‚´ì— alias ì„¤ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
    if [ -n "$u41_virutalhost_root" ];then
        echo "/etc/nginx/nginx.conf íŒŒì¼ ë‚´ì— ê°€ìƒ í˜¸ìŠ¤íŠ¸ ì„¤ì •ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        u41_count=1
        for u41_virutalhost_root in "${u41_virutalhost_roots[@]}";do
            if [[ "$u41_virutalhost_root" == "/usr/share/nginx/html" || "$u41_virutalhost_root" == "/var/www/html" ]];then
                echo "$u41_count ë²ˆì§¸ ê°€ìƒ í˜¸ìŠ¤íŠ¸ì˜ ì„¤ì • ê²½ë¡œê°€ ê¸°ë³¸ ë””ë ‰í„°ë¦¬ì¸ $u41_virutalhost_root ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤."
                u41_safe_check=$((u41_safe_check+1))
            else
                echo "$u41_count ë²ˆì§¸ ê°€ìƒ í˜¸ìŠ¤íŠ¸ ì„¤ì • ë‚´ì— ì„¤ì •ë˜ì–´ ìˆëŠ” ê²½ë¡œê°€ ê¸°ë³¸ ë””ë ‰í„°ë¦¬ ì´ì™¸ì˜ ë””ë ‰í„°ë¦¬ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            fi
            u41_count=$((u41_count+1))
        done
    else
        echo "/etc/nginx/nginx.conf íŒŒì¼ ë‚´ì— ê°€ìƒ í˜¸ìŠ¤íŠ¸ ì„¤ì •ì€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
else 
    echo "/etc/nginx/nginx.conf íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©°, ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ëª…ì„ í† ëŒ€ë¡œ ì ê²€ì„ ì§„í–‰í•©ë‹ˆë‹¤."  >> $target
    for u41_ngnix_file in "${u41_nginx_files[@]}";do
        for u41_nginx_check in $u41_ngnix_file;do
            if [ -f "$u41_nginx_check" ];then
                echo "$u41_nginx_check íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
                u41_default_root=(grep -m 1 -i "root" "$u41_nginx_check")
                u41_default_aliass=($(grep -i "alias" "$u41_nginx_check"))
                u41_virutalhost_roots=($(grep -i "root" $u41_nginx_check | sed '1d'))
                if [ -n "$u41_default_root" ];then
                    if [[ "$u41_default_root" == "/usr/share/nginx/html" || "$u41_default_root" == "/var/www/html" ]];then
                        echo "nginx ì„¤ì • íŒŒì¼ ë‚´ì— root ì§€ì‹œìë¡œ ì¸í•´ ê¸°ë³¸ ë””ë ‰í„°ë¦¬ì¸ $u41_default_root ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤."  >> $target
                        u41_safe_check=$((u41_safe_check+1))
                    else
                        echo "nginx ì„¤ì • íŒŒì¼ ë‚´ì— root ì§€ì‹œìê°€ ê¸°ë³¸ ë””ë ‰í„°ë¦¬ ì´ì™¸ì˜ ë””ë ‰í„°ë¦¬ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    fi
                else
                    echo "$u41_nginx_check íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ë§Œ ê´€ë ¨ ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                fi
                if [ -n "$u41_default_aliass" ];then
                    echo "$u41_nginx_check íŒŒì¼ë‚´ì— alias ì„¤ì •ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
                    u41_count=1
                    for u41_default_alias in "${u41_default_aliass[@]}";do
                        if [[ "$u41_default_alias" == "/usr/share/nginx/html" || "$u41_default_alias" == "/var/www/html" ]];then
                            echo "$u41_count ë²ˆì§¸ë¡œ ì„¤ì •ëœ alias ì— ì„¤ì •ë˜ì–´ ìˆëŠ” ê²½ë¡œê°€ ê¸°ë³¸ ë””ë ‰í„°ë¦¬ì¸ $u41_default_alias ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            u41_safe_check=$((u41_safe_check+1))
                        else
                            echo "$u41_count ë²ˆì§¸ë¡œ ì„¤ì •ëœ alias ë¡œ ì„¤ì •ë˜ì–´ ìˆëŠ” ê²½ë¡œê°€ $u41_default_alias ë¡œ ì„¤ì •ë˜ì–´, ê¸°ë³¸ ë””ë ‰í„°ë¦¬ ì´ì™¸ì˜ ë””ë ‰í„°ë¦¬ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        fi
                        u41_count=$((u41_count+1))
                    done
                else
                    echo "$u41_nginx_check íŒŒì¼ ë‚´ì— alias ì„¤ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                fi
                if [ -n "$u41_virutalhost_root" ];then
                    echo "$u41_nginx_check íŒŒì¼ ë‚´ì— ê°€ìƒ í˜¸ìŠ¤íŠ¸ ì„¤ì •ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
                    for u41_virutalhost_root in "${u41_virutalhost_roots[@]}";do
                        u41_count=1
                        if [[ "$u41_virutalhost_root" == "/usr/share/nginx/html" || "$u41_virutalhost_root" == "/var/www/html" ]];then
                            echo "$u41_count ë²ˆì§¸ ê°€ìƒ í˜¸ìŠ¤íŠ¸ì˜ ì„¤ì • ê²½ë¡œê°€ ê¸°ë³¸ ë””ë ‰í„°ë¦¬ì¸ $u41_virutalhost_root ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            u41_safe_check=$((u41_safe_check+1))
                        else
                            echo "$u41_count ë²ˆì§¸ ê°€ìƒ í˜¸ìŠ¤íŠ¸ ì„¤ì • ë‚´ì— ì„¤ì •ë˜ì–´ ìˆëŠ” ê²½ë¡œê°€ ê¸°ë³¸ ë””ë ‰í„°ë¦¬ ì´ì™¸ì˜ ë””ë ‰í„°ë¦¬ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        fi
                        u41_count=$((u41_count+1))
                    done
                else
                    echo "$u41_nginx_check íŒŒì¼ ë‚´ì— ê°€ìƒ í˜¸ìŠ¤íŠ¸ ì„¤ì •ì€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                fi
            fi
        done
    done
    echo "ì¶”ê°€ì ì¸ ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ë“¤ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¶”ê°€ì ì¸ ìˆ˜ë™ ì ê²€ì„ ê¶Œì¥í•©ë‹ˆë‹¤." >> $target
fi
if [[ $u41_safe_check -ge 1 ]];then
    u41=$((u41+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u41 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u41_Service_Management=1
fi

cat << EOF
===== [U-42] Apply the latest security patches and vendor recommendations              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-42 ìµœì‹  ë³´ì•ˆíŒ¨ì¹˜ ë° ë²¤ë” ê¶Œê³ ì‚¬í•­ ì ìš©              " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : ì£¼ê¸°ì ì¸ íŒ¨ì¹˜ ì ìš©ì„ í†µí•˜ì—¬ ë³´ì•ˆì„± ë° ì‹œìŠ¤í…œ ì•ˆì •ì„±ì„ í™•ë³´í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : ìµœì‹  ë³´ì•ˆíŒ¨ì¹˜ê°€ ì ìš©ë˜ì§€ ì•Šì„ ê²½ìš°, ì´ë¯¸ ì•Œë ¤ì§„ ì·¨ì•½ì ì„ í†µí•˜ì—¬ ê³µê²©ìì— ì˜í•´ ì‹œìŠ¤í…œ ì¹¨í•´ì‚¬ê³  ë°œìƒ ê°€ëŠ¥ì„±ì´ ì¡´ì¬í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: íŒ¨ì¹˜ ì ìš© ì •ì±…ì„ ìˆ˜ë¦½í•˜ì—¬ ì£¼ê¸°ì ìœ¼ë¡œ íŒ¨ì¹˜ê´€ë¦¬ë¥¼ í•˜ê³  ìˆìœ¼ë©°, íŒ¨ì¹˜ ê´€ë ¨ ë‚´ìš©ì„ í™•ì¸í•˜ê³  ì ìš©í–ˆì„ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: íŒ¨ì¹˜ ì ìš© ì •ì±…ì„ ìˆ˜ë¦½í•˜ì§€ ì•Šê³  ì£¼ê¸°ì ìœ¼ë¡œ íŒ¨ì¹˜ê´€ë¦¬ë¥¼ í•˜ì§€ ì•Šê±°ë‚˜ íŒ¨ì¹˜ ê´€ë ¨ ë‚´ìš©ì„ í™•ì¸í•˜ì§€ ì•Šê³  ì ìš©í•˜ì§€ ì•Šì•˜ì„ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-42 ì ê²€ ê²°ê³¼" >> $result
echo "ê·€ì‚¬ì˜ ì‹œìŠ¤í…œì— ëŒ€í•œ ë³´ì•ˆ ë‹´ë‹¹ìì™€ì˜ ìƒë‹´ì„ í†µí•´ O/S ê´€ë¦¬ì, ì„œë¹„ìŠ¤ ê°œë°œìê°€ íŒ¨ì¹˜ ì ìš©ì— ë”°ë¥¸ ì„œë¹„ìŠ¤ ì˜í–¥ ì •ë„ë¥¼ íŒŒì•…í•˜ì—¬ OS ê´€ë¦¬ì ë° ë²¤ë”ì—ì„œì˜ ì ìš©ì—¬ë¶€ë¥¼ í™•ì¸í•´ì•¼í•¨." >> $target
u42_Patch_Management=0


cat << EOF
===== [U-43] Periodic review and reporting of logs              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-43 ë¡œê·¸ì˜ ì •ê¸°ì  ê²€í†  ë° ë³´ê³               " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : ì •ê¸°ì ì¸ ë¡œê·¸ ì ê²€ì„ í†µí•´ ì•ˆì •ì ì¸ ì‹œìŠ¤í…œ ìƒíƒœ ìœ ì§€ ë° ì™¸ë¶€ ê³µê²© ì—¬ë¶€ë¥¼ íŒŒì•…í•˜ê¸° ìœ„í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : ë¡œê·¸ì˜ ê²€í†  ë° ë³´ê³  ì ˆì°¨ê°€ ì—†ëŠ” ê²½ìš° ì™¸ë¶€ ì¹¨ì… ì‹œë„ì— ëŒ€í•œ ì‹ë³„ì´ ëˆ„ë½ë  ìˆ˜ ìˆê³ , ì¹¨ì… ì‹œë„ê°€ ì˜ì‹¬ë˜ëŠ” ì‚¬ë¡€ ë°œê²¬ ì‹œ ê´€ë ¨ ìë£Œë¥¼ ë¶„ì„í•˜ì—¬ í•´ë‹¹ì¥ë¹„ì— ëŒ€í•œ ì ‘ê·¼ì„ ì°¨ë‹¨í•˜ëŠ” ë“±ì˜ ì¶”ê°€ ì¡°ì¹˜ê°€ ì–´ë ¤ì›€" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ì ‘ì†ê¸°ë¡ ë“±ì˜ ë³´ì•ˆ ë¡œê·¸, ì‘ìš© í”„ë¡œê·¸ë¨ ë° ì‹œìŠ¤í…œ ë¡œê·¸ ê¸°ë¡ì— ëŒ€í•´ ì •ê¸°ì ìœ¼ë¡œ ê²€í† , ë¶„ì„, ë¦¬í¬íŠ¸ ì‘ì„± ë° ë³´ê³  ë“±ì˜ ì¡°ì¹˜ê°€ ì´ë£¨ì–´ì§€ëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ìœ„ ë¡œê·¸ ê¸°ë¡ì— ëŒ€í•´ ì •ê¸°ì ìœ¼ë¡œ ê²€í† , ë¶„ì„, ë¦¬í¬íŠ¸ ì‘ì„± ë° ë³´ê³  ë“±ì˜ ì¡°ì¹˜ê°€ ì´ë£¨ì–´ ì§€ì§€ ì•ŠëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-43 ì ê²€ ê²°ê³¼" >> $result
echo "ê·€ì‚¬ì˜ ì‹œìŠ¤í…œì— ëŒ€í•œ ë³´ì•ˆ ë‹´ë‹¹ìì™€ì˜ ìƒë‹´ì„ í†µí•´ ì ‘ì†ê¸°ë¡ ë“±ì˜ ë³´ì•ˆ ë¡œê·¸, ì‘ìš© í”„ë¡œê·¸ë¨ ë° ì‹œìŠ¤í…œ ë¡œê·¸ ê¸°ë¡ì— ëŒ€í•´ ì •ê¸°ì ìœ¼ë¡œ ê²€í† , ë¶„ì„, ë¦¬í¬íŠ¸ ì‘ì„± ë° ë³´ê³  ë“±ì˜ ì¡°ì¹˜ê°€ ì´ë£¨ì–´ì§€ì— ëŒ€í•œ í™•ì¸ í•„ìš”" >> $target
u43_Log_Management=0

cat << EOF
===== [U-44] No UID other than root '0'              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-44 root ì´ì™¸ì˜ UIDê°€ â€˜0â€™ ê¸ˆì§€              " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : root ê³„ì •ê³¼ ë™ì¼í•œ UIDê°€ ì¡´ì¬í•˜ëŠ”ì§€ ì ê²€í•˜ì—¬ rootê¶Œí•œì´ ì¼ë°˜ ì‚¬ìš©ì ê³„ì •ì´ë‚˜ ë¹„ì¸ê°€ìì˜ ì ‘ê·¼ ìœ„í˜‘ì— ì•ˆì „í•˜ê²Œ ë³´í˜¸ë˜ê³  ìˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : root ê³„ì •ê³¼ ë™ì¼ UIDê°€ ì„¤ì •ë˜ì–´ ìˆëŠ” ì¼ë°˜ì‚¬ìš©ì ê³„ì •ë„ root ê¶Œí•œì„ ë¶€ì—¬ë°›ì•„ ê´€ë¦¬ìê°€ ì‹¤í–‰ í•  ìˆ˜ ìˆëŠ” ëª¨ë“  ì‘ì—…ì´ ê°€ëŠ¥í•¨(ì„œë¹„ìŠ¤ ì‹œì‘, ì¤‘ì§€, ì¬ë¶€íŒ…, root ê¶Œí•œ íŒŒì¼ í¸ì§‘ ë“±) rootì™€ ë™ì¼í•œ UIDë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ ì‚¬ìš©ì ê°ì‚¬ ì¶”ì  ì‹œ ì–´ë ¤ì›€ì´ ë°œìƒí•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: root ê³„ì •ê³¼ ë™ì¼í•œ UIDë¥¼ ê°–ëŠ” ê³„ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: root ê³„ì •ê³¼ ë™ì¼í•œ UIDë¥¼ ê°–ëŠ” ê³„ì •ì´ ì¡´ì¬í•˜ëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-44 ì ê²€ ê²°ê³¼" >> $result
u44_Account_Management=0
u44_safe_check=0
u44=0
u44_uid_checks=($(grep -v "root" /etc/passwd | awk -F: '$3 == 0 {print $1}'))
u44_gid_checks=($(grep -v "root" /etc/passwd | awk -F: '$4 == 0 {print $1}'))

if [ -n "$u44_uid_check"  ];then
    for u44_uid_check in "${u44_uid_checks[@]}";do
        echo "$u44_uid_check ê³„ì •ì˜ UIDê°’ì´ root ìœ ì €ì™€ ë™ì¼í•œ 0 ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
        u44_safe_check=$((u44_safe_check+1))
    done
else
    echo "UID ê°’ì´ root ìœ ì €ì™€ ë™ì¼í•œ 0ìœ¼ë¡œ ì„¤ì •ëœ ê³„ì •ì€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi
echo "ì¶”ê°€ì ìœ¼ë¡œ GID ì ê²€ì„ ì§„í–‰í•©ë‹ˆë‹¤." >> $target
if [ -n "$u44_gid_checks"  ];then
    for u44_gid_check in "${u44_gid_checks[@]}";do
        echo "$u44_gid_check ê³„ì •ì˜ GIDê°’ì´ root ìœ ì €ì™€ ë™ì¼í•œ 0 ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
        u44_safe_check=$((u44_safe_check+1))
    done
else
    echo "GID ê°’ì´ root ìœ ì €ì™€ ë™ì¼í•œ 0ìœ¼ë¡œ ì„¤ì •ëœ ê³„ì •ì€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [ $u44_safe_check -ge 1 ];then
    u44=$((u44+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u44 -ge 1 ]];then
    Mid=$((Mid+1))
    Account_Management=$((Account_Management+1))
    u44_Account_Management=1
fi

cat << EOF
===== [U-45] Restrict root account su              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-45 root ê³„ì • su ì œí•œ              " >> $target
echo "--------------------------------------------------------------------------" >> $target-F: '{print $4}'
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : su ê´€ë ¨ ê·¸ë£¹ë§Œ su ëª…ë ¹ì–´ ì‚¬ìš© ê¶Œí•œì´ ë¶€ì—¬ë˜ì–´ ìˆëŠ”ì§€ ì ê²€í•˜ì—¬ su ê·¸ë£¹ì— í¬í•¨ë˜ì§€ ì•Šì€ ì¼ë°˜ ì‚¬ìš©ìì˜ su ëª…ë ¹ ì‚¬ìš©ì„ ì›ì²œì ìœ¼ë¡œ ì°¨ë‹¨í•˜ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ë¬´ë¶„ë³„í•œ ì‚¬ìš©ì ë³€ê²½ìœ¼ë¡œ íƒ€ ì‚¬ìš©ì ì†Œìœ ì˜ íŒŒì¼ì„ ë³€ê²½ í•  ìˆ˜ ìˆìœ¼ë©°root ê³„ì •ìœ¼ë¡œ ë³€ê²½í•˜ëŠ” ê²½ìš° ê´€ë¦¬ì ê¶Œí•œì„ íšë“ í•  ìˆ˜ ìˆìŒ" >> $target
echo "â€» ì¼ë°˜ì‚¬ìš©ì ê³„ì • ì—†ì´ root ê³„ì •ë§Œ ì‚¬ìš©í•˜ëŠ” ê²½ìš° su ëª…ë ¹ì–´ ì‚¬ìš©ì œí•œ ë¶ˆí•„ìš”" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: su ëª…ë ¹ì–´ë¥¼ íŠ¹ì • ê·¸ë£¹ì— ì†í•œ ì‚¬ìš©ìë§Œ ì‚¬ìš©í•˜ë„ë¡ ì œí•œë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: su ëª…ë ¹ì–´ë¥¼ ëª¨ë“  ì‚¬ìš©ìê°€ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-45 ì ê²€ ê²°ê³¼" >> $result
u45_Account_Management=0
u45_safe_check=0
u45=0
u45_wheel_check=$(grep -i "wheel" "/etc/passwd" | awk '{print $1}')
u45_whell_group=$(grep -i "wheel" "/etc/group" | awk -F: '{print $4}')
u45_su_perm=$(stat -c "%a" /usr/bin/su)
u45_su_perm_other=$(stat -c "%A" /usr/bin/su | rev | cut -c 1-3 | rev)
if [ -n "$u45_wheel_check" ];then
    echo "$u45_wheel_check ê³„ì •ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
    if grep -i "wheel" "/etc/group";then
        if [ -n "$u45_whell_group" ];then
            echo "$u45_whell_group ê³„ì •ë“¤ì´ wheel ê·¸ë£¹ì— ì†í•´ìˆìŠµë‹ˆë‹¤." >> $target
        else
            echo "wheel ê·¸ë£¹ì˜ í¬í•¨ëœ ê³„ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
            u45_safe_check=$((u45_safe_check+1))
        fi
    fi
else
    echo "wheel ê³„ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    u45_safe_check=$((u45_safe_check+1))
fi
if [[ $u45_su_perm -eq 4750 && "$u45_su_perm_other" == "---" ]];then
    echo "/usr/binbun/su íŒŒì¼ì˜ ê¶Œí•œì´ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
else
    echo "/usr/bin/su íŒŒì¼ì˜ ê¶Œí•œì´ $(stat -c "%A" /usr/bin/su) ë¡œ ì ì ˆí•˜ì§€ ì•Šê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
fi

if [ -f "/etc/pam.d/su" ];then
    u45_pam=$(grep -v "#" "/etc/pam.d/su" | grep auth | grep required | grep pam_wheel.so | egrep -E "use_uid|debug\s*group=wheel")
    if [ -n "$u45_pam" ];then
        echo "/etc/pam.d/su íŒŒì¼ ë‚´ì— pam_wheel.so ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì—¬ wheel ê·¸ë£¹ì˜ ì‚¬ìš©ìë“¤ë§Œ su ëª…ë ¹ì„ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ì œí•œí•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
    else
        echo "/etc/pam.d/su íŒŒì¼ ë‚´ì— whell ê·¸ë£¹ì˜ ì‚¬ìš©ìë“¤ë§Œ suëª…ë ¹ì„ ì‚¬ìš©í•˜ë„ë¡ í•˜ëŠ” ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        u45_safe_check=$((u45_safe_check+1))
    fi
else
    echo "/etc/pam.d/su íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [ $u45_safe_check -ge 1 ];then
    u45=$((u45+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u45 -ge 1 ]];then
    Low=$((Low+1))
    Account_Management=$((Account_Management+1))
    u45_Account_Management=1
fi

cat << EOF
===== [U-46] Set password minimum length              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-46 íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œ ê¸¸ì´ ì„¤ì •              " >> $target
echo "--------------------------------------------------------------------------" >> $target-F: '{print $4}'
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œ ê¸¸ì´ ì„¤ì •ì´ ì ìš©ë˜ì–´ ìˆëŠ”ì§€ ì ê²€í•˜ì—¬ ì§§ì€(8ì ë¯¸ë§Œ) íŒ¨ìŠ¤ì›Œë“œ ê¸¸ì´ë¡œ ë°œìƒí•˜ëŠ” ì·¨ì•½ì ì„ ì´ìš©í•œ ê³µê²©(ë¬´ì‘ìœ„ ëŒ€ì… ê³µê²©, ì‚¬ì „ ëŒ€ì… ê³µê²© ë“±)ì— ëŒ€í•œ ëŒ€ë¹„(ì‚¬ìš©ì íŒ¨ìŠ¤ì›Œë“œ ìœ ì¶œ)ê°€ ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : íŒ¨ìŠ¤ì›Œë“œ ë¬¸ìì—´ì´ ì§§ì€ ê²½ìš° ìœ ì¶”ê°€ ê°€ëŠ¥ í•  ìˆ˜ ìˆìœ¼ë©° ì•”í˜¸í™”ëœ íŒ¨ìŠ¤ì›Œë“œ í•´ì‹œê°’ì„ ë¬´ì‘ìœ„ ëŒ€ì…ê³µê²©, ì‚¬ì „ëŒ€ì… ê³µê²© ë“±ìœ¼ë¡œ ë‹¨ì‹œê°„ì— íŒ¨ìŠ¤ì›Œë“œ í¬ë ‰ì´ ê°€ëŠ¥í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œ ê¸¸ì´ê°€ 8ì ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆëŠ” ê²½ìš° " >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œ ê¸¸ì´ê°€ 8ì ë¯¸ë§Œìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-46 ì ê²€ ê²°ê³¼" >> $result
u46_Account_Management=0
u46_safe_check=0
u46=0
echo "U-02 íŒ¨ìŠ¤ì›Œë“œ ë³µì¡ì„± ì„¤ì • ë¯¸í¡ ì ê²€ê³¼ í•¨ê»˜ í™•ì¸í•˜ëŠ”ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤." >> $target
if [ -f "/etc/pam.d/common-password" ];then
    u46_common_min=$(grep -v "^\s*#" "/etc/pam.d/common-password" | grep -i "min|minlen" | grep -oP 'min=\K\d+|minlen')
    if [ -n "$u46_common_min" ];then
        echo "/etc/pam.d/common-password íŒŒì¼ë‚´ì— íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œê¸¸ì´ ì˜µì…˜ê°’ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        if [ $u46_common_min -le 1 ];then
            echo "íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œê¸¸ì´  ì„¤ì •ì´ 1 ë¯¸ë§Œìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            echo "í˜„ì¬ ì„¤ì • ê°’ : $u46_common_min" >> $target
            u46_safe_check=$((u46_safe_check+1)) 
        else
            echo "íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œê¸¸ì´  ì„¤ì •ì´ 1 ì´ìƒìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
        fi
    else
        echo ""/etc/pam.d/common-password íŒŒì¼ë‚´ì— íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œê¸¸ì´ ì˜µì…˜ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."" >> $target
    fi
fi
if [ -f "/etc/security/pwquality.conf" ];then
    echo "íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œê¸¸ì´ ì„¤ì •íŒŒì¼ì¸ /etc/security/pwquality.conf íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
    u46_pwqualuty_passlen=$(grep -v "^\s*#" "/etc/security/pwquality.conf" | grep -i "minlen" | awk -F= '{print $2}' | tr -d ' ')
    if [ -n "$u46_pwqualuty_passlen" ];then
        if [ $u46_pwqualuty_passlen -lt 8 ];then
            echo "íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œ ê¸¸ì´ê°€ 8ë¯¸ë§Œìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            echo "í˜„ì¬ ì„¤ì • ê°’ : $u46_pwqualuty_passlen" >> $target
            u46_safe_check=$((u46_safe_check+1)) 
        else
            echo "íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œ ê¸¸ì´ê°€ 8ì´ìƒìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
        fi
    else
        echo "/etc/security/pwquality.conf íŒŒì¼ì€ ì¡°ì¬í•˜ì§€ë§Œ ê´€ë ¨ ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
else
    echo "íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œê¸¸ì´ ì„¤ì •íŒŒì¼ì¸ /etc/security/pwquality.conf íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi
if [ -f "/etc/login.defs" ];then
    echo "íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œê¸¸ì´ ì„¤ì •íŒŒì¼ì¸ /etc/login.defs íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤.">> $target
    u46_logindefs_passlen=$(grep -v "^\s*#" "/etc/login.defs" | grep -i "pass_min_len" | awk '{print $2}')
    if [ -n "$u46_logindefs_passlen" ];then
        if [ $u46_logindefs_passlen -lt 8 ];then
            echo "íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œ ê¸¸ì´ê°€ 8ë¯¸ë§Œìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            echo "í˜„ì¬ ì„¤ì • ê°’ : $u46_logindefs_passlen" >> $target
            u46_safe_check=$((u46_safe_check+1)) 
        else
            echo "íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œ ê¸¸ì´ê°€ 8ì´ìƒìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
        fi
    else
        echo "/etc/login.defs íŒŒì¼ì€ ì¡°ì¬í•˜ì§€ë§Œ ê´€ë ¨ ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        u46_safe_check=$((u46_safe_check+1)) 
    fi
else
    echo "íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œê¸¸ì´ ì„¤ì •íŒŒì¼ì¸ /etc/login.defs íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi
if [ $u46_safe_check -ge 1 ];then
    u46=$((u46+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u46 -ge 1 ]];then
    Mid=$((Mid+1))
    Account_Management=$((Account_Management+1))
    u46_Account_Management=1
fi
cat << EOF
===== [U-47] Setting the password maximum usage period              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-47 íŒ¨ìŠ¤ì›Œë“œ ìµœëŒ€ ì‚¬ìš©ê¸°ê°„ ì„¤ì •              " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : íŒ¨ìŠ¤ì›Œë“œ ìµœëŒ€ ì‚¬ìš© ê¸°ê°„ ì„¤ì •ì´ ì ìš©ë˜ì–´ ìˆëŠ”ì§€ ì ê²€í•˜ì—¬ ì‹œìŠ¤í…œ ì •ì±…ì—ì„œ ì‚¬ìš©ì ê³„ì •ì˜ ì¥ê¸°ê°„ íŒ¨ìŠ¤ì›Œë“œ ì‚¬ìš©ì„ ë°©ì§€í•˜ê³  ìˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : íŒ¨ìŠ¤ì›Œë“œ ìµœëŒ€ ì‚¬ìš©ê¸°ê°„ì„ ì„¤ì •í•˜ì§€ ì•Šì€ ê²½ìš° ë¹„ì¸ê°€ìì˜ ê°ì¢… ê³µê²©(ë¬´ì‘ìœ„ ëŒ€ì… ê³µê²©, ì‚¬ì „ ëŒ€ì… ê³µê²© ë“±)ì„ ì‹œë„í•  ìˆ˜ ìˆëŠ” ê¸°ê°„ ì œí•œì´ ì—†ìœ¼ë¯€ë¡œ ê³µê²©ì ì…ì¥ì—ì„œëŠ” ì¥ê¸°ì ì¸ ê³µê²©ì„ ì‹œí–‰í•  ìˆ˜ ìˆì–´ ì‹œí–‰í•œ ê¸°ê°„ì— ë¹„ë¡€í•˜ì—¬ ì‚¬ìš©ì íŒ¨ìŠ¤ì›Œë“œê°€ ìœ ì¶œë  ìˆ˜ ìˆëŠ” í™•ë¥ ì´ ì¦ê°€í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: íŒ¨ìŠ¤ì›Œë“œ ìµœëŒ€ ì‚¬ìš©ê¸°ê°„ì´ 90ì¼(12ì£¼) ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: íŒ¨ìŠ¤ì›Œë“œ ìµœëŒ€ ì‚¬ìš©ê¸°ê°„ì´ 90ì¼(12ì£¼) ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-47 ì ê²€ ê²°ê³¼" >> $result
u47_Account_Management=0
u47_safe_check=0
u47=0
if [ -f "/etc/login.defs" ];then
    echo "íŒ¨ìŠ¤ì›Œë“œ ìµœëŒ€ ì‚¬ìš©ê¸°ê°„ ì„¤ì •íŒŒì¼ì¸ /etc/login.defs íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
    u47_logindefs_maxdays=$(grep -v "^\s*#" "/etc/login.defs" | grep -i "PASS_MAX_DAYS" | awk '{print $2}')
    if [ -n "$u47_logindefs_maxdays" ];then
        if [ $u47_logindefs_maxdays -gt 90 ];then
            echo "íŒ¨ìŠ¤ì›Œë“œ ìµœëŒ€ ì‚¬ìš©ê¸°ê°„ì´ 90 ì´ìƒìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            echo "í˜„ì¬ ì„¤ì • ê°’ : $u47_logindefs_maxdays" >> $target
            u47_safe_check=$((u47_safe_check+1))
        else
            echo "íŒ¨ìŠ¤ì›Œë“œ ìµœëŒ€ ì‚¬ìš©ê¸°ê°„ì´ 90 ì´í•˜ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
        fi
    else
        echo "/etc/login.defs íŒŒì¼ì— íŒ¨ìŠ¤ì›Œë“œ ìµœëŒ€ ê¸°ê°„ ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        u47_safe_check=$((u47_safe_check+1))
    fi
else
    echo "íŒ¨ìŠ¤ì›Œë“œ ìµœëŒ€ ì‚¬ìš©ê¸°ê°„ ì„¤ì •íŒŒì¼ì¸ /etc/login.defs íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [ $u47_safe_check -ge 1 ];then
    u47=$((u47+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u47 -ge 1 ]];then
    Mid=$((Mid+1))
    Account_Management=$((Account_Management+1))
    u47_Account_Management=1
fi

cat << EOF
===== [U-48] Setting the minimum password usage period              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-48 íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œ ì‚¬ìš©ê¸°ê°„ ì„¤ì •              " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ì‚¬ìš©ìê°€ ìì£¼ íŒ¨ìŠ¤ì›Œë“œë¥¼ ë³€ê²½í•  ìˆ˜ ì—†ë„ë¡ í•˜ê³  ê´€ë ¨ ì„¤ì •(ìµœê·¼ ì•”í˜¸ ê¸°ì–µ)ê³¼ í•¨ê»˜ ì‹œìŠ¤í…œì— ì ìš©í•˜ì—¬ íŒ¨ìŠ¤ì›Œë“œ ë³€ê²½ ì „ì— ì‚¬ìš©í–ˆë˜ íŒ¨ìŠ¤ì›Œë“œë¥¼ ì¬ì‚¬ìš© í•  ìˆ˜ ì—†ë„ë¡ ë°©ì§€í•˜ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : â€» ìµœì†Œ ì‚¬ìš©ê¸°ê°„ì´ ì„¤ì •ë˜ì–´ ìˆì§€ ì•Šì•„ ë°˜ë³µì ìœ¼ë¡œ ì¦‰ì‹œ ë³€ê²½ì´ ê°€ëŠ¥í•œ ê²½ìš° ì´ì „ íŒ¨ìŠ¤ì›Œë“œ ê¸°ì–µ íšŸìˆ˜ë¥¼ ì„¤ì •í•˜ì—¬ë„ ë°˜ë³µì ìœ¼ë¡œ ì¦‰ì‹œ ë³€ê²½í•˜ì—¬ ì´ì „ íŒ¨ìŠ¤ì›Œë“œë¡œ ì„¤ì •ì´ ê°€ëŠ¥í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œ ì‚¬ìš©ê¸°ê°„ì´ 1ì¼ ì´ìƒ ì„¤ì •ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œ ì‚¬ìš©ê¸°ê°„ì´ ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-48 ì ê²€ ê²°ê³¼" >> $result
u48_Account_Management=0
u48_safe_check=0
u48=0
if [ -f "/etc/login.defs" ];then
    echo "íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œê¸¸ì´ ì„¤ì •íŒŒì¼ì¸ /etc/login.defs íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
    u48_logindefs_mindays=$(grep -v "^\s*#" "/etc/login.defs" | grep -i "PASS_MIN_DAYS" | awk '{print $2}')
    if [ -n "$u48_logindefs_mindays" ];then
        if [ $u48_logindefs_mindays -le 1 ];then
            echo "íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œ ì‚¬ìš©ê¸°ê°„ì´ 1 ë¯¸ë§Œìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            echo "í˜„ì¬ ì„¤ì • ê°’ : $u48_logindefs_mindays" >> $target
            u48_safe_check=$((u48_safe_check+1))
        else
            echo "íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œ ì‚¬ìš©ê¸°ê°„ì´ 1 ì´ìƒìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
        fi
    else
        echo "/etc/login.defs íŒŒì¼ì— íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œ ê¸°ê°„ ì„¤ì •ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        u48_safe_check=$((u48_safe_check+1))
    fi
else
    echo "íŒ¨ìŠ¤ì›Œë“œ ìµœì†Œê¸¸ì´ ì„¤ì •íŒŒì¼ì¸ /etc/login.defs íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [ $u48_safe_check -ge 1 ];then
    u48=$((u48+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u48 -ge 1 ]];then
    Mid=$((Mid+1))
    Account_Management=$((Account_Management+1))
    u48_Account_Management=1
fi

cat << EOF
===== [U-49] Remove unnecessary accounts              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-49 ë¶ˆí•„ìš”í•œ ê³„ì • ì œê±°              " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ë¶ˆí•„ìš”í•œ ê³„ì •ì´ ì¡´ì¬í•˜ëŠ”ì§€ ì ê²€í•˜ì—¬ ê´€ë¦¬ë˜ì§€ ì•Šì€ ê³„ì •ì— ì˜í•œ ì¹¨ì…ì— ëŒ€ë¹„í•˜ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ë¡œê·¸ì¸ì´ ê°€ëŠ¥í•˜ê³  í˜„ì¬ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë¶ˆí•„ìš”í•œ ê³„ì •ì€ ì‚¬ìš©ì¤‘ì¸ ê³„ì •ë³´ë‹¤ ìƒëŒ€ì ìœ¼ë¡œ ê´€ë¦¬ê°€ ì·¨ì•½í•˜ì—¬ ê³µê²©ìì˜ ëª©í‘œê°€ ë˜ì–´ ê³„ì •ì´ íƒˆì·¨ë  ìˆ˜ ìˆìŒ" >> $target
echo " â€» í‡´ì§, ì „ì§, íœ´ì§ ë“±ì˜ ì‚¬ìœ ë°œìƒì‹œ ì¦‰ì‹œ ê¶Œí•œì„ íšŒìˆ˜" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ë¶ˆí•„ìš”í•œ ê³„ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ë¶ˆí•„ìš”í•œ ê³„ì •ì´ ì¡´ì¬í•˜ëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-49 ì ê²€ ê²°ê³¼" >> $result
u49_Account_Management=0
u49_safe_check=0
u49_general_users=($(egrep -v "root|nologin|shutdown|sync|halt|false" "/etc/passwd" | awk -F: '{print $1}'))
u49=0
u49_idx=0
u49_never_loggeds=($(lastlog | grep -i 'Never logged in' | awk '{print $1}'))
u49_corrent_timestamp=$(date +%s)
u49_2weeks_check=0


u49_lastlog_dates=($(lastlog | grep -vi 'Never logged in' | awk '{for (i=3; i<=NF; i++) printf "%s%s", $i, (i < NF ? OFS : "\n")}'  | sed '1d'))
u49_lastlog_timestamps=()

for u49_date_str in "${u49_lastlog_dates[@]}"; do
    u49_timestamp=$(date -d "$u49_date_str" +%s 2>/dev/null)
    if [ $? -eq 0 ]; then
        u49_lastlog_timestamps+=("$u49_timestamp")
    fi
done

u49_lastlog_users=($(lastlog | grep -vi 'Never logged in' | awk 'NR>1 {print $1}'))
u49_two_weeks_seconds=$((14 * 24 * 60 * 60))

if [ -n "$u49_general_users" ];then
    echo "root ì œì™¸í•œ ì‹œìŠ¤í…œ ì‚¬ìš©ì ëª©ë¡ì…ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê³„ì •ì´ ì¡´ì¬í•  ê²½ìš° ì‚­ì œì¡°ì¹˜ ë°”ëë‹ˆë‹¤." >> $target
    for u49_general_user in "${u49_general_users[@]}";do
        echo "$u49_general_user" >> $target
    done
else
    echo "root ì œì™¸í•œ ì‹œìŠ¤í…œ ì‚¬ìš©ì ëª©ë¡ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi


if [ -n "$u49_never_loggeds" ];then
    echo "ê³„ì • ìƒì„± í›„ ì‹œìŠ¤í…œì— ë¡œê·¸ì¸í•œ ì  ì—†ëŠ” ê³„ì •ë“¤ì…ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ì¡°ì¹˜ ë°”ëë‹ˆë‹¤." >> $target
    u49_safe_check=$((u49_safe_check+1))
    for u49_never_logged in "${u49_never_loggeds[@]}";do
        echo "ê³„ì • ëª… : $u49_never_logged" >> $target
    done
else
    echo "ì‹œìŠ¤í…œì— ë¡œê·¸ì¸í•œ ì  ì—†ëŠ” ê³„ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [ ${#u49_general_users[@]} -gt 0 ];then
    echo "ì‹œìŠ¤í…œì— 2ì£¼ ì´ìƒ ë¡œê·¸ì¸(ì ‘ê·¼) ê¸°ë¡ì´ ì—†ëŠ” ê³„ì • ëª©ë¡ì…ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê²½ìš° ì‚­ì œ ì¡°ì¹˜ ë°”ëë‹ˆë‹¤." >> $target
    u49_safe_check=$((u49_safe_check+1))
    for u49_lastlog_user in "${u49_lastlog_users[@]}";do
        if (( u49_lastlog_timestamps[u49_idx] <= u49_corrent_timestamp - u49_two_weeks_seconds )); then
            echo "$u49_lastlog_user" >> $target
        else
            u49_2weeks_check=$((u49_2weeks_check+1))
        fi
        u49_idx=$((u49_idx+1))
    done
    if [ $u49_2weeks_check -ge 1 ];then
        echo "ì‹œìŠ¤í…œì— 2ì£¼ ì´ìƒ ë¡œê·¸ì¸(ì ‘ê·¼) ê¸°ë¡ì´ ì—†ëŠ” ê³„ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
fi

if [ $u49_safe_check -ge 1 ];then
    u49=$((u49+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u49 -ge 1 ]];then
    Low=$((Low+1))
    Account_Management=$((Account_Management+1))
    u49_Account_Management=1
fi

cat << EOF
===== [U-50] Include minimal accounts in administrator groups              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-50 ê´€ë¦¬ì ê·¸ë£¹ì— ìµœì†Œí•œì˜ ê³„ì • í¬í•¨              " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ê´€ë¦¬ì ê·¸ë£¹ì— ìµœì†Œí•œì˜ ê³„ì •ë§Œ ì¡´ì¬í•˜ëŠ”ì§€ ì ê²€í•˜ì—¬ ë¶ˆí•„ìš”í•˜ê²Œ ê¶Œí•œì´ ë‚¨ìš©ë˜ê³  ìˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ì‹œìŠ¤í…œì„ ê´€ë¦¬í•˜ëŠ” root ê³„ì •ì´ ì†í•œ ê·¸ë£¹ì€ ì‹œìŠ¤í…œ ìš´ì˜ íŒŒì¼ì— ëŒ€í•œ ì ‘ê·¼ ê¶Œí•œì´ ë¶€ì—¬ë˜ì–´ ìˆìœ¼ë¯€ë¡œ í•´ë‹¹ ê´€ë¦¬ì ê·¸ë£¹ì— ì†í•œ ê³„ì •ì´ ë¹„ì¸ê°€ìì—ê²Œ ìœ ì¶œë  ê²½ìš° ê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ ì‹œìŠ¤í…œì— ì ‘ê·¼í•˜ì—¬ ê³„ì • ì •ë³´ ìœ ì¶œ, í™˜ê²½ì„¤ì • íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ ë³€ì¡° ë“±ì˜ ìœ„í˜‘ì´ ì¡´ì¬í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ê´€ë¦¬ì ê·¸ë£¹ì— ë¶ˆí•„ìš”í•œ ê³„ì •ì´ ë“±ë¡ë˜ì–´ ìˆì§€ ì•Šì€ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ê´€ë¦¬ì ê·¸ë£¹ì— ë¶ˆí•„ìš”í•œ ê³„ì •ì´ ë“±ë¡ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-50 ì ê²€ ê²°ê³¼" >> $result
u50_Account_Management=0
u50_safe_check=0
u50=0
u50_rootgroup=$(cat /etc/group | grep root | awk -F: '{print $4}')

if [ -n "$u50_rootgroup" ];then
    echo "root ê³„ì •ì˜ ê·¸ë£¹ì— í¬í•¨ëœ ê³„ì •ì…ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê³„ì •ì´ ì¡´ì¬í•  ê²½ìš° ì œê±° ì¡°ì¹˜ ë°”ëë‹ˆë‹¤." >> $target
    echo "$u50_rootgroup" >> $target
    u50_safe_check=$((u50_safe_check+1))
else
    echo "root ê³„ì •ì˜ ê·¸ë£¹ì— í¬í•¨ëœ ê³„ì •ë“¤ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [ $u50_safe_check -ge 1 ];then
    u50=$((u50+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u50 -ge 1 ]];then
    Low=$((Low+1))
    Account_Management=$((Account_Management+1))
    u50_Account_Management=1
fi 

cat << EOF
===== [U-51] Prohibiting GIDs whose accounts do not exist              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-51 ê³„ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” GID ê¸ˆì§€              " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ì‹œìŠ¤í…œì— ë¶ˆí•„ìš”í•œ ê·¸ë£¹ì´ ì¡´ì¬í•˜ëŠ”ì§€ ì ê²€í•˜ì—¬ ë¶ˆí•„ìš”í•œ ê·¸ë£¹ì˜ ì†Œìœ ê¶Œìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆëŠ” íŒŒì¼ì˜ ë…¸ì¶œì— ì˜í•´ ë°œìƒí•  ìˆ˜ ìˆëŠ” ìœ„í—˜ì— ëŒ€í•œ ëŒ€ë¹„ê°€ ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ê³„ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê·¸ë£¹ì€ í˜„ì¬ ì‚¬ìš©ë˜ê³  ìˆëŠ” ê·¸ë£¹ì´ ì•„ë‹Œ ë¶ˆí•„ìš”í•œ ê·¸ë£¹ìœ¼ë¡œ ì‚­ì œ ì¡°ì¹˜ê°€ í•„ìš”í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ì‹œìŠ¤í…œ ê´€ë¦¬ë‚˜ ìš´ìš©ì— ë¶ˆí•„ìš”í•œ ê·¸ë£¹ì´ ì‚­ì œ ë˜ì–´ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ì‹œìŠ¤í…œ ê´€ë¦¬ë‚˜ ìš´ìš©ì— ë¶ˆí•„ìš”í•œ ê·¸ë£¹ì´ ì¡´ì¬í•  ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-51 ì ê²€ ê²°ê³¼" >> $result
u51_Account_Management=0
u51_safe_check=0
u51=0
# /etc/passwd íŒŒì¼ì—ì„œ GID ëª©ë¡ ì¶”ì¶œ
u51_gid_list=$(cut -d: -f4 /etc/passwd | sort -u)

echo "ê³„ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê·¸ë£¹ì´ ì¡´ì¬í•  ê²½ìš° ì•„ë˜ì— ì¶œë ¥ë©ë‹ˆë‹¤." >> $target  

# GID ëª©ë¡ì„ ìˆœíšŒí•˜ë©´ì„œ /etc/groupì— ì—†ëŠ” GID ì°¾ê¸° 
for u51_gid in $u51_gid_list; do
    if ! grep -q ":$u51_gid:" /etc/group; then
        echo "GID $u51_gid ëŠ” /etc/groupì— ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        u51_safe_check=$((u51_safe_check+1))
    fi
done

# /etc/group íŒŒì¼ì„ ìˆœíšŒí•˜ë©´ì„œ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì‚¬ìš©ì ì°¾ê¸°
echo "ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì‚¬ìš©ì ëª©ë¡ì´ ì¡´ì¬í•  ê²½ìš° ì•„ë˜ì— ì¶œë ¥ë©ë‹ˆë‹¤." >> $target
u51_count=0
while IFS=: read -r u51_group_name _ _ u51_group_users; do
    IFS=',' read -ra u51_users <<< "$u51_group_users"
    for u51_user in "${u51_users[@]}"; do
        if [[ -n "$u51_user" ]] && ! grep -q "^$u51_user:" /etc/passwd; then
            echo "ê·¸ë£¹ $u51_group_name ì— ì†í•œ ì‚¬ìš©ì $u51_user ëŠ” /etc/passwdì— ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
            u51_safe_check=$((u51_safe_check+1))
        else
            u51_count=$((u51_count+1))
        fi
    done
done < /etc/group

if [[ $u51_count -ge 1 ]];then
    echo "ê°ê°ì˜ ê·¸ë£¹ ë‚´ì— ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì‚¬ìš©ìëŠ” ì—†ìŠµë‹ˆë‹¤." >> $target
fi

if [ $u51_safe_check -ge 1 ];then
    u51=$((u51+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u51 -ge 1 ]];then
    Low=$((Low+1))
    Account_Management=$((Account_Management+1))
    u51_Account_Management=1
fi

cat << EOF
===== [U-52] Do not allow the same UID              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-52 ë™ì¼í•œ UID ê¸ˆì§€              " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : UIDê°€ ë™ì¼í•œ ì‚¬ìš©ì ê³„ì •ì„ ì ê²€í•¨ìœ¼ë¡œì¨ íƒ€ ì‚¬ìš©ì ê³„ì • ì†Œìœ ì˜ íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ë¡œì˜ ì•…ì˜ì  ì ‘ê·¼ ì˜ˆë°© ë° ì¹¨í•´ì‚¬ê³  ì‹œ ëª…í™•í•œ ê°ì‚¬ì¶”ì ì„ ëª©ì ìœ¼ë¡œ í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ì¤‘ë³µëœ UIDê°€ ì¡´ì¬í•  ê²½ìš° ì‹œìŠ¤í…œì€ ë™ì¼í•œ ì‚¬ìš©ìë¡œ ì¸ì‹í•˜ì—¬ ì†Œìœ ìì˜ ê¶Œí•œì´ ì¤‘ë³µë˜ì–´ ë¶ˆí•„ìš”í•œ ê¶Œí•œì´ ë¶€ì—¬ë˜ë©° ì‹œìŠ¤í…œ ë¡œê·¸ë¥¼ ì´ìš©í•œ ê°ì‚¬ ì¶”ì ì‹œ ì‚¬ìš©ìê°€ êµ¬ë¶„ë˜ì§€ ì•ŠìŒ (ê¶Œí•œ í• ë‹¹ì€ ê·¸ë£¹ê¶Œí•œì„ ì´ìš©í•˜ì—¬ ìš´ì˜)" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ë™ì¼í•œ UIDë¡œ ì„¤ì •ëœ ì‚¬ìš©ì ê³„ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ë™ì¼í•œ UIDë¡œ ì„¤ì •ëœ ì‚¬ìš©ì ê³„ì •ì´ ì¡´ì¬í•˜ëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-52 ì ê²€ ê²°ê³¼" >> $result
u52_Account_Management=0
u52_safe_check=0
u52=0
u52_user_uid=$(awk -F: '{print $3}' "/etc/passwd" 2> /dev/null)
u52_uniq_uids=$(awk -F: '{print $3}' "/etc/passwd" 2> /dev/null | sort | uniq -d | paste -sd '|')
u52_uniq_users=$(awk -F: '{print $1, $3}' /etc/passwd 2> /dev/null | egrep -iw "$u52_uniq_uids" | sort -r)
readarray -t u52_lines <<< "$u52_uniq_users"


if [ -n "$u52_uniq_uids" ];then
    echo "ë™ì¼í•œ UIDë¥¼ ê°€ì§„ ê³„ì •ë“¤ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
    for i in "${u52_lines[@]}";do
        echo "$i" >> $target >> $target
        u52_safe_check=$((u52_safe_check+1))
    done
else
    echo "ë™ì¼í•œ UIDë¥¼ ê°€ì§„ ê³„ì •ë“¤ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [ $u52_safe_check -ge 1 ];then
    u52=$((u52+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u52 -ge 1 ]];then
    Mid=$((Mid+1))
    Account_Management=$((Account_Management+1))
    u52_Account_Management=1
fi

cat << EOF
===== [U-53] Check user shell              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-53 ì‚¬ìš©ì shell ì ê²€              " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ë¡œê·¸ì¸ì´ ë¶ˆí•„ìš”í•œ ê³„ì •ì— ì‰˜ ì„¤ì •ì„ ì œê±°í•˜ì—¬, ë¡œê·¸ì¸ì´ í•„ìš”í•˜ì§€ ì•Šì€ ê³„ì •ì„ í†µí•œ ì‹œìŠ¤í…œ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì§€ ëª»í•˜ê²Œ í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ë¡œê·¸ì¸ì´ ë¶ˆí•„ìš”í•œ ê³„ì •ì€ ì¼ë°˜ì ìœ¼ë¡œ OS ì„¤ì¹˜ ì‹œ ê¸°ë³¸ì ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ê³„ì •ìœ¼ë¡œ ì‰˜ì´ ì„¤ì •ë˜ì–´ ìˆì„ ê²½ìš°, ê³µê²©ìëŠ” ê¸°ë³¸ ê³„ì •ë“¤ì„ ì´ìš©í•˜ì—¬ ì‹œìŠ¤í…œì— ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰ í•  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ë¡œê·¸ì¸ì´ í•„ìš”í•˜ì§€ ì•Šì€ ê³„ì •ì— /bin/false(/sbin/nologin) ì‰˜ì´ ë¶€ì—¬ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ë¡œê·¸ì¸ì´ í•„ìš”í•˜ì§€ ì•Šì€ ê³„ì •ì— /bin/false(/sbin/nologin) ì‰˜ì´ ë¶€ì—¬ë˜ì§€ ì•Šì€ ê²½ìš°" >> $target
echo "+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++w+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-53 ì ê²€ ê²°ê³¼" >> $result
u53_Account_Management=0
u53_safe_check=0
u53=0

u53_passwd_lists=$(sudo awk -F: '($3 <= 999 || $3 >= 60000) && $1 != "root" {
    split($7, u53_path, "/");
    u53_shell = u53_path[length(u53_path)];
    if (u53_shell != "nologin" && u53_shell != "false" && u53_shell != "sync" && u53_shell != "shutdown" && u53_shell != "halt") {
        print $1, $7;
    }
}' /etc/passwd
)
u53_shadow_lists=$(awk -F: '($2 == "*" || $2 == "!!") {print $1}' /etc/shadow)

if [ -n "$u53_passwd_lists" ];then
    echo "ì¼ë°˜ ì‚¬ìš©ìê°€ ì•„ë‹Œ ê³„ì •ì— ëŒ€í•´ Shellì´ ë¶€ì—¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
    u53_safe_check=$((u53_safe_check+1))
    for u53_passwd_list in "${u53_passwd_lists[@]}";do
        echo "$u53_passwd_list" >> $target
    done
fi

readarray -t u53_user_list <<< "$u53_shadow_lists"
u53_result=""
u53_check='for u53_user in "${u53_user_list[@]}"; do
    u53_result+=$(awk -F: -v u53_user="$u53_user" '\''($1 == u53_user) {
        split($7, u53_path, "/");
        shell = u53_path[length(u53_path)];
        if (shell != "nologin" && shell != "false" && shell != "sync" && shell != "shutdown" && shell != "halt") {
            print $1, $7;
        }
    }'\'' /etc/passwd)
done'

if [[ ${#u53_user_list[@]} -gt 0 ]]; then
    eval "$u53_check"
    if [[ -n "$u53_result" ]]; then
        echo "íŒ¨ìŠ¤ì›Œë“œë¥¼ í•„ìš”ë¡œ í•˜ì§€ ì•ŠëŠ”, ê²©ë¦¬ëœ ê³„ì •ì— ëŒ€í•´ ì‰˜ì´ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
        u53_safe_check=$((u53_safe_check+1))
        echo "$u53_result" >> $target
    else
        echo "/etc/shadow íŒŒì¼ì—ì„œ ê²©ë¦¬ëœ ê³„ì •ì— ëŒ€í•´ ì „ë¶€ ì‰˜ì´ ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
else
    echo "'*' í˜¹ì€ '!!' ìœ¼ë¡œ ì„¤ì •ëœ ê³„ì •ì´ /etc/shadow íŒŒì¼ì— ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [ $u53_safe_check -ge 1 ];then
    u53=$((u53+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u53 -ge 1 ]];then
    Low=$((Low+1))
    Account_Management=$((Account_Management+1))
    u53_Account_Management=1
fi

cat << EOF
===== [U-54] Session timeout setting              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-54 Session Timeout ì„¤ì •             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ì‚¬ìš©ìì˜ ê³ ì˜ ë˜ëŠ” ì‹¤ìˆ˜ë¡œ ì‹œìŠ¤í…œì— ê³„ì •ì´ ì ‘ì†ëœ ìƒíƒœë¡œ ë°©ì¹˜ë¨ì„ ì°¨ë‹¨í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : Session timeout ê°’ì´ ì„¤ì •ë˜ì§€ ì•Šì€ ê²½ìš° ìœ íœ´ ì‹œê°„ ë‚´ ë¹„ì¸ê°€ìì˜ ì‹œìŠ¤í…œ ì ‘ê·¼ìœ¼ë¡œ ì¸í•´ ë¶ˆí•„ìš”í•œ ë‚´ë¶€ ì •ë³´ì˜ ë…¸ì¶œ ìœ„í—˜ì´ ì¡´ì¬í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: Session Timeoutì´ 600ì´ˆ(10ë¶„) ì´í•˜ë¡œ ì„¤ì •ë˜eì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: Session Timeoutì´ 600ì´ˆ(10ë¶„) ì´í•˜ë¡œ ì„¤ì •ë˜ì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-54 ì ê²€ ê²°ê³¼" >> $result
u54_Account_Management=0
u54_safe_check=0
u54=0
u54_files=("/etc/bash.bashrc" "/etc/zsh/zshrc" "/etc/ksh.kshrc" "/etc/profile" "/etc/.profile")
u54_individual_files=(".bashrc" ".zshrc" ".kshrc" ".bash_profile")
u54_dirs=("/etc/profile.d/*.sh" "/etc/profile.d/*.csh" "/etc/profil.d/*.ksh")
u54_csh_files=("/etc/csh.cshrc" "/etc/csh.login")
u54_csh_individual_files=(".cshrc" ".login")
u54_check_users=($(awk -F':' '!/sbin|sync|false/ {print $1}' /etc/passwd))

for u54_check_dir in ${u54_dirs[@]}; do
    for u54_dir in $u54_check_dir; do
        if [ -e "$u54_dir" ]; then
            echo "$u54_dir íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
            u54_dir_tmoutsh=$(grep -Ev "^\s*#" "$u54_dir" | grep -Ei "^\s*TMOUT" | tr -d ' ' | awk -F'=' '{print $2}')
            if [ -n "$u54_dir_tmoutsh" ]; then
                echo "$u54_dir íŒŒì¼ì— ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • ê°’ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
                if [ "$u54_dir_tmoutsh" -le 600 ]; then
                    echo "ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • ê°’ì´ 600ì´í•˜ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    echo "í˜„ì¬ ì„¤ì • ê°’ : $u54_dir_tmoutsh" >> $target
                else   
                    echo "ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • ê°’ì´ 600ì´ìƒìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    echo "í˜„ì¬ ì„¤ì • ê°’ : $u54_dir_tmoutsh" >> $target
                    u54_safe_check=$((u54_safe_check+1))
                fi
            else
                echo "$u54_dir íŒŒì¼ì— ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                u54_safe_check=$((u54_safe_check+1))
            fi
        fi
    done
done

for u54_file in "${u54_files[@]}"; do
    if [ -e "$u54_file" ]; then
        echo "$u54_file íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        u54_file_tmout=$(grep -Ev "^\s*#" "$u54_file" | grep -Ei "^\s*TMOUT" | tr -d ' ' | awk -F'=' '{print $2}')
        if [ -n "$u54_file_tmout" ]; then
            echo "$u54_file íŒŒì¼ì— ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • ê°’ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
            if [ "$u54_file_tmout" -le 600 ]; then
                echo "ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • ê°’ì´ 600ì´í•˜ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                echo "í˜„ì¬ ì„¤ì • ê°’ : $u54_file_tmout" >> $target
            else   
                echo "ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • ê°’ì´ 600ì´ìƒìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                echo "í˜„ì¬ ì„¤ì • ê°’ : $u54_file_tmout" >> $target
                u54_safe_check=$((u54_safe_check+1))
            fi
        else
            echo "$u54_file íŒŒì¼ì— ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
            u54_safe_check=$((u54_safe_check+1))
        fi
    fi
done

for u54_csh_file in "${u54_csh_files[@]}"; do
    if [ -e "$u54_csh_file" ]; then
        echo "$u54_csh_file íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        u54_cshfile_tmout=$(grep -Ev "^\s*#" "$u54_csh_file" | grep -Ei "^\s*set\s*autologout" | tr -d ' ' | awk -F'=' '{print $2}')
        if [ -n "$u54_cshfile_tmout" ]; then
            echo "$u54_csh_file íŒŒì¼ì— ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • ê°’ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
            if [ "$u54_cshfile_tmout" -le 10 ]; then
                echo "ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • ê°’ì´ 10ì´í•˜ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                echo "í˜„ì¬ ì„¤ì • ê°’ : $u54_cshfile_tmout" >> $target
            else   
                echo "ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • ê°’ì´ 10ì´ìƒìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                echo "í˜„ì¬ ì„¤ì • ê°’ : $u54_cshfile_tmout" >> $target
                u54_safe_check=$((u54_safe_check+1))
            fi
        else
            echo "$u54_csh_file íŒŒì¼ì— ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
            u54_safe_check=$((u54_safe_check+1))
        fi
    fi
done

for u54_check_user in "${u54_check_users[@]}"; do
    u54_user_home=$(getent passwd "$u54_check_user" | awk -F':' '{print $6}')
    if [ -d "$u54_user_home" ]; then
        echo "--------------------------------------"  >> $target
        echo "$u54_check_user ì˜ í™ˆ ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        for u54_individual_file in "${u54_individual_files[@]}"; do
            echo -e "Checking file: $u54_user_home/$u54_individual_file"  >> $target
            if [ -e "$u54_user_home/$u54_individual_file" ]; then
                echo "$u54_user_home/$u54_individual_file íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤."  >> $target
                u54_check_timeout=$(grep -Ev "^\s*#" "$u54_user_home/$u54_individual_file" | grep -Ei "^\s*TMOUT" | tr -d ' ' | awk -F'=' '{print $2}')
                if [ -n "$u54_check_timeout" ]; then
                    echo "$u54_user_home/$u54_individual_file íŒŒì¼ì— ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • ê°’ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
                    if [ "$u54_check_timeout" -le 600 ]; then
                        echo "ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • ê°’ì´ 600ì´í•˜ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        echo "í˜„ì¬ ì„¤ì • ê°’ : $u54_check_timeout" >> $target
                    else   
                        echo "ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • ê°’ì´ 600ì´ìƒìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        echo "í˜„ì¬ ì„¤ì • ê°’ : $u54_check_timeout" >> $target
                        u54_safe_check=$((u54_safe_check+1))
                    fi
                else
                    echo "$u54_user_home/$u54_individual_file íŒŒì¼ì— ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    u54_safe_check=$((u54_safe_check+1))
                fi
            else
                echo "$u54_user_home/$u54_individual_file íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
            fi
        done
        for u54_csh_individual_file in "${u54_csh_individual_files[@]}"; do
            echo -e "Checking file: $u54_user_home/$u54_csh_individual_file"  >> $target
            if [ -e "$u54_user_home/$u54_csh_individual_file" ]; then
                echo "$u54_user_home/$u54_csh_individual_file íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤."  >> $target
                u54_check_timeout=$(grep -Ev "^\s*#" "$u54_user_home/$u54_csh_individual_file" | grep -Ei "^\s*set\s*autologout" | tr -d ' ' | awk -F'=' '{print $2}')
                if [ -n "$u54_check_timeout" ]; then
                    echo "$u54_user_home/$u54_csh_individual_file íŒŒì¼ì— ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • ê°’ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
                    if [ "$u54_check_timeout" -le 10 ]; then
                        echo "ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • ê°’ì´ 10ì´í•˜ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        echo "í˜„ì¬ ì„¤ì • ê°’ : $u54_check_timeout" >> $target
                    else   
                        echo "ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • ê°’ì´ 10ì´ìƒìœ¼ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        echo "í˜„ì¬ ì„¤ì • ê°’ : $u54_check_timeout" >> $target
                        u54_safe_check=$((u54_safe_check+1))
                    fi
                else
                    echo "$u54_user_home/$u54_csh_individual_file íŒŒì¼ì— ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    u54_safe_check=$((u54_safe_check+1))
                fi
            else
                echo "$u54_user_home/$u54_csh_individual_file íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
            fi
        done
    else
        echo "$u54_check_user ì˜ í™ˆ ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
done

if [ $u54_safe_check -ge 1 ];then
    u54=$((u54+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u54 -ge 1 ]];then
    Low=$((Low+1))
    Account_Management=$((Account_Management+1))
    u54_Account_Management=1
fi

cat << EOF
===== [U-55] hosts.lpd file owner and permission settings              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-55 hosts.lpd íŒŒì¼ ì†Œìœ ì ë° ê¶Œí•œ ì„¤ì •             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ë¹„ì¸ê°€ìì˜ ì„ì˜ì ì¸ hosts.lpd ë³€ì¡°ë¥¼ ë§‰ê¸° ìœ„í•´ hosts.lpd íŒŒì¼ ì‚­ì œ ë˜ëŠ” ì†Œìœ ì ë° ê¶Œí•œ ê´€ë¦¬ë¥¼ í•´ì•¼ í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : hosts.lpd íŒŒì¼ì˜ ì ‘ê·¼ê¶Œí•œì´ ì ì ˆí•˜ì§€ ì•Šì„ ê²½ìš° ë¹„ì¸ê°€ìê°€ /etc/hosts.lpd íŒŒì¼ì„ ìˆ˜ì •í•˜ì—¬ í—ˆìš©ëœ ì‚¬ìš©ìì˜ ì„œë¹„ìŠ¤ë¥¼ ë°©í•´í•  ìˆ˜ ìˆìœ¼ë©°, í˜¸ìŠ¤íŠ¸ ì •ë³´ë¥¼ íšë“ í•  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: hosts.lpd íŒŒì¼ì´ ì‚­ì œë˜ì–´ ìˆê±°ë‚˜ ë¶ˆê°€í”¼í•˜ê²Œ hosts.lpd íŒŒì¼ì„ ì‚¬ìš©í•  ì‹œ íŒŒì¼ì˜ ì†Œìœ ìê°€ rootì´ê³  ê¶Œí•œì´ 600ì¸ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: hosts.lpd íŒŒì¼ì´ ì‚­ì œë˜ì–´ ìˆì§€ ì•Šê±°ë‚˜ íŒŒì¼ì˜ ì†Œìœ ìê°€ rootê°€ ì•„ë‹ˆê³  ê¶Œí•œì´ 600ì´ ì•„ë‹Œ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-55 ì ê²€ ê²°ê³¼" >> $result
u55=0 
u55_Files_Directory_Management=0
u55_safe_check=0
if [[ -e "/etc/hosts.lpd" ]];then
    echo "/etc/hosts.lpd íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
    u55_hostsfile_owner=$(stat -c "%U" "/etc/hosts.lpd")
    u55_hostsfile_perm=$(stat -c "%a" "/etc/hosts.lpd")
    if [[ $shadowfile_owner == "root" ]];then
        if [[ $shadowfile_perm -eq 600 ]];then
            echo "/etc/hosts.lpd íŒŒì¼ ì†Œìœ ìê°€ root ì´ë©°, ê¶Œí•œì´ 600 ìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            echo "í˜„ì¬ ì„¤ì • ê°’ : $shadowfile_perm" >> $target
        else
            echo "/etc/hosts.lpd íŒŒì¼ ê¶Œí•œì´ 600ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ì·¨ì•½í•©ë‹ˆë‹¤. " >> $target
            echo "í˜„ì¬ ì„¤ì • ê°’ : $shadowfile_perm" >> $target
            u55_safe_check=$((u55_safe_check+1))
        fi
    else
        echo "/etc/hosts.lpd íŒŒì¼ ì†Œìœ ìê°€ root ì‚¬ìš©ìê°€ ì•„ë‹ˆë¯€ë¡œ ì·¨ì•½í•©ë‹ˆë‹¤."  >> $target
        echo "í˜„ì¬ ì„¤ì • ê°’ : $shadowfile_owner" >> $target
        u55_safe_check=$((u55_safe_check+1))
    fi
else
    echo "/etc/hosts.lpd íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [[ $u55_safe_check -ge 1 ]];then
    u55=$((u55+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u55 -ge 1 ]];then
    Low=$((Low+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u55_Files_Directory_Management=1
fi

cat << EOF
===== [U-56] Managing UMASK Settings              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-56  UMASK ì„¤ì • ê´€ë¦¬             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ì˜ëª» ì„¤ì •ëœ UMASK ê°’ìœ¼ë¡œ ì¸í•´ ì‹ ê·œ íŒŒì¼ì— ëŒ€í•œ ê³¼ë„í•œ ê¶Œí•œ ë¶€ì—¬ë˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ì˜ëª»ëœ UMASK ê°’ìœ¼ë¡œ ì¸í•´ íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ ìƒì„±ì‹œ ê³¼ë„í•˜ê²Œ í¼ë¯¸ì…˜ì´ ë¶€ì—¬ ë  ìˆ˜ ìˆë‹¤." >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: UMASK ê°’ì´ 022 ì´ìƒìœ¼ë¡œ ì„¤ì •ëœ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: UMASK ê°’ì´ 022 ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-56 ì ê²€ ê²°ê³¼" >> $result
u56_Files_Directory_Management=0
u56_safe_check=0
u56=0
u56_files=("/etc/bash.bashrc" "/etc/zsh/zshrc" "/etc/ksh.kshrc" "/etc/profile" "/etc/.profile" "/etc/login.defs" "/etc/default/useradd" "/etc/default/login" "/etc/.login")
u56_individual_files=(".bashrc" ".zshrc" ".kshrc" ".bash_profile" ".cshrc" ".login" )
u56_dirs=("/etc/profile.d/*.sh" "/etc/profile.d/*.csh" "/etc/profile.d/*.ksh")
u56_csh_files=("/etc/csh.cshrc" "/etc/csh.login")

u56_check_users=($(awk -F':' '!/sbin|sync|false/ {print $1}' /etc/passwd))

u56_to_decimal() {
    printf "%d\n" "$((8#$1))"
}
u56_umask=$(u56_to_decimal 022)
for u56_check_dir in ${u56_dirs[@]}; do
    for u56_dir in $u56_check_dir; do
        if [ -e "$u56_dir" ]; then
            echo "$u56_dir íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
            IFS=$'\n' u56_dir_umasksh=($(grep -Ev "^\s*#" "$u56_dir" | grep -Ei "^\s*umask" | awk '{print $2}'))
            if [ -n "$u56_dir_umasksh" ]; then
                echo "$u56_dir umask ì„¤ì • ê°’ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
                for u56_dir_umask in "${u56_dir_umasksh[@]}";do
                    u56_dec_dir=$(u56_to_decimal $u56_dir_umasksh)
                    if [ $u56_dec_dir -ge $u56_umask ]; then
                        echo "umask ì„¤ì • ê°’ì´ 022ì´ìƒìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        echo "í˜„ì¬ ì„¤ì • ê°’ : $u56_dir_umask" >> $target
                    else   
                        echo "umask ì„¤ì • ê°’ì´ 022ì´í•˜ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        echo "í˜„ì¬ ì„¤ì • ê°’ : $u56_dir_umask" >> $target
                        u56_safe_check=$((u56_safe_check+1))
                    fi
                done
            else
                echo "$u56_dir íŒŒì¼ì— umask ì„¤ì • ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                u56_safe_check=$((u56_safe_check+1))
            fi
        fi
    done
done

for u56_file in "${u56_files[@]}"; do
    if [ -e "$u56_file" ]; then
        echo "$u56_file íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        u56_file_umask=($(grep -Ev "^\s*#" "$u56_file" | grep -Ei "^\s*umask" | awk '{print $2}'))
        if [ -n "$u56_file_umask" ]; then
            echo "$u56_file umask ì„¤ì • ê°’ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
            for u56_umask_value in "${u56_file_umask[@]}"; do
                u56_dec_file=$(u56_to_decimal "$u56_umask_value")    
                if [ "$u56_dec_file" -ge "$u56_umask" ]; then
                    echo "umask ì„¤ì • ê°’ì´ 022ì´ìƒìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    echo "í˜„ì¬ ì„¤ì • ê°’ : $u56_umask_value" >> $target
                else   
                    echo "umask ì„¤ì • ê°’ì´ 022ì´í•˜ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    echo "í˜„ì¬ ì„¤ì • ê°’ : $u56_umask_value" >> $target
                    u56_safe_check=$((u56_safe_check+1))
                fi
            done    
        else
            echo "$u56_file íŒŒì¼ì— umask ì„¤ì • ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
            u56_safe_check=$((u56_safe_check+1))
        fi
    fi
done

for u56_csh_file in "${u56_csh_files[@]}"; do
    if [ -e "$u56_csh_file" ]; then
        echo "$u56_csh_file íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        u56_cshfile_umask=($(grep -Ev "^\s*#" "$u56_csh_file" | grep -Ei "^\s*umask" | awk '{print $2}'))
        if [ -n "$u56_cshfile_umask" ]; then
            echo "$u56_csh_file umask ì„¤ì • ê°’ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
            for u56_csh_umask in "${u56_cshfile_umask[@]}";do
                u56_dec_cshfile=$(u56_to_decimal $u56_csh_umask)
                if [ $u56_dec_cshfile -ge $u56_umask ]; then
                    echo "umask ì„¤ì • ê°’ì´ 022ì´ìƒìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    echo "í˜„ì¬ ì„¤ì • ê°’ : $u56_csh_umask" >> $target
                else   
                    echo "umask ì„¤ì • ê°’ì´ 022ì´í•˜ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    echo "í˜„ì¬ ì„¤ì • ê°’ : $u56_csh_umask" >> $target
                    u56_safe_check=$((u56_safe_check+1))
                fi
            done
        else
            echo "$u56_csh_file íŒŒì¼ì— umask ì„¤ì • ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
            u56_safe_check=$((u56_safe_check+1))
        fi
    fi
done

for u56_check_user in "${u56_check_users[@]}"; do
    u56_user_home=$(getent passwd "$u56_check_user" | awk -F':' '{print $6}')w
    if [ -d "$u56_user_home" ]; then
        echo "--------------------------------------"  >> $target
        echo "$u56_check_user ì˜ í™ˆ ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        for u56_individual_file in "${u56_individual_files[@]}"; do
            echo -e "Checking file: $u56_user_home/$u56_individual_file"  >> $target
            if [ -e "$u56_user_home/$u56_individual_file" ]; then
                echo "$u56_user_home/$u56_individual_file íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤."  >> $target
                u56_check_umask=($(grep -Ev "^\s*#" "$u56_user_home/$u56_individual_file" | grep -Ei "^\s*umask" | awk '{print $2}'))
                if [ -n "$u56_check_umask" ]; then
                    echo "$u56_user_home/$u56_individual_file íŒŒì¼ì— umask ì„¤ì • ê°’ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
                    for u56_individual_umask in "${u56_check_umask[@]}";do
                    u56_dec_userumask=$(u56_to_decimal $u56_individual_umask)
                    if [ $u56_dec_userumask -ge $u56_umask ]; then
                        echo "umask ì„¤ì • ê°’ì´ 022ì´ìƒìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        echo "í˜„ì¬ ì„¤ì • ê°’ : $u56_individual_umask" >> $target
                    else   
                        echo "umask ì„¤ì • ê°’ì´ 022ì´í•˜ë¡œ ë¶€ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        echo "í˜„ì¬ ì„¤ì • ê°’ : $u56_individual_umask" >> $target
                        u56_safe_check=$((u56_safe_check+1))
                    fi
                    done
                else
                    echo "$u56_user_home/$u56_individual_file íŒŒì¼ì— íŒŒì¼ì— umask ì„¤ì • ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    u56_safe_check=$((u56_safe_check+1))
                fi
            else
                echo "$u56_user_home/$u56_individual_file íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
            fi
        done
    else
        echo "$u56_check_user ì˜ í™ˆ ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
done
if [[ $u56_safe_check -ge 1 ]];then
    u56=$((u56+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u56 -ge 1 ]];then
    Mid=$((Mid+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u56_Files_Directory_Management=1
fi

cat << EOF
===== [U-57] Set Home Directory Owners and Permissions              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-57  í™ˆë””ë ‰í† ë¦¬ ì†Œìœ ì ë° ê¶Œí•œ ì„¤ì •             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ì‚¬ìš©ì í™ˆ ë””ë ‰í„°ë¦¬ ë‚´ ì„¤ì •íŒŒì¼ì´ ë¹„ì¸ê°€ìì— ì˜í•œ ë³€ì¡°ë¥¼ ë°©ì§€í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : í™ˆ ë””ë ‰í„°ë¦¬ ë‚´ ì„¤ì •íŒŒì¼ ë³€ì¡° ì‹œ ì •ìƒì ì¸ ì„œë¹„ìŠ¤ ì´ìš©ì´ ì œí•œë  ìš°ë ¤ê°€ ì¡´ì¬í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: í™ˆ ë””ë ‰í„°ë¦¬ ì†Œìœ ìê°€ í•´ë‹¹ ê³„ì •ì´ê³ , íƒ€ ì‚¬ìš©ì ì“°ê¸° ê¶Œí•œì´ ì œê±°ëœ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: í™ˆ ë””ë ‰í„°ë¦¬ ì†Œìœ ìê°€ í•´ë‹¹ ê³„ì •ì´ ì•„ë‹ˆê³ , íƒ€ ì‚¬ìš©ì ì“°ê¸° ê¶Œí•œì´ ë¶€ì—¬ëœ  ê²½ìš°" >> $target
echo "+++++++++++++++++++++++++++++++++++++++++++++++++++++++++ff+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-57 ì ê²€ ê²°ê³¼" >> $result
u57_Files_Directory_Management=0
u57_safe_check=0
u57=0
u57_check_users=($(awk -F':' '!/sbin|sync|false/ {print $1}' /etc/passwd))

for u57_check_user in "${u57_check_users[@]}"; do
    u57_user_home=$(getent passwd "$u57_check_user" | awk -F':' '{print $6}')
    if [ -d "$u57_user_home" ]; then
        echo "--------------------------------------"   >> $target
        echo "$u57_check_user ì˜ í™ˆ ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•©ë‹ˆë‹¤."  >> $target
        u57_dir_owner=$(stat -c "%U" "$u57_user_home")
        u57_dir_other=$(stat -c "%A" "$u57_user_home" | awk '{print substr($0, length($0)-1)}' | grep -i "w")
        if [ "$u57_dir_owner" == "$u57_check_user" ];then
            if [ -n "$u57_dir_other" ];then
                echo "í™ˆ ë””ë ‰í„°ë¦¬ì˜ ê¸°íƒ€ ì‚¬ìš©ì(Other)ì— ëŒ€í•œ ì“°ê¸° ê¶Œí•œì´ ë¶€ì—¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                echo "í˜„ì¬ ì„¤ì •ê°’ : $u57_dir_other" >> $target
                u57_safe_check=$((u57_safe_check+1))
            else
                echo "í™ˆ ë””ë ‰í„°ë¦¬ ì†Œìœ ìê°€ í•´ë‹¹ ê³„ì •ìœ¼ë¡œ ë˜ì–´ ìˆìœ¼ë©°, íƒ€ ì‚¬ìš©ì ì“°ê¸° ê¶Œí•œì´ ì œê±°ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                echo "í˜„ì¬ ì„¤ì •ê°’ : $u57_dir_owner , $(stat -c "%A" "$u57_user_home")" >> $target
            fi
        else
            echo "í™ˆ ë””ë ‰í„°ë¦¬ ì†Œìœ ìê°€ í•´ë‹¹ ê³„ì •ì´ ì•„ë‹™ë‹ˆë‹¤." >> $target
            echo "í˜„ì¬ ì„¤ì •ê°’ : $u57_dir_owner" >> $target
            u57_safe_check=$((u57_safe_check+1))
        fi
    fi 
done

if [[ $u57_safe_check -ge 1 ]];then
    u57=$((u57+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u57 -ge 1 ]];then
    Mid=$((Mid+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u57_Files_Directory_Management=1
fi

cat << EOF
===== [U-58] Managing the existence of a directory that you specify as your home directory              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-58 í™ˆë””ë ‰í† ë¦¬ë¡œ ì§€ì •í•œ ë””ë ‰í† ë¦¬ì˜ ì¡´ì¬ ê´€ë¦¬             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : /home ì´ì™¸ ì‚¬ìš©ìì˜ í™ˆ ë””ë ‰í„°ë¦¬ ì¡´ì¬ ì—¬ë¶€ë¥¼ ì ê²€í•˜ì—¬ ë¹„ì¸ê°€ìê°€ ì‹œìŠ¤í…œ ëª…ë ¹ì–´ì˜ ë¬´ë‹¨ ì‚¬ìš©ì„ ë°©ì§€í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : passwd íŒŒì¼ì— ì„¤ì •ëœ í™ˆë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš°, í•´ë‹¹ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ì‹œ í™ˆë””ë ‰í„°ë¦¬ê°€ ë£¨íŠ¸ ë””ë ‰í„°ë¦¬(â€œ/â€œ)ë¡œ í• ë‹¹ë˜ì–´ ì ‘ê·¼ì´ ê°€ëŠ¥í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: í™ˆ ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê³„ì •ì´ ë°œê²¬ë˜ì§€ ì•ŠëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: í™ˆ ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê³„ì •ì´ ë°œê²¬ëœ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-58 ì ê²€ ê²°ê³¼" >> $result
u58_safe_check=0
u58_Files_Directory_Management=0
u58=0
IFS=$'\n' u58_check_users=($(awk -F':' '!/sbin|sync|false/ && $1 != "root" {print $1}' /etc/passwd))

for u58_check_user in "${u58_check_users[@]}"; do
    u58_user_home=$(getent passwd "$u58_check_user" | awk -F':' '{print $6}')
    if [[ "$u58_user_home" == "/home/$u58_check_user" ]]; then
        echo "$u58_check_user ì˜ í™ˆ ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
    else
        echo "--------------------------------------"  >> $target
        echo "$u58_check_user ì˜ í™ˆ ë””ë ‰í„°ë¦¬ê°€ /homeí•˜ìœ„ì— ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        u58_safe_check=$((u58_safe_check+1))
    fi
done

if [[ $u58_safe_check -ge 1 ]];then
    u58=$((u58+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u58 -ge 1 ]];then
    Mid=$((Mid+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u58_Files_Directory_Management=1
fi

cat << EOF
===== [U-59] Search and remove hidden files and directories              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-59 ìˆ¨ê²¨ì§„ íŒŒì¼ ë° ë””ë ‰í† ë¦¬ ê²€ìƒ‰ ë° ì œê±°             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ìˆ¨ê²¨ì§„ íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ ì¤‘ ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ë‚´ìš©ì€ ì •ìƒ ì‚¬ìš©ìê°€ ì•„ë‹Œ ê³µê²©ìì— ì˜í•´ ìƒì„±ë˜ì—ˆì„ ê°€ëŠ¥ì„±ì´ ë†’ìŒìœ¼ë¡œ ì´ë¥¼ ë°œê²¬í•˜ì—¬ ì œê±°í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ê³µê²©ìëŠ” ìˆ¨ê²¨ì§„ íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ë¥¼ í†µí•´ ì‹œìŠ¤í…œ ì •ë³´ ìŠµë“, íŒŒì¼ ì„ì˜ ë³€ê²½ ë“±ì„ í•  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ë¶ˆí•„ìš”í•˜ê±°ë‚˜ ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ìˆ¨ê²¨ì§„ íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ë¥¼ ì‚­ì œí•œ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ë¶ˆí•„ìš”í•˜ê±°ë‚˜ ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ìˆ¨ê²¨ì§„ íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ë¥¼ ë°©ì¹˜í•œ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-59 ì ê²€ ê²°ê³¼" >> $result
u59_safe_check=0
u59_Files_Directory_Management=0
u59=0
u59_secret_file=$(find / -type f -name ".*" -atime -30 2> /dev/null)
u59_secret_dir=$(find / -type d -name ".*" -atime -30 2> /dev/null)

if [ -n "$u59_secret_file" ];then
    echo "ìµœê·¼ 30ì¼ ë™ì•ˆ ì ‘ê·¼ëœ ìˆ¨ê²¨ì§„ íŒŒì¼ ëª©ë¡ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•˜ê±°ë‚˜ ì˜ì‹¬ìŠ¤ëŸ¬ìš´ íŒŒì¼ì˜ ê²½ìš° ì‚­ì œì¡°ì¹˜ê°€ í•„ìš”í•©ë‹ˆë‹¤." >> $target
    echo "$u59_secret_file" >> $target
    u59_safe_check=$((u59_safe_check+1))
else
    echo "ìµœê·¼ 30ì¼ ë™ì•ˆ ì ‘ê·¼ëœ ìˆ¨ê²¨ì§„ íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi
if [ -n "$u59_secret_dir" ];then
    echo "ìµœê·¼ 30ì¼ ë™ì•ˆ ì ‘ê·¼ëœ ìˆ¨ê²¨ì§„ ë””ë ‰í„°ë¦¬ ëª©ë¡ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ë¶ˆí•„ìš”í•˜ê±°ë‚˜ ì˜ì‹¬ìŠ¤ëŸ¬ìš´ íŒŒì¼ì˜ ê²½ìš° ì‚­ì œì¡°ì¹˜ê°€ í•„ìš”í•©ë‹ˆë‹¤." >> $target
    echo "$u59_secret_dir" >> $target
    u59_safe_check=$((u59_safe_check+1))
else
    echo "ìµœê·¼ 30ì¼ ë™ì•ˆ ì ‘ê·¼ëœ ìˆ¨ê²¨ì§„ ë””ë ‰í„°ë¦¬ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [[ $u59_safe_check -ge 1 ]];then
    u59=$((u59+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u59 -ge 1 ]];then
    Low=$((Low+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u59_Files_Directory_Management=1
fi

cat << EOF
===== [U-60] Allow ssh remote access              =====w
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-60 ssh ì›ê²©ì ‘ì† í—ˆìš©             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ë¹„êµì  ì•ˆì „í•œ SSH í”„ë¡œí† ì½œì„ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ìŠ¤ë‹ˆí•‘ ë“± ì•„ì´ë””/íŒ¨ìŠ¤ì›Œë“œì˜ ëˆ„ì¶œì˜ ë°©ì§€ë¥¼ ëª©ì ìœ¼ë¡œí•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ì›ê²© ì ‘ì† ì‹œ Telnet, FTP ë“±ì€ ì•”í˜¸í™”ë˜ì§€ ì•Šì€ ìƒíƒœë¡œ ë°ì´í„°ë¥¼ ì „ì†¡í•˜ê¸° ë•Œë¬¸ì— ì•„ì´ë””/íŒ¨ìŠ¤ì›Œë“œ ë° ì¤‘ìš” ì •ë³´ê°€ ì™¸ë¶€ë¡œ ìœ ì¶œë  ìœ„í—˜ì„±ì´ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ì›ê²© ì ‘ì† ì‹œ SSH í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°" >> $target
echo "â€» ssh, telnetì´ ë™ì‹œì— ì„¤ì¹˜ë˜ì–´ ìˆëŠ” ê²½ìš° ì·¨ì•½í•œ ê²ƒìœ¼ë¡œ í‰ê°€ë¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ì›ê²© ì ‘ì† ì‹œ Telnet, FTP ë“± ì•ˆì „í•˜ì§€ ì•Šì€ í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-60 ì ê²€ ê²°ê³¼" >> $result
u60_safe_check=0
u60_Service_Management=0
u60=0
# ê°’ ì„¤ì •
u60_ssh_checks=("ssh" "sshd")
u60_telnet_ftp_checks=("telnet" "vsftpd" "proftpd")

u60_telnet_ports=("23" "21" "20")

# í•¨ìˆ˜ í˜¸ì¶œ
u60_ssh_port=("22")  # ë‹¨ì¼ í¬íŠ¸ ë²ˆí˜¸ë¥¼ ë°°ì—´ í˜•íƒœë¡œ ì„¤ì •

check_service_status "${u60_ssh_port[@]}" "${u60_ssh_checks[@]}"
if [ $? -eq 1 ]; then
    check_service_status "${u60_telnet_ports}" "${u60_telnet_ftp_checks[@]}"
    if [ $? -eq 1 ]; then
        echo "ssh ì„œë¹„ìŠ¤ì™€ í•¨ê»˜ telnet ë˜ëŠ” ftp ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
        u60_safe_check=$((u60_safe_check+1))
    else
        echo "ssh í”„ë¡œí† ì½œë§Œì„ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
    fi
else
    echo "ssh í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ìˆìŠµë‹ˆë‹¤." >> $target
    u60_safe_check=$((u60_safe_check+1))
fi

if [[ $u60_safe_check -ge 1 ]];then
    u60=$((u60+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u60 -ge 1 ]];then
    Mid=$((Mid+1))
    Service_Management=$((Service_Management+1))
    u60_Service_Management=1
fi

cat << EOF
===== [U-61] Check ftp service              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-61 ftp ì„œë¹„ìŠ¤ í™•ì¸             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ì·¨ì•½í•œ ì„œë¹„ìŠ¤ì¸ FTPì„œë¹„ìŠ¤ë¥¼ ê°€ê¸‰ì  ì œí•œí•¨ì„ ëª©ì ìœ¼ë¡œ í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : FTP ì„œë¹„ìŠ¤ëŠ” í†µì‹ êµ¬ê°„ì´ í‰ë¬¸ìœ¼ë¡œ ì „ì†¡ë˜ì–´ ê³„ì •ì •ë³´(ì•„ì´ë””, íŒ¨ìŠ¤ì›Œë“œ) ë° ì „ì†¡ ë°ì´í„°ì˜ ìŠ¤ë‹ˆí•‘ì´ ê°€ëŠ¥í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: FTP ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„±í™” ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: FTP ì„œë¹„ìŠ¤ê°€ í™œì„±í™” ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-61 ì ê²€ ê²°ê³¼" >> $result
u61_safe_check=0
u61_Service_Management=0
u61=0
# ê°’ ì„¤ì •
u61_ftp_checks=("ftp" "vsftpd" "proftpd")

u61_ftp_ports=("21" "20")

check_service_status "${u61_ftp_ports}" "${u61_ftp_checks[@]}"
if [[ $? -eq 1 ]]; then
    echo "ftp ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
    u61_safe_check=$((u61_safe_check+1))
else
    echo "ftp ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [[ $u61_safe_check -ge 1 ]];then
    u61=$((u61+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u61 -ge 1 ]];then
    Low=$((Low+1))
    Service_Management=$((Service_Management+1))
    u61_Service_Management=1
fi

cat << EOF
===== [U-62] restricting tp account shell              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-62 tp ê³„ì • shell ì œí•œ             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : FTP ì„œë¹„ìŠ¤ ì„¤ì¹˜ ì‹œ ê¸°ë³¸ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ftp ê³„ì •ì€ ë¡œê·¸ì¸ì´ í•„ìš”í•˜ì§€ ì•Šì€ ê³„ì •ìœ¼ë¡œ ì‰˜ì„ ì œí•œí•˜ì—¬ í•´ë‹¹ ê³„ì •ìœ¼ë¡œì˜ ì‹œìŠ¤í…œ ì ‘ê·¼ì„ ì°¨ë‹¨í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ :  ë¶ˆí•„ìš”í•œ ê¸°ë³¸ ê³„ì •ì— ì‰˜(Shell)ì„ ë¶€ì—¬í•  ê²½ìš°, ê³µê²©ìì—ê²Œ í•´ë‹¹ ê³„ì •ì´ ë…¸ì¶œë˜ì–´ ftp ê¸°ë³¸ ê³„ì •ìœ¼ë¡œ ì‹œìŠ¤í…œ ì ‘ê·¼í•˜ì—¬ ê³µê²©ì´ ê°€ëŠ¥í•´" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ftp ê³„ì •ì— /bin/false ì‰˜ì´ ë¶€ì—¬ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ftp ê³„ì •ì— /bin/false ì‰˜ì´ ë¶€ì—¬ë˜ì–´ ìˆì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-62 ì ê²€ ê²°ê³¼" >> $result

u62_safe_check=0
u62_Service_Management=0
u62=0
u62_ftp_shell=$(grep -i "ftp" "/etc/passwd" | awk -F':' '{print $7}' | awk -F'/' '{print $NF}')
u62_check_safe_shells=("nologin" "false" "ftp-only")

if [ -n "$u62_ftp_shell" ];then
    echo "ftp ê³„ì •ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
    u62_check=0
    for u62_check_safe_shell in "${u62_check_safe_shells[@]}";do
        if [[ "$u62_ftp_shell" == "$u62_check_safe_shell" ]];then
            echo "ftp ê³„ì •ì˜ shell ì´ $u62_ftp_shell ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            u62_check=$((u62_check+1))
            break
        else   
            if [ $u62_check -eq 1 ];then
                echo "ftp ê³„ì •ì˜ shell ì´ $u62_ftp_shell ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                u62_safe_check=$((u62_safe_check+1))
            fi
        fi
    done
else
    echo "ftp ê³„ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [[ $u62_safe_check -ge 1 ]];then
    u62=$((u62+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u62 -ge 1 ]];then
    Mid=$((Mid+1))
    Service_Management=$((Service_Management+1))
    u62_Service_Management=1
fi

cat << EOF
===== [U-63] ftpersus file owner and permission settings              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-63 ftpusers íŒŒì¼ ì†Œìœ ì ë° ê¶Œí•œ ì„¤ì •             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ë¹„ì¸ê°€ìë“¤ì˜ ftp ì ‘ì†ì„ ì°¨ë‹¨í•˜ê¸° ìœ„í•´ ftpusers íŒŒì¼ ì†Œìœ ì ë° ê¶Œí•œì„ ê´€ë¦¬í•´ì•¼í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ftpusers íŒŒì¼ì— ì¸ê°€ë˜ì§€ ì•Šì€ ì‚¬ìš©ìë¥¼ ë“±ë¡í•˜ì—¬ í•´ë‹¹ ê³„ì •ì„ ì´ìš©, ë¶ˆë²•ì ì¸ FTP ì„œë¹„ìŠ¤ì— ì ‘ê·¼ì´ ê°€ëŠ¥í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ftpusers íŒŒì¼ì˜ ì†Œìœ ìê°€ rootì´ê³ , ê¶Œí•œì´ 640 ì´í•˜ì¸ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: tpusers íŒŒì¼ì˜ ì†Œìœ ìê°€ rootê°€ ì•„ë‹ˆê±°ë‚˜, ê¶Œí•œì´ 640 ì´í•˜ê°€ ì•„ë‹Œê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-63 ì ê²€ ê²°ê³¼" >> $result

u63=0
u63_safe_check=0
u63_Service_Management=0
u63_check_ftpfiles=("/etc/ftpusers" "/etc/ftpd/ftpusers" "/etc/vsftpd/ftpusers" "/etc/vsftpd/user_list" "/etc/vsftpd.user_list")
u63_safe_check=0
for u63_check_ftpfile in "${u63_check_ftpfiles[@]}";do
    if [ -e "$u63_check_ftpfile" ];then
        echo "$u63_check_ftpfile íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤."  >> $target
        u63_file_owner=$(stat -c "%U" "$u63_check_ftpfile" 2> /dev/null)
        u63_file_perm_user=$(stat -c "%a" "$u63_check_ftpfile" 2> /dev/null | cut -c1)
        u63_file_perm_group=$(stat -c "%a" "$u63_check_ftpfile" 2> /dev/null | cut -c2)
        u63_file_perm_other=$(stat -c "%a" "$u63_check_ftpfile" 2> /dev/null | cut -c3)
        if [[ "$u63_file_owner" == "root" ]];then
            echo "$u63_check_ftpfile íŒŒì¼ì˜ ì†Œìœ ìê°€ rootë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤."  >> $target
            if [[ $u63_file_perm_user -le 6 ]];then
                echo "$u63_check_ftpfile íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤."  >> $target
                if [[ $u63_file_perm_group -le 4 ]];then
                    echo "$u63_check_ftpfile íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 4ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤."  >> $target
                    if [[ $u63_file_perm_other -eq 0 ]];then
                        echo "$u63_check_ftpfile íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ì(Other)ì˜ ê¶Œí•œì´ 0ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤."  >> $target
                    else
                        echo "$u63_check_ftpfile íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ì(Other)ì˜ ê¶Œí•œì´ 0ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤."  >> $target
                        u63_safe_check=$((u63_safe_check+1))
                    fi
                else
                    echo "$u63_check_ftpfile íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 4ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤."  >> $target
                    u63_safe_check=$((u63_safe_check+1))
                fi
            else
                echo "$u63_check_ftpfile íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤."  >> $target
                u63_safe_check=$((u63_safe_check+1))
            fi
        else
            echo "$u63_check_ftpfile íŒŒì¼ì˜ ì†Œìœ ìê°€ rootê°€ ì•„ë‹Œ ë‹¤ë¥¸ ì‚¬ìš©ìë¡œ ë˜ì–´ ìˆìŠµë‹ˆë‹¤."  >> $target
            u63_safe_check=$((u63_safe_check+1))
        fi
    else
        echo "$u63_check_ftpfile íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."  >> $target
    fi
done

if [[ $u63_safe_check -ge 1 ]];then
    u63=$((u63+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi

if [[ $u63 -ge 1 ]];then
    Low=$((Low+1))
    Service_Management=$((Service_Management+1))
    u62_Service_Management=1
fi

cat << EOF
===== [U-64] FTP service root account access restrictions              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-64 ftpusers íŒŒì¼ ì„¤ì •(FTP ì„œë¹„ìŠ¤ root ê³„ì • ì ‘ê·¼ì œí•œ             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : rootì˜ FTP ì§ì ‘ ì ‘ì†ì„ ë°©ì§€í•˜ì—¬ root íŒ¨ìŠ¤ì›Œë“œ ì •ë³´ë¥¼ ë…¸ì¶œë˜ì§€ ì•Šë„ë¡ í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : FTP ì„œë¹„ìŠ¤ëŠ” ì•„ì´ë”” ë° íŒ¨ìŠ¤ì›Œë“œê°€ ì•”í˜¸í™”ë˜ì§€ ì•Šì€ ì±„ë¡œ ì „ì†¡ë˜ì–´ ìŠ¤ë‹ˆí•‘ì— ì˜í•´ì„œ ê´€ë¦¬ì ê³„ì •ì˜ ì•„ì´ë”” ë° íŒ¨ìŠ¤ì›Œë“œê°€ ë…¸ì¶œë  ìˆ˜ ìˆ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: FTP ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„±í™” ë˜ì–´ ìˆê±°ë‚˜, í™œì„±í™” ì‹œ root ê³„ì • ì ‘ì†ì„ ì°¨ë‹¨í•œ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: FTP ì„œë¹„ìŠ¤ê°€ í™œì„±í™” ë˜ì–´ ìˆê³ , root ê³„ì • ì ‘ì†ì„ í—ˆìš©í•œ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-64 ì ê²€ ê²°ê³¼" >> $result

u64_Service_Management=0
u64=0
u64_ftp_checks=("ftp" "vsftpd" "proftpd")
u64_ftp_ports=("21" "20")
u64_ftp_root_setting_files=("/etc/ftpusers" "/etc/ftpd/ftpusers" "/etc/vsftpd/ftpusers" "/etc/vsftpd/user_list" "/etc/vsftpd.user_list" "/etc/proftpd.conf")
u64_safe_check=0
check_service_status "${u64_ftp_ports}" "${u64_ftp_checks[@]}"
if [[ $? -eq 1 ]]; then
    echo "ftp ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤." >> $target
    u64=$((u64+1))
    for u64_ftp_root_setting_file in "${u64_ftp_root_setting_files[@]}";do
        if [ -e "$u64_ftp_root_setting_file" ];then
            echo "$u64_ftp_root_setting_file íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤.">> $target
            if [[ "$u64_ftp_root_setting_file" == "/etc/proftpd.conf" ]];then
                if grep -iv "^\s*#" "$u64_ftp_root_setting_file" | grep -iqE  "^\s*RootLogin\s*on$";then
                    echo "$u64_ftp_root_setting_file ì—ì„œ root ê³„ì • ì ‘ì†ì„ í—ˆìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.">> $target
                    echo "í˜„ì¬ ì„¤ì •ê°’ : $(grep -i "RootLogin" "$u64_ftp_root_setting_file")">> $target
                    u64=$((u64+1))
                    u64_safe_check=$((u64_safe_check+1))
                else
                    echo "$u64_ftp_root_setting_file ì—ì„œ root ê³„ì • ì ‘ì†ì„ ì°¨ë‹¨ í•˜ê³  ìˆìŠµë‹ˆë‹¤.">> $target
                    echo "í˜„ì¬ ì„¤ì •ê°’ (ì¡´ì¬í•  ê²½ìš° ì¶œë ¥): $(grep -i "RootLogin" "$u64_ftp_root_setting_file")">> $target
                fi
            else
                if grep -iv "^\s*#" "$u64_ftp_root_setting_file" | grep -iqE  "^\s*root$";then
                    echo "$u64_ftp_root_setting_file ì—ì„œ root ê³„ì • ì ‘ì†ì„ í—ˆìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.">> $target
                    echo "í˜„ì¬ ì„¤ì •ê°’ : $(grep -i "root" "$u64_ftp_root_setting_file")">> $target
                    u64=$((u64+1))
                    u64_safe_check=$((u64_safe_check+1))
                else
                    echo "$u64_ftp_root_setting_file ì—ì„œ root ê³„ì • ì ‘ì†ì„ ì°¨ë‹¨ í•˜ê³  ìˆìŠµë‹ˆë‹¤.">> $target
                    echo "í˜„ì¬ ì„¤ì •ê°’ (ì¡´ì¬í•  ê²½ìš° ì¶œë ¥): $(grep -i "root" "$u64_ftp_root_setting_file")">> $target
                fi
            fi
        fi
    done
else
    echo "ftp ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    u64_safe_check=$((u64_safe_check+1))
fi
if [[ $u64_safe_check -ge 1 ]];then
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi

if [[ $u64 -ge 1 ]];then
    Mid=$((Mid+1))
    Service_Management=$((Service_Management+1))
    u64_Service_Management=1
fi

cat << EOF
===== [U-65] Set at Service Permissions              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-65 at ì„œë¹„ìŠ¤ ê¶Œí•œ ì„¤ì •             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ê´€ë¦¬ìì™¸ at ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë„ë¡ ì„¤ì •í•˜ê³  ìˆëŠ”ì§€ ì ê²€í•˜ëŠ” ê²ƒì„ ëª©ì ìœ¼ë¡œ í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : root ì™¸ ì¼ë°˜ì‚¬ìš©ìì—ê²Œë„ at ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•  ê²½ìš°, ê³ ì˜ ë˜ëŠ” ì‹¤ìˆ˜ë¡œ ë¶ˆë²•ì ì¸ ì˜ˆì•½ íŒŒì¼ ì‹¤í–‰ìœ¼ë¡œ ì‹œìŠ¤í…œ í”¼í•´ë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: at ëª…ë ¹ì–´ ì¼ë°˜ì‚¬ìš©ì ê¸ˆì§€ ë° at ê´€ë ¨ íŒŒì¼ 640 ì´í•˜ì¸ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: at ëª…ë ¹ì–´ ì¼ë°˜ì‚¬ìš©ì ì‚¬ìš©ê°€ëŠ¥í•˜ê±°ë‚˜, at ê´€ë ¨ íŒŒì¼ 640 ì´ìƒì¸ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-65 ì ê²€ ê²°ê³¼" >> $result

u65_Service_Management=0
u65=0
u65_path_at=$(which at)
u65_Other_at_perm=$(stat -c "%a" "$u65_path_at"  2> /dev/null| rev | cut -c1 | rev)
u65_at_files=("/etc/at.allow" "/etc/at.deny")
u65_safe_check=0
if [ -e "$u65_path_at" ];then
    if ! [[ $u65_Other_at_perm -eq 0 ]];then
        echo "at ëª…ë ¹ì–´ì— ëŒ€í•œ ê¸°íƒ€ ì‚¬ìš©ì(Other)ì— ëŒ€í•œ ê¶Œí•œì´ ì£¼ì–´ì ¸ ìˆìŠµë‹ˆë‹¤." >> $target
        u65=$((u65+1))
        u65_safe_check=$((u65_safe_check+1))
    else
        echo "at ëª…ë ¹ì–´ì— ëŒ€í•œ ê¸°íƒ€ ì‚¬ìš©ì(Other)ì— ëŒ€í•œ ê¶Œí•œì´ ì£¼ì–´ì ¸ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        for u65_at_file in "${u65_at_files[@]}";do
            if [ -e "$u65_at_file" ];then
                echo "$u65_at_file ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
                u65_at_file_owner=$(stat -c "%a" "$u65_at_file"  2> /dev/null| cut -c1)
                u65_at_file_group=$(stat -c "%a" "$u65_at_file"  2> /dev/null| cut -c2)
                u65_at_file_other=$(stat -c "%a" "$u65_at_file"  2> /dev/null| cut -c3)
                u65_check_suid=$(stat -c "%a" "$u65_at_file"  2> /dev/null| tr -d '\n' | wc -c)
                if [[ $u65_check_suid -ge 4 ]];then
                    echo "$u65_at_file íŒŒì¼ì— SUID ê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. [ì˜ëª»ëœ SUID ì„¤ì •]" >> $target
                    u65_safe_check=$((u65_safe_check+1))
                else
                    if [ $u65_at_file_owner -le 6 ];then
                        echo "$u65_at_file íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        if [ $u65_at_file_group -le 4 ];then
                            echo "$u65_at_file íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 4ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            if [ $u65_at_file_other -eq 0 ];then
                                echo "$u65_at_file íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ì(Other) ê¶Œí•œì´ 0ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            else
                                echo "$u65_at_file íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ì(Other) ê¶Œí•œì´ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                                u65_safe_check=$((u65_safe_check+1))
                            fi
                        else
                            ehco "$u65_at_file íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 4ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            u65_safe_check=$((u65_safe_check+1))
                        fi
                    else
                        echo "$u65_at_file íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        u65_safe_check=$((u65_safe_check+1)) >> $target
                    fi
                fi
            else
                echo "$u65_at_file ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
            fi
        done
    fi
else
    echo "at ì‹¤í–‰íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."  >> $target
fi

if [[ $u65_safe_check -ge 1 ]];then
    u65=$((u65+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u65 -ge 1 ]];then
    Mid=$((Mid+1))
    Service_Management=$((Service_Management+1))
    u65_Service_Management=1
fi

cat << EOF
===== [U-66] Check SNMP service drive...              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-66 SNMP ì„œë¹„ìŠ¤ êµ¬ë™ ì ê²€             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ë¶ˆí•„ìš”í•œ SNMP ì„œë¹„ìŠ¤ í™œì„±í™”ë¡œ ì¸í•´ í•„ìš” ì´ìƒì˜ ì •ë³´ê°€ ë…¸ì¶œë˜ëŠ” ê²ƒì„ ë§‰ê¸° ìœ„í•´ SNMP ì„œë¹„ìŠ¤ë¥¼ ì¤‘ì§€í•´ì•¼í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : SNMP ì„œë¹„ìŠ¤ë¡œ ì¸í•˜ì—¬ ì‹œìŠ¤í…œì˜ ì£¼ìš” ì •ë³´ ìœ ì¶œ ë° ì •ë³´ì˜ ë¶ˆë²•ìˆ˜ì •ì´ ë°œìƒí•  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: SNMP ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: SNMP ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-66 ì ê²€ ê²°ê³¼" >> $result

u66_Service_Management=0
u66_safe_check=0
u66=0
u66_snmp_checks=("snmp" "snmpd")
u66_snmp_ports=("161" "162")

check_service_status "${u66_snmp_ports}" "${u66_snmp_checks[@]}"
if [[ $? -eq 1 ]]; then
    echo "snmp ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.">> $target
    66_safe_check=$((66_safe_check+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "snmp ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ìˆìŠµë‹ˆë‹¤.">> $target
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi

if [[ $u66_safe_check -ge 1 ]];then
    u66=$((u66+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u66 -ge 1 ]];then
    Mid=$((Mid+1))
    Service_Management=$((Service_Management+1))
    u66_Service_Management=1
fi

cat << EOF
===== [U-67] Configuring the Complexity of SNMP Service Community Strings              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-67 SNMP ì„œë¹„ìŠ¤ Community Stringì˜ ë³µì¡ì„± ì„¤ì •             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : Community String ê¸°ë³¸ ì„¤ì •ì¸ Public, PrivateëŠ” ê³µê°œëœ ë‚´ìš©ìœ¼ë¡œ ê³µê²©ìê°€ ì´ë¥¼ ì´ìš©í•˜ì—¬ SNMP ì„œë¹„ìŠ¤ë¥¼ í†µí•´ ì‹œìŠ¤í…œ ì •ë³´ë¥¼ ì–»ì„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— Community Stringì„ ìœ ì¶”í•˜ì§€ ëª»í•˜ë„ë¡ ì„¤ì •í•´ì•¼í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : Community Stringì€ Defaultë¡œ public, privateë¡œ ì„¤ì •ëœ ê²½ìš°ê°€ ë§ìœ¼ë©°, ì´ë¥¼ ë³€ê²½í•˜ì§€ ì•Šìœ¼ë©´ ì´ Stringì„ ì•…ìš©í•˜ì—¬ í™˜ê²½ì„¤ì • íŒŒì¼ ì—´ëŒ ë° ìˆ˜ì •ì„ í†µí•œ ê³µê²©, ê°„ë‹¨í•œ ì •ë³´ìˆ˜ì§‘ì—ì„œë¶€í„° ê´€ë¦¬ì ê¶Œí•œ íšë“ ë° Dosê³µê²©ê¹Œì§€ ë‹¤ì–‘í•œ í˜•íƒœì˜ ê³µê²©ì´ ê°€ëŠ¥í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: SNMP Community ì´ë¦„ì´ public, private ì´ ì•„ë‹Œ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: SNMP Community ì´ë¦„ì´ public, private ì¸ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-67 ì ê²€ ê²°ê³¼" >> $result

u67_Service_Management=0
u67_safe_check=0
u67=0
u67_snmpd_conf_paths=($(find / -type f -name "snmpd.conf" 2> /dev/null))
if [ -n "$u67_snmpd_conf_paths" ];then
    for u67_snmpd_conf_path in "${u67_snmpd_conf_paths[@]}";do
        if [ -e "$u67_snmpd_conf_path" ];then
            echo "$u67_snmpd_conf_path íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
            u67_check_string=$(grep -v "^\s*#" "$u67_snmpd_conf_path" 2> /dev/null | grep -i "public" | grep -i "private")
            if [ -n "$u67_check_string" ];then
                echo "SNMP Community ì´ë¦„ì´ public, privateë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                echo "í˜„ì¬ ì„¤ì •ê°’ : $u67_check_string" >> $target
                u67_safe_check=$((u67_safe_check+1))
            else
                echo "SNMP Community ì´ë¦„ì´ public, privateë¡œ ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                echo "í˜„ì¬ ì„¤ì •ê°’ : $u67_check_string" >> $target
            fi
        fi
    done
else
    echo "snmp ì„¤ì •íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [[ $u67_safe_check -ge 1 ]];then
    u67=$((u67+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u67 -ge 1 ]];then
    Mid=$((Mid+1))
    Service_Management=$((Service_Management+1))
    u67_Service_Management=1
fi

cat << EOF
===== [U-68] Provides a warning message when logged on              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-68 ë¡œê·¸ì˜¨ ì‹œ ê²½ê³  ë©”ì‹œì§€ ì œê³µ             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ë¹„ì¸ê°€ìë“¤ì—ê²Œ ì„œë²„ì— ëŒ€í•œ ë¶ˆí•„ìš”í•œ ì •ë³´ë¥¼ ì œê³µí•˜ì§€ ì•Šê³ , ì„œë²„ ì ‘ì† ì‹œ ê´€ê³„ìë§Œ ì ‘ì†í•´ì•¼ í•œë‹¤ëŠ” ê²½ê°ì‹¬ì„ ì‹¬ì–´ ì£¼ê¸°ìœ„í•´ ê²½ê³  ë©”ì‹œì§€ ì„¤ì •ì´ í•„ìš”í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ë¡œê·¸ì¸ ë°°ë„ˆê°€ ì„¤ì •ë˜ì§€ ì•Šì„ ê²½ìš° ë°°ë„ˆì— ì„œë²„ OS ë²„ì „ ë° ì„œë¹„ìŠ¤ ë²„ì „ì´ ê³µê²©ìì—ê²Œ ë…¸ì¶œë  ìˆ˜ ìˆìœ¼ë©° ê³µê²©ìëŠ” ì´ëŸ¬í•œ ì •ë³´ë¥¼ í†µí•˜ì—¬ í•´ë‹¹ OS ë° ì„œë¹„ìŠ¤ì˜ ì·¨ì•½ì ì„ ì´ìš©í•˜ì—¬ ê³µê²©ì„ ì‹œë„í•  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ì„œë²„ ë° Telnet, FTP, SMTP, DNS ì„œë¹„ìŠ¤ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì„¤ì •ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ì„œë²„ ë° Telnet, FTP, SMTP, DNS ì„œë¹„ìŠ¤ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì„¤ì •ë˜ì–´ ìˆì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-68 ì ê²€ ê²°ê³¼" >> $result

u68_Service_Management=0
u68_safe_check=0
u68=0
u68_check_files=("motd" "inssue.net" "vsftpd.conf" "proftpd.conf" "main.cf" "sendmail.cf" "named.conf") 
u68_safe_check=0
for u68_check_file in "${u68_check_files[@]}";do
    u68_find_file=$(find / -type f -name "$u68_check_file" 2> /dev/null)
    if [ -e "$u68_find_file" ];then
        echo "$u68_find_file íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        u68_file_name=$(basename "$u68_find_file")
        case $u68_file_name in
            "motd")
                if [[ $(wc -c < "$u68_find_file") -ge 1 ]];then
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                else
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    u68_safe_check=$((u68_safe_check+1))
                fi
                ;;
            "inssue.net")
                if [[ $(wc -c < "$u68_find_file") -ge 1 ]];then
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                else
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    u68_safe_check=$((u68_safe_check+1))
                fi
                ;;
            "vsftpd.conf")
                if grep -v "^\s*#" "$u68_find_file" | grep -iqE "^\s*ftpd_banner\s*=\s*.";then
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                else
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    u68_safe_check=$((u68_safe_check+1))
                fi
                ;;
            "proftpd.conf")
                if grep -v "^\s*#" "$u68_find_file" | grep -iqE "^\s*ServerIdent\s*on\s*.";then
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                else
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    u68_safe_check=$((u68_safe_check+1))
                fi                ;;
            "main.cf")
                if grep -v "^\s*#" "$u68_find_file" | grep -iqE "^\s*smtpd_banner\s*=\s*.";then
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                else
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    u68_safe_check=$((u68_safe_check+1))
                fi 
                ;;
            "sendmail.cf")
                if grep -v "^\s*#" "$u68_find_file" | grep -iqE "^\s*O\s*SmtpGreetingMessage\s*=\s*.";then
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                else
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    u68_safe_check=$((u68_safe_check+1))
                fi 
                ;;
            "named.conf")
                 if grep -q "logging" "$u68_find_file";then
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                else
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    u68_safe_check=$((u68_safe_check+1))
                fi 
                ;;
            *)
                echo "í•´ë‹¹ íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” íŒŒì¼ì…ë‹ˆë‹¤.: $file" >> $target
                ;;
        esac
    fi
done
if [[ $u68_safe_check -ge 1 ]];then
    u68=$((u68+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u68 -ge 1 ]];then
    Low=$((Low+1))
    Service_Management=$((Service_Management+1))
    u68_Service_Management=1
fi

cat << EOF
===== [U-69] NFS Configuration File Access Permissions              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-69 NFS ì„¤ì •íŒŒì¼ ì ‘ê·¼ê¶Œí•œ             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ë¹„ì¸ê°€ìì— ì˜í•œ ë¶ˆë²•ì ì¸ ì™¸ë¶€ ì‹œìŠ¤í…œ ë§ˆìš´íŠ¸ë¥¼ ì°¨ë‹¨í•˜ê¸° ìœ„í•´ NFS ì ‘ê·¼ ì œì–´ íŒŒì¼ì˜ ì†Œìœ ì ë° íŒŒì¼ ê¶Œí•œì„ ì„¤ì •" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : NFS ì ‘ê·¼ì œì–´ ì„¤ì •íŒŒì¼ì— ëŒ€í•œ ê¶Œí•œ ê´€ë¦¬ê°€ ì´ë£¨ì–´ì§€ì§€ ì•Šì„ ì‹œ ì¸ê°€ë˜ì§€ ì•Šì€ ì‚¬ìš©ìë¥¼ ë“±ë¡í•˜ê³  íŒŒì¼ì‹œìŠ¤í…œì„ ë§ˆìš´íŠ¸í•˜ì—¬ ë¶ˆë²•ì ì¸ ë³€ì¡°ë¥¼ ì‹œë„í•  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: NFS ì ‘ê·¼ì œì–´ ì„¤ì •íŒŒì¼ì˜ ì†Œìœ ìê°€ root ì´ê³ , ê¶Œí•œì´ 644 ì´í•˜ì¸ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: NFS ì ‘ê·¼ì œì–´ ì„¤ì •íŒŒì¼ì˜ ì†Œìœ ìê°€ root ê°€ ì•„ë‹ˆê±°ë‚˜, ê¶Œí•œì´ 644 ì´í•˜ê°€ ì•„ë‹Œ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-69 ì ê²€ ê²°ê³¼" >> $result

u69_Service_Management=0
u69_safe_check=0
u69=0
if [ -e "/etc/exports" ];then
    echo "exports íŒŒì¼ì´ ì¡´ì¬ í•©ë‹ˆë‹¤." >> $target
    u69_file_owner=$(stat -c "%U" "/etc/exports" 2> /dev/null)
        u69_file_perm_user=$(stat -c "%a" "/etc/exports" 2> /dev/null | cut -c1)
        u69_file_perm_group=$(stat -c "%a" "/etc/exports" 2> /dev/null | cut -c2)
        u69_file_perm_other=$(stat -c "%a" "/etc/exports" 2> /dev/null | cut -c3)
        if [[ "$u69_file_owner" == "root" ]];then
            echo "/etc/exports íŒŒì¼ì˜ ì†Œìœ ìê°€ rootë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            if [[ $u69_file_perm_user -le 6 ]];then
                echo "/etc/exports íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                if [[ $u69_file_perm_group -le 4 ]];then
                    echo "/etc/exports íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 4ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    if [[ $u69_file_perm_other -le 4 ]];then
                        echo "/etc/exports íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ì(Other)ì˜ ê¶Œí•œì´ 4ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    else
                        echo "/etc/exports íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ì(Other)ì˜ ê¶Œí•œì´ 6ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        u69_safe_check=$((u69_safe_check+1))
                    fi
                else
                    echo "/etc/exports íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 4ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    u69_safe_check=$((u69_safe_check+1))
                fi
            else
                echo "/etc/exports íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                u69_safe_check=$((u69_safe_check+1))
            fi
        else
            echo "/etc/exports íŒŒì¼ì˜ ì†Œìœ ìê°€ rootê°€ ì•„ë‹Œ ë‹¤ë¥¸ ì‚¬ìš©ìë¡œ ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            u69_safe_check=$((u69_safe_check+1))
        fi
else
    echo "exports íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi
if [[ $u69_safe_check -ge 1 ]];then
    u69=$((u69+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi

if [[ $u69 -ge 1 ]];then
    Mid=$((Mid+1))
    Service_Management=$((Service_Management+1))
    u69_Service_Management=1
fi

cat << EOF
===== [U-70] NFS Configuration File Access Permissions              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-70 NFS ì„¤ì •íŒŒì¼ ì ‘ê·¼ê¶Œí•œ             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : SMTP ì„œë¹„ìŠ¤ì˜ expn, vrfy ëª…ë ¹ì„ í†µí•œ ì •ë³´ ìœ ì¶œì„ ë§‰ê¸° ìœ„í•˜ì—¬ ë‘ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì§€ ëª»í•˜ê²Œ ì˜µì…˜ì„ ì„¤ì •í•´ì•¼í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : VRFY, EXPN ëª…ë ¹ì–´ë¥¼ í†µí•˜ì—¬ íŠ¹ì • ì‚¬ìš©ì ê³„ì •ì˜ ì¡´ì¬ìœ ë¬´ë¥¼ ì•Œ ìˆ˜ ìˆê³ , ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ ì™¸ë¶€ë¡œ ìœ ì¶œ í•  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: SMTP ì„œë¹„ìŠ¤ ë¯¸ì‚¬ìš© ë˜ëŠ”, noexpn, novrfy ì˜µì…˜ì´ ì„¤ì •ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: SMTP ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³ , noexpn, novrfy ì˜µì…˜ì´ ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-70 ì ê²€ ê²°ê³¼" >> $result

u70_Service_Management=0
u70_safe_check=0
u70=0
u70_snmp_checks=("snmp" "snmpd")
u70_snmp_ports=("161" "162")
u70_safe_check=0
check_service_status "${u70_snmp_ports}" "${u70_snmp_checks[@]}"
if [[ $? -eq 1 ]]; then
    echo "snmp ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.">> $target
    u70_safe_check=$((u70_safe_check+1))
else
    echo "snmp ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ìˆìŠµë‹ˆë‹¤.">> $target
fi
u70_files=("sendmail.cf" "main.cf")
for u70_file in "${u70_files[@]}";do
    u70_file_path=$(find / -type f -name "$u70_file" 2> /dev/null)
    if [ -n "$u70_file_path" ];then
        echo "$u70_file íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤.">> $target
        if [[ "$u70_file" == "sendmail.cf" ]];then
            u70_check_option=$(grep -vE "^\s*#" "$u70_file_path" 2> /dev/null | grep -iE "^\s*O\s*PrivacyOptions\s*=\s*." | grep -iE "noexpn|goaway" | grep -iE "novrfy|goaway")
            if [ -n "$u70_check_option" ];then
                echo "$u70_file íŒŒì¼ì— noexpn, novrfy ì˜µì…˜ì´ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤.">> $target
                echo "í˜„ì¬ ì„¤ì • ê°’ : $u70_check_option" >> $target 
            else
                echo "$u70_file íŒŒì¼ì— noexpn, novrfy ì˜µì…˜ì´ ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.">> $target
                u70_safe_check=$((u70_safe_check+1))
            fi
        else
            u70_check_option=$(grep -vE "^\s*#" "$u70_file_path" 2> /dev/null | grep -iE "^\s*smtpd_privacy_options\s*=\s*." | grep -iE "noexpn|goaway" | grep -iE "novrfy|goaway")
            if [ -n "$u70_check_option" ];then
                echo "$u70_file íŒŒì¼ì— noexpn, novrfy ì˜µì…˜ì´ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤.">> $target
                echo "í˜„ì¬ ì„¤ì • ê°’ : $u70_check_option" >> $target
            else
                echo "$u70_file íŒŒì¼ì— noexpn, novrfy ì˜µì…˜ì´ ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.">> $target
                u70_safe_check=$((u70_safe_check+1))
            fi
        fi
    fi
done

if [[ $u70_safe_check -ge 1 ]];then
    u70=$((u70+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi

if [[ $u70 -ge 1 ]];then
    Mid=$((Mid+1))
    Service_Management=$((Service_Management+1))
    u70_Service_Management=1
fi


cat << EOF
===== [U-71] Hide Apache Web Services Information              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-71 Apache ì›¹ ì„œë¹„ìŠ¤ ì •ë³´ ìˆ¨ê¹€             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : HTTP í—¤ë”, ì—ëŸ¬í˜ì´ì§€ì—ì„œ ì›¹ ì„œë²„ ë²„ì „ ë° ì¢…ë¥˜, OS ì •ë³´ ë“± ì›¹ ì„œë²„ì™€ ê´€ë ¨ëœ ë¶ˆí•„ìš”í•œ ì •ë³´ê°€ ë…¸ì¶œë˜ì§€ ì•Šë„ë¡ í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ë¶ˆí•„ìš”í•œ ì •ë³´ê°€ ë…¸ì¶œë  ê²½ìš° í•´ë‹¹ ì •ë³´ë¥¼ ì´ìš©í•˜ì—¬ ì‹œìŠ¤í…œì˜ ì·¨ì•½ì ì„ ìˆ˜ sì§‘í•  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ServerTokens Prod, ServerSignature Offë¡œ ì„¤ì •ë˜ì–´ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ServerTokens Prod, ServerSignature Offë¡œ ì„¤ì •ë˜ì–´ìˆì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-71 ì ê²€ ê²°ê³¼" >> $result

u71_Service_Management=0
u71_safe_check=0
u71=0
u71_safe_check=0
u71_apache_files=("/etc/apache2/conf-available/*.conf" "/etc/apache2/sites-available/*.conf" "/etc/apache2/sites-enabled/*.conf" "/etc/apache2/conf-enabled/*.conf" ".htaccess")
u71_nginx_files=("/etc/nginx/conf.d/*.conf" "/etc/nginx/sites-available/*.conf" "/etc/nginx/sites-enabled/*.conf")
u71_apache_home_checks=("httpd.conf" "apache2.conf" ".htaccess")
u71_break=0
echo "â€»Cent OS 7 ê¸°ì¤€ Apache ë©”ì¸ ì„¤ì •íŒŒì¼ ê²½ë¡œì™€ Nginx ë©”ì¸ ì„¤ì • íŒŒì¼ì¸ /etc/nginx/nginx.confë¥¼ ì ê²€í•©ë‹ˆë‹¤. í•´ë‹¹ ê²½ë¡œê°€ ì¡´ì¬í•˜ì§€ ì•Šì„ ê²½ìš°, ì•„íŒŒì¹˜ ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ëª…ì„ í† ëŒ€ë¡œ íŒŒì¼ íƒìƒ‰ í›„ ì ê²€ì´ ì§„í–‰ë©ë‹ˆë‹¤. ì¤‘ë³µëœ íŒŒì¼ëª…ì´ ì¡´ì¬í•  ê²½ìš° ìˆ˜ë™ ì ê²€ì„ ê¶Œì¥í•©ë‹ˆë‹¤.â€»" >> $target
for u71_apache_home_check in "${u71_apache_home_checks[@]}";do
    u71_apache_home=$(find / -type f -name "$u71_apache_home_check" 2> /dev/null | egrep -v "tmp|temp|swap|swp")
    if [ -f "$u71_apache_home" ];then
        echo "$u71_apache_home íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
        u71_server_tokens=$(grep -vE "^\s*#" "$u71_apache_home" | grep -i "ServerTokens" | grep -i "prod")
        u71_serversignature=$(grep -E "^\s*#" "$u71_apache_home" | grep -i "ServerSignature" | grep -i "off")
        if [ -n "$u71_server_tokens" ];then
            echo "ServerTokens ì§€ì‹œìì˜ ì˜µì…˜ì´ Prodë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
            echo "í˜„ì¬ ì„¤ì • ê°’ : $u71_server_tokens" >> $target
            if [ -n "$u71_serversignature" ];then
                echo "ServerSignature ì§€ì‹œìì˜ ì˜µì…˜ì´ offë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                echo "í˜„ì¬ ì„¤ì • ê°’ : $u71_serversignature" >> $target
            else
                echo "ServerSignature ì§€ì‹œìì˜ ì˜µì…˜ì´ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜, offë¡œ ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                u71_safe_check=$((u71_safe_check+1))
            fi
        else
            echo "ServerTokens ì§€ì‹œìì˜ ì˜µì…˜ì´ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜, Prodë¡œ ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
            u71_safe_check=$((u71_safe_check+1))
        fi
    else 
        if [ $u71_break -eq 1 ];then
            continue
        fi
        u71_break=$((u71_break+1))
        for u71_apache_file in "${u71_apache_files[@]}";do
            for u71_apache_check in $u71_apache_file;do
                if [ -f "$u71_apache_check" ];then
                    echo "$u71_apache_check íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
                    u71_server_tokens=$(grep -v "^\s*#" "$u71_apache_check" | grep -i "ServerTokens" | grep -i "prod")
                    u71_serversignature=$(grep -v "^\s*#" "$u71_apache_check" | grep -i "ServerSignature" | grep -i "off")
                    if [ -n "$u71_server_tokens" ];then
                        echo "ServerTokens ì§€ì‹œìì˜ ì˜µì…˜ì´ Prodë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                        echo "í˜„ì¬ ì„¤ì • ê°’ : $u71_server_tokens" >> $target
                        if [ -n "$u71_serversignature" ];then
                            echo "ServerSignature ì§€ì‹œìì˜ ì˜µì…˜ì´ offë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                            echo "í˜„ì¬ ì„¤ì • ê°’ : $u71_serversignature" >> $target
                        else
                            echo "ServerSignature ì§€ì‹œìì˜ ì˜µì…˜ì´ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜, offë¡œ ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                            u71_safe_check=$((u71_safe_check+1))
                        fi
                    else
                        echo "ServerTokens ì§€ì‹œìì˜ ì˜µì…˜ì´ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜, Prodë¡œ ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                        u71_safe_check=$((u71_safe_check+1))
                    fi
                fi
            done
        done
    fi
done

echo "ì¶”ê°€ì ì¸ Apache ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ë“¤ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¶”ê°€ì ì¸ ìˆ˜ë™ ì ê²€ì„ ê¶Œì¥í•©ë‹ˆë‹¤." >> $target
if [ -f "/etc/nginx/nginx.conf" ];then
    echo "/etc/nginx/nginx.conf íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
    u71_server_tokens_nginx=$(grep -v "^\s*#" "/etc/nginx/nginx.conf" | grep -i "server_tokens" | grep -i "off")
    if [ -n "$u71_server_tokens_nginx" ];then
        echo "server_tokens ì§€ì‹œìì˜ ì˜µì…˜ì´ offë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
        echo "í˜„ì¬ ì„¤ì • ê°’ : $u71_server_tokens_nginx" >> $target
    else
        echo "server_tokens ì§€ì‹œìì˜ ì˜µì…˜ì´ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜, offë¡œ ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        u71_safe_check=$((u71_safe_check+1))
    fi
else 
    echo "/etc/nginx/nginx.conf íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©°, ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ëª…ì„ í† ëŒ€ë¡œ ì ê²€ì„ ì§„í–‰í•©ë‹ˆë‹¤." >> $target
    for u71_ngnix_file in ${u71_nginx_files[@]};do
        for u71_nginx_check in $u71_ngnix_file;do
            if [ -e "$u71_nginx_check" ];then
                echo "$u71_nginx_check íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤." >> $target
                u71_server_tokens_nginx=$(grep -v "^\s*#" "$u71_nginx_check" | grep -i "server_tokens" | grep -i "off")
                if [ -n "$u71_server_tokens_nginx" ];then
                    echo "server_tokens ì§€ì‹œìì˜ ì˜µì…˜ì´ offë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
                    echo "í˜„ì¬ ì„¤ì • ê°’ : $u71_server_tokens_nginx" >> $target
                else
                    echo "server_tokens ì§€ì‹œìì˜ ì˜µì…˜ì´ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜, offë¡œ ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    u71_safe_check=$((u71_safe_check+1)) >> $target
                fi
            fi
        done
    done
    echo "ì¶”ê°€ì ì¸ ì›¹ ì„œë¹„ìŠ¤ êµ¬ì„± íŒŒì¼ë“¤ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¶”ê°€ì ì¸ ìˆ˜ë™ ì ê²€ì„ ê¶Œì¥í•©ë‹ˆë‹¤." >> $target
fi

if [[ $u71_safe_check -ge 1 ]];then
    u71=$((u71+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi

if [[ $u71 -ge 1 ]];then
    Mid=$((Mid+1))
    Service_Management=$((Service_Management+1))
    u71_Service_Management=1
fi

cat << EOF
===== [U-72] Setting up system logging according to policy              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-72 ì •ì±…ì— ë”°ë¥¸ ì‹œìŠ¤í…œ ë¡œê¹… ì„¤ì •             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ë³´ì•ˆ ì‚¬ê³  ë°œìƒ ì‹œ ì›ì¸ íŒŒì•… ë° ê°ì¢… ì¹¨í•´ ì‚¬ì‹¤ì— ëŒ€í•œ í™•ì¸ì„ í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ë¡œê¹… ì„¤ì •ì´ ë˜ì–´ ìˆì§€ ì•Šì„ ê²½ìš° ì›ì¸ ê·œëª…ì´ ì–´ë ¤ìš°ë©°, ë²•ì  ëŒ€ì‘ì„ ìœ„í•œ ì¶©ë¶„í•œ ì¦ê±°ë¡œ ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ë¡œê·¸ ê¸°ë¡ ì •ì±…ì´ ì •ì±…ì— ë”°ë¼ ì„¤ì •ë˜ì–´ ìˆ˜ë¦½ë˜ì–´ ìˆìœ¼ë©° ë³´ì•ˆì •ì±…ì— ë”°ë¼ ë¡œê·¸ë¥¼ ë‚¨ê¸°ê³  ìˆì„ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ë¡œê·¸ ê¸°ë¡ ì •ì±… ë¯¸ìˆ˜ë¦½ ë˜ëŠ”, ì •ì±…ì— ë”°ë¼ ì„¤ì •ë˜ì–´ ìˆì§€ ì•Šê±°ë‚˜ ë³´ì•ˆì •ì±…ì— ë”°ë¼ ë¡œê·¸ë¥¼ ë‚¨ê¸°ê³  ìˆì§€ ì•Šì„ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-72 ì ê²€ ê²°ê³¼" >> $result
u72_Log_Management=0
u72_safe_check=0
u72=0
echo "ê·€ì‚¬ì˜ ì‹œìŠ¤í…œì— ëŒ€í•œ ë³´ì•ˆ ë‹´ë‹¹ìì™€ì˜ ìƒë‹´ì„ í†µí•´ ë¡œê·¸ ê¸°ë¡ ì •ì±…ì´ ì •ì±…ì— ë”°ë¼ ì„¤ì •ë˜ì–´ ìˆ˜ë¦½ë˜ì–´ ë³´ì•ˆì •ì±…ì— ë”°ë¼ ë¡œê·¸ë¥¼ ë‚¨ê¸°ê³  ìˆëŠ”ì§€ í™•ì¸í•´ì•¼í•¨." >> $target


if [[ $u72_safe_check -ge 1 ]];then
    u72=$((u72+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi

if [[ $u72 -ge 1 ]];then
    Low=$((Mid+1))
    Log_Management=$((Log_Management+1))
    u72_Log_Management=1
fi







echo "ìœ„í—˜ë„ (ìƒ)" >> $severity_total
echo "$High" >> $severity_total
echo "ìœ„í—˜ë„ (ì¤‘)" >> $severity_total 
echo "$Mid" >> $severity_total
echo "ìœ„í—˜ë„ (í•˜)" >> $severity_total
echo "$Low" >> $severity_total




curl -X POST http://<ip>:<port>/severity_total -H "Content-Type: application/json" -d "{\"High\":\"$High\"}" 2> /dev/null
curl -X POST http://<ip>:<port>/severity_total -H "Content-Type: application/json" -d "{\"Mid\":\"$Mid\"}" 2> /dev/null
curl -X POST http://<ip>:<port>/severity_total -H "Content-Type: application/json" -d "{\"Low\":\"$Low\"}" 2> /dev/null
curl -X POST http://<ip>:<port>/Inspection_Items -H "Content-Type: application/json" -d "{\"Account_Management\":\"$Account_Management\"}" 2> /dev/null
curl -X POST http://<ip>:<port>/Inspection_Items -H "Content-Type: application/json" -d "{\"Files_Directory_Management\":\"$Files_Directory_Management\"}" 2> /dev/null
curl -X POST http://<ip>:<port>/Inspection_Items -H "Content-Type: application/json" -d "{\"Service_Management\":\"$Service_Management\"}" 2> /dev/null
curl -X POST http://<ip>:<port>/Inspection_Items -H "Content-Type: application/json" -d "{\"Patch_Management\":\"$Patch_Management\"}" 2> /dev/null
curl -X POST http://<ip>:<port>/Inspection_Items -H "Content-Type: application/json" -d "{\"Log_Management\":\"$Log_Management\"}" 2> /dev/null
# ì‹œìŠ¤í…œ ì •ë³´ ê´€ë ¨ JSON ë°ì´í„°ë¥¼ jqë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒì„±
json_data=$(jq -n \
  --arg hostname "$hostname" \
  --arg date_time "$date_time" \
  --arg info "$info" \
  --arg release "$release" \
  '{hostname: $hostname, date_time: $date_time, info: $info, release: $release}')

# ìƒì„±í•œ JSON ë°ì´í„°ë¥¼ POST ìš”ì²­ìœ¼ë¡œ ì„œë²„ì— ì „ì†¡
curl -X POST http://<ip>:<port>/system_info -H "Content-Type: application/json" -d "$json_data" 2> /dev/null

# ê´€ë¦¬ë˜ëŠ” ì¸ë±ìŠ¤
account_management_indices=(1 2 3 4 44 45 46 47 48 49 50 51 52 53 54)
files_directory_management_indices=(5 6 7 8 9 10 11 12 13 14 15 16 17 18 55 56 57 58 59)
service_management_indices=(19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 60 61 62 63 64 65 66 67 68 69 70 71)
patch_management_indices=(42)
log_management_indices=(43 72) # log_management_indices ì¶”ê°€

# ë¼ìš°í„° ê²½ë¡œ ë° ë°ì´í„° ì´ˆê¸°í™”
declare -A categorys
categorys["Account_Management"]=""
categorys["Files_Directory_Management"]=""
categorys["Service_Management"]=""
categorys["Patch_Management"]=""
categorys["Log_Management"]=""

# í•¨ìˆ˜: ì¸ë±ìŠ¤ë¥¼ í™•ì¸í•˜ê³  í•´ë‹¹ ê°’ì´ 1ì¸ ê²½ìš° JSON ë°ì´í„°ì— ì¶”ê°€
check_and_add() {
    local var_name="u$1_$2"
    if [[ ${!var_name} -eq 1 ]]; then
        categorys[$2]+="\"u${1}_$2\":1,"
    fi
}

# ì¸ë±ìŠ¤ í™•ì¸ ë° ë¼ìš°í„°ì— ê°’ ì¶”ê°€
for i in "${account_management_indices[@]}"; do
    check_and_add "$i" "Account_Management"
done

for i in "${files_directory_management_indices[@]}"; do
    check_and_add "$i" "Files_Directory_Management"
done

for i in "${service_management_indices[@]}"; do
    check_and_add "$i" "Service_Management"
done

for i in "${patch_management_indices[@]}"; do
    check_and_add "$i" "Patch_Management"
done

for i in "${log_management_indices[@]}"; do
    check_and_add "$i" "Log_Management"
done

# curl ëª…ë ¹ì–´ë¡œ ì „ì†¡
for category in "${!categorys[@]}"; do
    json_data=${categorys[$category]}
    if [[ -n $json_data ]]; then
        json_data="{${json_data%,}}" # ë§ˆì§€ë§‰ ì½¤ë§ˆ ì œê±° ë° JSON í¬ë§·ìœ¼ë¡œ ê°ì‹¸ê¸°
        #echo "Sending data to /$category: $json_data"
        curl -X POST "http://<ip>:<port>/$category" -H "Content-Type: application/json" -d "$json_data" 2> /dev/null
    fi
done
curl -F "result_files=@$target" http://192.168.13.5:8080/upload 2> /dev/null
curl -F "result_files=@$result" http://192.168.13.5:8080/upload 2> /dev/null

echo ''
echo ''
echo "ëª¨ë“  ì ê²€ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ $target íŒŒì¼ì„ í™•ì¸í•˜ì‹­ì‹œì˜¤."
