cat << EOF
===== [U-64] FTP service root account access restrictions              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-64 ftpusers íŒŒì¼ ì„¤ì •(FTP ì„œë¹„ìŠ¤ root ê³„ì • ì ‘ê·¼ì œí•œ             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : rootì˜ FTP ì§ì ‘ ì ‘ì†ì„ ë°©ì§€í•˜ì—¬ root íŒ¨ìŠ¤ì›Œë“œ ì •ë³´ë¥¼ ë…¸ì¶œë˜ì§€ ì•Šë„ë¡ í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : FTP ì„œë¹„ìŠ¤ëŠ” ì•„ì´ë”” ë° íŒ¨ìŠ¤ì›Œë“œê°€ ì•”í˜¸í™”ë˜ì§€ ì•Šì€ ì±„ë¡œ ì „ì†¡ë˜ì–´ ìŠ¤ë‹ˆí•‘ì— ì˜í•´ì„œ ê´€ë¦¬ìž ê³„ì •ì˜ ì•„ì´ë”” ë° íŒ¨ìŠ¤ì›Œë“œê°€ ë…¸ì¶œë  ìˆ˜ ìžˆ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜: FTP ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„±í™” ë˜ì–´ ìžˆê±°ë‚˜, í™œì„±í™” ì‹œ root ê³„ì • ì ‘ì†ì„ ì°¨ë‹¨í•œ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: FTP ì„œë¹„ìŠ¤ê°€ í™œì„±í™” ë˜ì–´ ìžˆê³ , root ê³„ì • ì ‘ì†ì„ í—ˆìš©í•œ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-64 ì ê²€ ê²°ê³¼" >> $result

u64_Service_Management=0
u64=0
u64_ftp_checks=("ftp" "vsftpd" "proftpd")
u64_ftp_ports=("21" "20")
u64_ftp_root_setting_files=("/etc/ftpusers" "/etc/ftpd/ftpusers" "/etc/vsftpd/ftpusers" "/etc/vsftpd/user_list" "/etc/vsftpd.user_list" "/etc/proftpd.conf")
u64_safe_check=0
check_service_status "${u64_ftp_ports}" "${u64_ftp_checks[@]}"
if [[ $? -eq 1 ]]; then
    echo "ftp ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìžˆìŠµë‹ˆë‹¤." >> $target
    u64=$((u64+1))
    for u64_ftp_root_setting_file in "${u64_ftp_root_setting_files[@]}";do
        if [ -e "$u64_ftp_root_setting_file" ];then
            echo "$u64_ftp_root_setting_file íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤.">> $target
            if [[ "$u64_ftp_root_setting_file" == "/etc/proftpd.conf" ]];then
                if grep -iv "^\s*#" "$u64_ftp_root_setting_file" | grep -iqE  "^\s*RootLogin\s*on$";then
                    echo "$u64_ftp_root_setting_file ì—ì„œ root ê³„ì • ì ‘ì†ì„ í—ˆìš©í•˜ê³  ìžˆìŠµë‹ˆë‹¤.">> $target
                    echo "í˜„ìž¬ ì„¤ì •ê°’ : $(grep -i "RootLogin" "$u64_ftp_root_setting_file")">> $target
                    u64=$((u64+1))
                    u64_safe_check=$((u64_safe_check+1))
                else
                    echo "$u64_ftp_root_setting_file ì—ì„œ root ê³„ì • ì ‘ì†ì„ ì°¨ë‹¨ í•˜ê³  ìžˆìŠµë‹ˆë‹¤.">> $target
                    echo "í˜„ìž¬ ì„¤ì •ê°’ (ì¡´ìž¬í•  ê²½ìš° ì¶œë ¥): $(grep -i "RootLogin" "$u64_ftp_root_setting_file")">> $target
                fi
            else
                if grep -iv "^\s*#" "$u64_ftp_root_setting_file" | grep -iqE  "^\s*root$";then
                    echo "$u64_ftp_root_setting_file ì—ì„œ root ê³„ì • ì ‘ì†ì„ í—ˆìš©í•˜ê³  ìžˆìŠµë‹ˆë‹¤.">> $target
                    echo "í˜„ìž¬ ì„¤ì •ê°’ : $(grep -i "root" "$u64_ftp_root_setting_file")">> $target
                    u64=$((u64+1))
                    u64_safe_check=$((u64_safe_check+1))
                else
                    echo "$u64_ftp_root_setting_file ì—ì„œ root ê³„ì • ì ‘ì†ì„ ì°¨ë‹¨ í•˜ê³  ìžˆìŠµë‹ˆë‹¤.">> $target
                    echo "í˜„ìž¬ ì„¤ì •ê°’ (ì¡´ìž¬í•  ê²½ìš° ì¶œë ¥): $(grep -i "root" "$u64_ftp_root_setting_file")">> $target
                fi
            fi
        fi
    done
else
    echo "ftp ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    u64_safe_check=$((u64_safe_check+1))
fi
if [[ $u64_safe_check -ge 1 ]];then
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi

if [[ $u64 -ge 1 ]];then
    Mid=$((Mid+1))
    Service_Management=$((Service_Management+1))
    u64_Service_Management=1
fi