cat << EOF
===== [U-63] ftpersus file owner and permission settings              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-63 ftpusers íŒŒì¼ ì†Œìœ ìž ë° ê¶Œí•œ ì„¤ì •             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ë¹„ì¸ê°€ìžë“¤ì˜ ftp ì ‘ì†ì„ ì°¨ë‹¨í•˜ê¸° ìœ„í•´ ftpusers íŒŒì¼ ì†Œìœ ìž ë° ê¶Œí•œì„ ê´€ë¦¬í•´ì•¼í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ftpusers íŒŒì¼ì— ì¸ê°€ë˜ì§€ ì•Šì€ ì‚¬ìš©ìžë¥¼ ë“±ë¡í•˜ì—¬ í•´ë‹¹ ê³„ì •ì„ ì´ìš©, ë¶ˆë²•ì ì¸ FTP ì„œë¹„ìŠ¤ì— ì ‘ê·¼ì´ ê°€ëŠ¥í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜: ftpusers íŒŒì¼ì˜ ì†Œìœ ìžê°€ rootì´ê³ , ê¶Œí•œì´ 640 ì´í•˜ì¸ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: tpusers íŒŒì¼ì˜ ì†Œìœ ìžê°€ rootê°€ ì•„ë‹ˆê±°ë‚˜, ê¶Œí•œì´ 640 ì´í•˜ê°€ ì•„ë‹Œê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-63 ì ê²€ ê²°ê³¼" >> $result

u63=0
u63_safe_check=0
u63_Service_Management=0
u63_check_ftpfiles=("/etc/ftpusers" "/etc/ftpd/ftpusers" "/etc/vsftpd/ftpusers" "/etc/vsftpd/user_list" "/etc/vsftpd.user_list")
u63_safe_check=0
for u63_check_ftpfile in "${u63_check_ftpfiles[@]}";do
    if [ -e "$u63_check_ftpfile" ];then
        echo "$u63_check_ftpfile íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤."  >> $target
        u63_file_owner=$(stat -c "%U" "$u63_check_ftpfile" 2> /dev/null)
        u63_file_perm_user=$(stat -c "%a" "$u63_check_ftpfile" 2> /dev/null | cut -c1)
        u63_file_perm_group=$(stat -c "%a" "$u63_check_ftpfile" 2> /dev/null | cut -c2)
        u63_file_perm_other=$(stat -c "%a" "$u63_check_ftpfile" 2> /dev/null | cut -c3)
        if [[ "$u63_file_owner" == "root" ]];then
            echo "$u63_check_ftpfile íŒŒì¼ì˜ ì†Œìœ ìžê°€ rootë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤."  >> $target
            if [[ $u63_file_perm_user -le 6 ]];then
                echo "$u63_check_ftpfile íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤."  >> $target
                if [[ $u63_file_perm_group -le 4 ]];then
                    echo "$u63_check_ftpfile íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 4ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤."  >> $target
                    if [[ $u63_file_perm_other -eq 0 ]];then
                        echo "$u63_check_ftpfile íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ìž(Other)ì˜ ê¶Œí•œì´ 0ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤."  >> $target
                    else
                        echo "$u63_check_ftpfile íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ìž(Other)ì˜ ê¶Œí•œì´ 0ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤."  >> $target
                        u63_safe_check=$((u63_safe_check+1))
                    fi
                else
                    echo "$u63_check_ftpfile íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 4ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤."  >> $target
                    u63_safe_check=$((u63_safe_check+1))
                fi
            else
                echo "$u63_check_ftpfile íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤."  >> $target
                u63_safe_check=$((u63_safe_check+1))
            fi
        else
            echo "$u63_check_ftpfile íŒŒì¼ì˜ ì†Œìœ ìžê°€ rootê°€ ì•„ë‹Œ ë‹¤ë¥¸ ì‚¬ìš©ìžë¡œ ë˜ì–´ ìžˆìŠµë‹ˆë‹¤."  >> $target
            u63_safe_check=$((u63_safe_check+1))
        fi
    else
        echo "$u63_check_ftpfile íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."
    fi
done

if [[ $u63_safe_check -ge 1 ]];then
    u63=$((u63+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi

if [[ $u63 -ge 1 ]];then
    Low=$((Low+1))
    Service_Management=$((Service_Management+1))
    u62_Service_Management=1
fi