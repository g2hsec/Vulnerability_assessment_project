cat << EOF
===== [U-04] password file protection                 =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-04 íŒ¨ìŠ¤ì›Œë“œ íŒŒì¼ ë³´í˜¸                        " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ì¼ë¶€ ì˜¤ëž˜ëœ ì‹œìŠ¤í…œì˜ ê²½ìš° /etc/passwd íŒŒì¼ì— íŒ¨ìŠ¤ì›Œë“œê°€ í‰ë¬¸ìœ¼ë¡œ ì €ìž¥ë˜ë¯€ë¡œ ì‚¬ìš©ìž ê³„ì • íŒ¨ìŠ¤ì›Œë“œê°€ ì•”í˜¸í™”ë˜ì–´ ì €ìž¥ë˜ì–´ ìžˆëŠ”ì§€ ì ê²€í•˜ì—¬ ë¹„ì¸ê°€ìžì˜ íŒ¨ìŠ¤ì›Œë“œ íŒŒì¼ ì ‘ê·¼ ì‹œì—ë„ ì‚¬ìš©ìž ê³„ì • íŒ¨ìŠ¤ì›Œë“œê°€ ì•ˆì „í•˜ê²Œ ê´€ë¦¬ë˜ê³  ìžˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ì‚¬ìš©ìž ê³„ì • íŒ¨ìŠ¤ì›Œë“œê°€ ì €ìž¥ëœ íŒŒì¼ì´ ìœ ì¶œ ë˜ëŠ” íƒˆì·¨ ì‹œ í‰ë¬¸ìœ¼ë¡œ ì €ìž¥ëœíŒ¨ìŠ¤ì›Œë“œ ì •ë³´ê°€ ë…¸ì¶œë  ìˆ˜ ìžˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜: ì‰ë„ìš° íŒ¨ìŠ¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜, íŒ¨ìŠ¤ì›Œë“œë¥¼ ì•”í˜¸í™”í•˜ì—¬ ì €ìž¥í•˜ëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: ì‰ë„ìš° íŒ¨ìŠ¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³ , íŒ¨ìŠ¤ì›Œë“œë¥¼ ì•”í˜¸í™”í•˜ì—¬ ì €ìž¥í•˜ì§€ ì•ŠëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-4 ì ê²€ ê²°ê³¼" >> $result
u4=0
u4_safe_check=0
Files_Directory_Management=0
u4_Files_Directory_Management=0
if [ -e "/etc/passwd" ];then
    u4_check_encryption=$(cat "/etc/passwd" | awk -F':' '{print $2}' | grep -v 'x')
    u4_count_noencryption=$(cat "/etc/passwd" | awk -F':' '{print $2}' | grep -v 'x' | wc -l)
    if [[ -n $u4_check_encryption ]];then
        echo "passwd íŒŒì¼ ë‚´ì— íŒ¨ìŠ¤ì›Œë“œê°€ ì•”í˜¸í™” ì €ìž¥ì´ ì•„ë‹Œ í‰ë¬¸ìœ¼ë¡œ ì €ìž¥ëœ ê³„ì •ì´ $u4_count_noencryption ê°œ ì¡´ìž¬í•©ë‹ˆë‹¤." >> $target
        u4_safe_check=$((u4_safe_check+1))
        echo "$u4_check_encryption" | while IFS= read -r view_account; do
            echo "ì•”í˜¸í™” ë˜ì§€ ì•Šì€ ê³„ì • : $u4_view_account" >> "$target"
        done
    else
        echo "passwd íŒŒì¼ ë‚´ì— í‰ë¬¸ ì €ìž¥ëœ ê³„ì •ì€ í™•ì¸ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤." >> $target
    fi
    if [ -e "/etc/shadow" ];then
        u4_check_hash=$(cat /etc/shadow | awk -F':' '{print $2}')
        u4_unsafe_user=$(grep -vE '^([^:]+:(\*|\$y|\$5|\$6|\!|\!!))' /etc/shadow)
        u4_count_unsafe_user=$(grep -vE '^([^:]+:(\*|\$y|\$5|\$6|\!|\!!))' /etc/shadow | wc -l)
        if [[ $u4_count_unsafe_user -eq 0 ]];then
            echo "passwd íŒŒì¼ì´ ì¡´ìž¬í•˜ë©°, ëª¨ë“  ê³„ì •ì— ëŒ€í•œ íŒ¨ìŠ¤ì›Œë“œê°€ ì•”í˜¸í™” ë˜ì–´ ì•ˆì „í•˜ê²Œ shadow íŒŒì¼ì— ì €ìž¥ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
        else
            echo "shadow íŒŒì¼ ë‚´ì— íŒ¨ìŠ¤ì›Œë“œê°€ ì¡´ìž¬í•˜ì§€ ì•Šê±°ë‚˜ ì•ˆì „í•˜ì§€ ì•Šì€ í•´ì‹œ ì•Œê³ ë¥´ì§ìœ¼ë¡œ ì €ìž¥ëœ ê³„ì •ì´ ì¡´ìž¬í•©ë‹ˆë‹¤." >> $target
            echo "ì•ˆì „í•˜ì§€ ì•Šì€ ê³„ì • : $u4_count_unsafe" >> $target
            u4_safe_check=$((u4_safe_check+1))
        fi
    else
        echo "shadow íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•Šìœ¼ë©°, íŒ¨ìŠ¤ì›Œë“œ ì•”í˜¸í™”ê°€ ë˜ì–´ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        u4_safe_check=$((u4_safe_check+1))
    fi
fi


if [ $u4_safe_check -ge 1 ];then
    u4=$((u4+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u4 -ge 1 ]];then
    High=$((High+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u4_Files_Directory_Management=1
fi