cat << EOF
===== [U-33] DNS Security Version Patch              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-33 DNS ë³´ì•ˆ ë²„ì „ íŒ¨ì¹˜              " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : ì·¨ì•½ì ì´ ë°œí‘œë˜ì§€ ì•Šì€ BIND ë²„ì „ì˜ ì‚¬ìš©ì„ ëª©ì ìœ¼ë¡œ í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : ìµœì‹ ë²„ì „(2016.01 ê¸°ì¤€ 9.10.3-P2) ì´í•˜ì˜ ë²„ì „ì—ì„œëŠ” ì„œë¹„ìŠ¤ê±°ë¶€ ê³µê²©, ë²„í¼ì˜¤ë²„í”Œë¡œìš°(Buffer Overflow) ë° DNS ì„œë²„ ì›ê²© ì¹¨ìž… ë“±ì˜ ì·¨ì•½ì„±ì´ ì¡´ìž¬í•¨" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜: DNS ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê±°ë‚˜ ì£¼ê¸°ì ìœ¼ë¡œ íŒ¨ì¹˜ë¥¼ ê´€ë¦¬í•˜ê³  ìžˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: DNS ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©° ì£¼ê¸°ì ìœ¼ë¡œ íŒ¨ì¹˜ë¥¼ ê´€ë¦¬í•˜ê³  ìžˆì§€ ì•ŠëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
# Inverse Query ì·¨ì•½ì  (Buffer Overflow) : BIND 4.9.7ì´ì „ ë²„ì „ê³¼ BIND 8.1.2 ì´ì „ ë²„ì „
# NXTë²„ê·¸ (buffer overflow) : BIND 8.2, 8.2 p1, 8.2.1ë²„ì „

# solingerë²„ê·¸ (Denial of Service) : BIND 8.1 ì´ìƒë²„ì „
# fdmax ë²„ê·¸ (Denial of Service) : BIND 8.1 ì´ìƒë²„ì „
# Remote Execution of Code(Buffer Overflow) : BIND 4.9.5 to 4.9.10, 8.1, 8.2 to 8.2.6, 8.3.0 to 8.3.3 ë²„ì „
# Multiple Denial of Service: BIND 8.3.0 - 8.3.3, 8.2 - 8.2.6 ë²„ì „
# LIBRESOLV: buffer overrun(Buffer Overflow) : BIND 4.9.2 to 4.9.10 ë²„ì „
# OpenSSL (buffer overflow) : BIND 9.1, BIND 9.2 if built with OpenSSL(configure --with-openssl)
# libbind (buffer overflow) : BIND 4.9.11, 8.2.7, 8.3.4, 9.2.2 ì´ì™¸ì˜ ëª¨ë“  ë²„ì „
# DoS internal consistency check (Denial of Service) : BIND 9 ~ 9.2.0 ë²„ì „
# tsig bug (Access possible) : BIND 8.2 ~ 8.2.3 ë²„ì „
# complain bug (Stack corruption, possible remote access) : BIND 4.9.x ê±°ì˜ ëª¨ë“  ë²„ì „
# zxfr bug (Denial of service) : BIND 8.2.2, 8.2.2 patchlevels 1 through 6 ë²„ì „
# sigdiv0 bug (Denial of service) : BIND 8.2, 8.2 patchlevel 1, 8.2.2 ë²„ì „
# srv bug(Denial of service): BIND 8.2, 8.2 patchlevel 1, 8.2.1, 8.2.2, 8.2.2 patchlevels 1-6 ë²„ì „
# nxt bug (Access possible) : BIND 8.2, 8.2 patchlevel 1, 8.2.1 ë²„ì „

# BIND 4.9.8 ì´ì „ ë²„ì „, 8.2.3 ì´ì „ ë²„ì „ê³¼ ê´€ë ¨ëœ ì·¨ì•½ì 
# - TSIG í•¸ë“¤ë§ ë²„í¼ì˜¤ë²„í”Œë¡œìš° ì·¨ì•½ì 
# - nslookupComplain() ë²„í¼ì˜¤ë²„í”Œë¡œìš° ì·¨ì•½ì 
# - nslookupComplain() input validation ì·¨ì•½ì 
# - information leak ì·¨ì•½ì 
# - sig bug Denial of service ì·¨ì•½ì 
# - naptr bug Denial of service ì·¨ì•½ì 
# - maxdname bug Denial of service ì·¨ì•½ì 
u33=0
u33_Service_Management=0
u33_safe_check=0
u33_current_ver=$(dpkg -s bind9 | grep '^Version' | awk '{print $2}')
u33_latest_ver=$(apt-cache show bind9 | grep '^Version' | head -n 1 | awk '{print $2}')
u33_services=("named" "dnsmasq" "unbound" "pdns_server" "bind9.service" "pdns_server" "bind9" "dnsmasq.service" "unbound.service" "pdns.service")
u33_ports=("53" "853 " "443")

check_service_status "${u33_ports}" "${u33_services[@]}"
if [[ $? -eq 1 ]]; then
    echo "DNS ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìžˆìŠµë‹ˆë‹¤." >> $target
    if [[ "$u33_current_ver" == "$u33_latest_ver" ]];then
        echo "í˜„ìž¬ ì„¤ì¹˜ë˜ì–´ ìžˆëŠ” DNS(named) ì„œë¹„ìŠ¤ì˜ ë²„ì „ì´ ìµœì‹ ë²„ì „ê³¼ ì¼ì¹˜í•©ë‹ˆë‹¤." >> $target
        echo "í˜„ìž¬ ì„¤ì¹˜ë˜ì–´ ìžˆëŠ” DNS(named) ì„œë¹„ìŠ¤ ë²„ì „ : $U33_cuu33_current_verrrent_ver" >> $target
        echo "ìµœì‹  DNS(named) ì„œë¹„ìŠ¤ ë²„ì „ : $u33_latest_ver" >> $target
    else
        echo "í˜„ìž¬ ì„¤ì¹˜ë˜ì–´ ìžˆëŠ” DNS(named) ì„œë¹„ìŠ¤ì˜ ë²„ì „ì´ ìµœì‹ ë²„ì „ê³¼ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        echo "í˜„ìž¬ ì„¤ì¹˜ë˜ì–´ ìžˆëŠ” DNS(named) ì„œë¹„ìŠ¤ ë²„ì „ : $u33_current_ver" >> $target
        echo "ìµœì‹  DNS(named) ì„œë¹„ìŠ¤ ë²„ì „ : $u33_latest_ver" >> $target
        u33_safe_check=$((u33_safe_check+1))
    fi
    u33_safe_check=$((u33_safe_check+1))
else
    echo "DNS ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    if [[ "$u33_current_ver" == "$u33_latest_ver" ]];then
        echo "í˜„ìž¬ ì„¤ì¹˜ë˜ì–´ ìžˆëŠ” DNS(named) ì„œë¹„ìŠ¤ì˜ ë²„ì „ì´ ìµœì‹ ë²„ì „ê³¼ ì¼ì¹˜í•©ë‹ˆë‹¤." >> $target
        echo "í˜„ìž¬ ì„¤ì¹˜ë˜ì–´ ìžˆëŠ” DNS(named) ì„œë¹„ìŠ¤ ë²„ì „ : $U33_cuu33_current_verrrent_ver" >> $target
        echo "ìµœì‹  DNS(named) ì„œë¹„ìŠ¤ ë²„ì „ : $u33_latest_ver" >> $target
    else
        echo "í˜„ìž¬ ì„¤ì¹˜ë˜ì–´ ìžˆëŠ” DNS(named) ì„œë¹„ìŠ¤ì˜ ë²„ì „ì´ ìµœì‹ ë²„ì „ê³¼ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        echo "í˜„ìž¬ ì„¤ì¹˜ë˜ì–´ ìžˆëŠ” DNS(named) ì„œë¹„ìŠ¤ ë²„ì „ : $U33_cuu33_current_verrrent_ver" >> $target
        echo "ìµœì‹  DNS(named) ì„œë¹„ìŠ¤ ë²„ì „ : $u33_latest_ver" >> $target
        u33_safe_check=$((u33_safe_check+1))
    fi
fi

if [[ $u33_safe_check -ge 1 ]];then
    u33=$((u33+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u33 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u33_Service_Management=1
fi