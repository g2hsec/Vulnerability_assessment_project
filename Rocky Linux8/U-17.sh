    cat << EOF
===== [U-17] \$HOME/.rhosts, hosts.equiv disabled              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-17 \$HOME/.rhosts, hosts.equiv ì‚¬ìš© ê¸ˆì§€             " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : â€˜râ€™ command ì‚¬ìš©ì„ í†µí•œ ì›ê²© ì ‘ì†ì€ ì¸ì¦ ì—†ì´ ê´€ë¦¬ìž ì›ê²©ì ‘ì†ì´ ê°€ëŠ¥í•˜ë¯€ë¡œ ì„œë¹„ìŠ¤ í¬íŠ¸ë¥¼ ì°¨ë‹¨í•´ì•¼ í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ :  rlogin, rsh ë“±ê³¼ ê°™ì€ â€˜râ€™ commandì˜ ë³´ì•ˆ ì„¤ì •ì´ ì ìš©ë˜ì§€ ì•Šì€ ê²½ìš°, ì›ê²©ì§€ì˜ ê³µê²©ìžê°€ ê´€ë¦¬ìž ê¶Œí•œìœ¼ë¡œ ëª©í‘œ ì‹œìŠ¤í…œìƒì˜ ìž„ì˜ì˜ ëª…ë ¹ì„ ìˆ˜í–‰ì‹œí‚¬ìˆ˜ ìžˆìœ¼ë©°, ëª…ë ¹ì–´ ì›ê²© ì‹¤í–‰ì„ í†µí•´ ì¤‘ìš” ì •ë³´ ìœ ì¶œ ë° ì‹œìŠ¤í…œ ìž¥ì• ë¥¼ ìœ ë°œì‹œí‚¬ ìˆ˜ ìžˆìŒ. ë˜í•œ ê³µê²©ìž ë°±ë„ì–´ ë“±ìœ¼ë¡œë„ í™œìš©ë  ìˆ˜ ìžˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜:  login, shell, exec ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê±°ë‚˜, ì‚¬ìš© ì‹œ ì•„ëž˜ì™€ ê°™ì€ ì„¤ì •ì´ ì ìš©ëœ ê²½ìš°" >> $target
echo " 1. /etc/hosts.equiv ë° $HOME/.rhosts íŒŒì¼ ì†Œìœ ìžê°€ root ë˜ëŠ”, í•´ë‹¹ ê³„ì •ì¸ ê²½ìš°" >> $target
echo " 2. /etc/hosts.equiv ë° $HOME/.rhosts íŒŒì¼ ê¶Œí•œì´ 600 ì´í•˜ì¸ ê²½ìš°" >> $target
echo " 3. /etc/hosts.equiv ë° $HOME/.rhosts íŒŒì¼ ì„¤ì •ì— â€˜+â€™ ì„¤ì •ì´ ì—†ëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: ogin, shell, exec ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³ , ìœ„ì™€ ê°™ì€ ì„¤ì •ì´ ì ìš©ë˜ì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-17 ì ê²€ ê²°ê³¼" >> $result
u17_Files_Directory_Management=0
u17_safe_check=0
u17=0
u17_check_users=($(cat /etc/passwd | egrep -v 'nologin|sync|false' | awk -F':' '{print $1}'))
for u17_check_user in "${u17_check_users[@]}";do
    u17_user_home=($(getent passwd "$u17_check_user" | awk -F':' '{print$6}'))
    if [ -e "$u17_user_home/.rhosts" ];then
        u17_rhosts_owner=$(stat -c "%U" "$u17_user_home/.rhosts")
        if [[ "$u17_rhosts_owner" == "$u17_check_user" ||"$u17_rhosts_owner" == "root" ]];then
            echo "$u17_user_home/.rhosts íŒŒì¼ì˜ ì†Œìœ ìžê°€ rooë˜ëŠ” $u17_check_user ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
            u17_rhosts_perm=$(stat -c "%a" "$u17_user_home/.rhosts" | cut -c1)
            if [[ $u17_rhosts_perm -le 6 ]];then
                echo "$u17_user_home/.rhosts íŒŒì¼ì˜ ê¶Œí•œì´ 600ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
                if ! grep -qE "$u17_user_home/.rhosts";then
                    echo "$u17_user_home/.rhosts íŒŒì¼ì— + ì„¤ì •ì´ ë˜ì–´ìžˆì§€ ì•Šì•„ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
                else
                    echo "$u17_user_home/.rhosts íŒŒì¼ì— + ì„¤ì •ì´ ë˜ì–´ìžˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                    u17_safe_check=$((u17_safe_check+1))
                fi
            else
                echo "$u17_user_home/.rhosts íŒŒì¼ì˜ ê¶Œí•œì´ 600ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ì·¨ì•½í•©ë‹ˆë‹¤."  >> $target
                u17_safe_check=$((u17_safe_check+1))
            fi
        else
            echo "$u17_user_home/.rhostsíŒŒì¼ì˜ ì†Œìœ ìž‘ $u17_check_userë¡œ ì„¤ì •ë˜ì–´ ìžˆì§€ ì•Šì•„ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
            u17_safe_check=$((u17_safe_check+1))
        fi
    else
        echo "$u17_user_home/.rhosts íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
done
if [ -e "/etc/hosts.equiv" ];then
    u17_equivfile_owner=$(stat -c "%U" "/etc/hosts.equiv")
    if [[ "$u17_equivfile_owner" == "root" || "$u17_equivfile_owner" == "$u17_check_users" ]];then
        echo "/etc/hosts.equiv íŒŒì¼ì˜ ì†Œìœ ìžê°€ ë˜ëŠ”, í•´ë‹¹ ê³„ì •ìœ¼ë¡œ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
        u17_equivfile_perm=$(stat -c "%a" "/etc/hosts.equiv")
        if [[ $u17_equivfile_perm -le 600 ]];then
             echo "/etc/hosts.equiv íŒŒì¼ì˜ ê¶Œí•œì´ 600ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
            if ! grep -qE "etc/hosts.equiv";then
                echo "/etc/hosts íŒŒì¼ì— + ì„¤ì •ì´ ë˜ì–´ìžˆì§€ ì•Šì•„ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
            else
                echo "/etc/hosts íŒŒì¼ì— + ì„¤ì •ì´ ë˜ì–´ìžˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
                u17_safe_check=$((u17_safe_check+1))
            fi
        else
            echo "/etc/hosts.equiv íŒŒì¼ì˜ ê¶Œí•œì´ 600ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ì·¨ì•½í•©ë‹ˆë‹¤."  >> $target
            u17_safe_check=$((u17_safe_check+1))
        fi
    else
        echo "/etc/hosts.equiv íŒŒì¼ì˜ ì†Œìœ ìž‘ rootë¡œ ì„¤ì •ë˜ì–´ ìžˆì§€ ì•Šì•„ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
        u17_safe_check=$((u17_safe_check+1))
    fi
else
    echo "/etc/hosts.equiv íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

u17_service_checks=("login" "shell" "exec")
u17_service_count=0

for u17_service_check in "${u17_service_checks[@]}"; do
    if systemctl is-active --quiet "$u17_service_check"; then
        echo "login, shell, execì™€ ê°™ì€ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìžˆì–´ ì·¨ì•½í•©ë‹ˆë‹¤." >> $target
        u17_safe_check=$((u17_safe_check+1))
    else
        u17_service_count=$((u17_service_count+1))
    fi
done
if [[ $u17_service_count -ge 1 ]];then
    echo "login, shell, exec ì™€ ê°™ì€ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìžˆì§€ ì•Šì•„ ì–‘í˜¸í•©ë‹ˆë‹¤." >> $target
fi



if [[ $u17_safe_check -ge 1 ]];then
    u17=$((u17+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u17 -ge 1 ]];then
    High=$((High+1))
    Files_Directory_Management=$((Files_Directory_Management+1))
    u17_Files_Directory_Management=1
fi