cat << EOF
===== [U-27] Check RPC service              =====
=====                  Checking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-27 RPC ì„œë¹„ìŠ¤ í™•ì¸               " >> $target
echo "--------------------------------------------------------------------------" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "+ì ê²€ëª©ì  : ë‹¤ì–‘í•œ ì·¨ì•½ì„±(ë²„í¼ ì˜¤ë²„í”Œë¡œìš°, Dos, ì›ê²©ì‹¤í–‰ ë“±)ì´ ì¡´ìž¬í•˜ëŠ” RPC ì„œë¹„ìŠ¤ë¥¼ ì ê²€í•˜ì—¬ í•´ë‹¹ ì„œë¹„ìŠ¤ë¥¼ ë¹„í™œì„±í™” í•˜ë„ë¡ í•¨" >> $target
echo "+ë³´ì•ˆìœ„í˜‘ : ë²„í¼ ì˜¤ë²„í”Œë¡œìš°(Buffer Overflow), Dos, ì›ê²©ì‹¤í–‰ ë“±ì˜ ì·¨ì•½ì„±ì´ ì¡´ìž¬í•˜ëŠ” RPC ì„œë¹„ìŠ¤ë¥¼ í†µí•´ ë¹„ì¸ê°€ìžì˜ root ê¶Œí•œ íšë“ ë° ì¹¨í•´ì‚¬ê³  ë°œìƒ ìœ„í—˜ì´ ìžˆìœ¼ë¯€ë¡œ ì„œë¹„ìŠ¤ë¥¼ ì¤‘ì§€í•˜ì—¬ì•¼ " >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜: ë¶ˆí•„ìš”í•œ RPC ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„±í™” ë˜ì–´ ìžˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: ë¶ˆí•„ìš”í•œ RPC ì„œë¹„ìŠ¤ê°€ í™œì„±í™” ë˜ì–´ ìžˆëŠ” ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
u27=0
u27_Service_Management=0
u27_safe_check=0
u27_services=(
    "rpc.cmsd"
    "rpc.ttdbserverd"
    "sadmind"
    "rusersd"
    "walld"
    "sprayd"
    "rstatd"
    "rpc.nisd"
    "rexd"
    "rpc.pcnfsd"
    "rpc.statd"
    "rpc.ypupdated"
    "rpc.rquotad"
    "kcms_server"
    "cachefsd"
    "rpc.lockd"
    "rpc.mountd"
    "rpc.quotad"
    "rpc.smserverd"
    "rpc.vxid"
    "rpc.ypserv"
    "rpc.yppasswdd"
    "rpc.bootparamd"
)
u27_ports=("111" "512" "150001" "875" "2108" "20048")

check_service_status "${u27_ports}" "${u27_services[@]}"
if [ $? -eq 1 ]; then
    echo "ë¶ˆí•„ìš”í•œ RPC ì„œë¹„ìŠ¤ë¥¼  ì‚¬ìš©í•˜ê³  ìžˆìŠµë‹ˆë‹¤." >> $target
    u27_safe_check=$((u27_safe_check+1))
else
    echo "ë¶ˆí•„ìš”í•œ RPC ì„œë¹„ìŠ¤ë¥¼  ì‚¬ìš©í•˜ì§€ ì•Šê³  ìžˆìŠµë‹ˆë‹¤." >> $target
fi

if [[ $u27_safe_check -ge 1 ]];then
    u27=$((u27+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u27 -ge 1 ]];then
    High=$((High+1))
    Service_Management=$((Service_Management+1))
    u27_Service_Management=1
fi