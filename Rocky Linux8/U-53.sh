cat << EOF
===== [U-53] Check user shell              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-53 ì‚¬ìš©ì shell ì ê²€              " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ë¡œê·¸ì¸ì´ ë¶ˆí•„ìš”í•œ ê³„ì •ì— ì‰˜ ì„¤ì •ì„ ì œê±°í•˜ì—¬, ë¡œê·¸ì¸ì´ í•„ìš”í•˜ì§€ ì•Šì€ ê³„ì •ì„ í†µí•œ ì‹œìŠ¤í…œ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì§€ ëª»í•˜ê²Œ í•˜ê¸° ìœ„í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ë¡œê·¸ì¸ì´ ë¶ˆí•„ìš”í•œ ê³„ì •ì€ ì¼ë°˜ì ìœ¼ë¡œ OS ì„¤ì¹˜ ì‹œ ê¸°ë³¸ì ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ê³„ì •ìœ¼ë¡œ ì‰˜ì´ ì„¤ì •ë˜ì–´ ìˆì„ ê²½ìš°, ê³µê²©ìëŠ” ê¸°ë³¸ ê³„ì •ë“¤ì„ ì´ìš©í•˜ì—¬ ì‹œìŠ¤í…œì— ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰ í•  ìˆ˜ ìˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ğŸ”˜: ë¡œê·¸ì¸ì´ í•„ìš”í•˜ì§€ ì•Šì€ ê³„ì •ì— /bin/false(/sbin/nologin) ì‰˜ì´ ë¶€ì—¬ë˜ì–´ ìˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ğŸš«: ë¡œê·¸ì¸ì´ í•„ìš”í•˜ì§€ ì•Šì€ ê³„ì •ì— /bin/false(/sbin/nologin) ì‰˜ì´ ë¶€ì—¬ë˜ì§€ ì•Šì€ ê²½ìš°" >> $target
echo "+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++w+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
u53_Account_Management=0
u53_safe_check=0
u53=0

u53_passwd_lists=$(sudo awk -F: '($3 <= 999 || $3 >= 60000) && $1 != "root" {
    split($7, u53_path, "/");
    u53_shell = u53_path[length(u53_path)];
    if (u53_shell != "nologin" && u53_shell != "false" && u53_shell != "sync" && u53_shell != "shutdown" && u53_shell != "halt") {
        print $1, $7;
    }
}' /etc/passwd
)
u53_shadow_lists=$(awk -F: '($2 == "*" || $2 == "!!") {print $1}' /etc/shadow)

if [ -n "$u53_passwd_lists" ];then
    echo "ì¼ë°˜ ì‚¬ìš©ìê°€ ì•„ë‹Œ ê³„ì •ì— ëŒ€í•´ Shellì´ ë¶€ì—¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
    u53_safe_check=$((u53_safe_check+1))
    for u53_passwd_list in "${u53_passwd_lists[@]}";do
        echo "$u53_passwd_list" >> $target
    done
fi

readarray -t u53_user_list <<< "$u53_shadow_lists"
u53_result=""
u53_check='for u53_user in "${u53_user_list[@]}"; do
    u53_result+=$(awk -F: -v u53_user="$u53_user" '\''($1 == u53_user) {
        split($7, u53_path, "/");
        shell = u53_path[length(u53_path)];
        if (shell != "nologin" && shell != "false" && shell != "sync" && shell != "shutdown" && shell != "halt") {
            print $1, $7;
        }
    }'\'' /etc/passwd)
done'

if [[ ${#u53_user_list[@]} -gt 0 ]]; then
    eval "$u53_check"
    if [[ -n "$u53_result" ]]; then
        echo "íŒ¨ìŠ¤ì›Œë“œë¥¼ í•„ìš”ë¡œ í•˜ì§€ ì•ŠëŠ”, ê²©ë¦¬ëœ ê³„ì •ì— ëŒ€í•´ ì‰˜ì´ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤." >> $target
        u53_safe_check=$((u53_safe_check+1))
        echo "$u53_result" >> $target
    else
        echo "/etc/shadow íŒŒì¼ì—ì„œ ê²©ë¦¬ëœ ê³„ì •ì— ëŒ€í•´ ì „ë¶€ ì‰˜ì´ ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
    fi
else
    echo "'*' í˜¹ì€ '!!' ìœ¼ë¡œ ì„¤ì •ëœ ê³„ì •ì´ /etc/shadow íŒŒì¼ì— ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
fi

if [ $u53_safe_check -ge 1 ];then
    u53=$((u53+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u53 -ge 1 ]];then
    Low=$((Low+1))
    Account_Management=$((Account_Management+1))
    u53_Account_Management=1
fi