cat << EOF
===== [U-68] Provides a warning message when logged on              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-68 ë¡œê·¸ì˜¨ ì‹œ ê²½ê³  ë©”ì‹œì§€ ì œê³µ             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ë¹„ì¸ê°€ìžë“¤ì—ê²Œ ì„œë²„ì— ëŒ€í•œ ë¶ˆí•„ìš”í•œ ì •ë³´ë¥¼ ì œê³µí•˜ì§€ ì•Šê³ , ì„œë²„ ì ‘ì† ì‹œ ê´€ê³„ìžë§Œ ì ‘ì†í•´ì•¼ í•œë‹¤ëŠ” ê²½ê°ì‹¬ì„ ì‹¬ì–´ ì£¼ê¸°ìœ„í•´ ê²½ê³  ë©”ì‹œì§€ ì„¤ì •ì´ í•„ìš”í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : ë¡œê·¸ì¸ ë°°ë„ˆê°€ ì„¤ì •ë˜ì§€ ì•Šì„ ê²½ìš° ë°°ë„ˆì— ì„œë²„ OS ë²„ì „ ë° ì„œë¹„ìŠ¤ ë²„ì „ì´ ê³µê²©ìžì—ê²Œ ë…¸ì¶œë  ìˆ˜ ìžˆìœ¼ë©° ê³µê²©ìžëŠ” ì´ëŸ¬í•œ ì •ë³´ë¥¼ í†µí•˜ì—¬ í•´ë‹¹ OS ë° ì„œë¹„ìŠ¤ì˜ ì·¨ì•½ì ì„ ì´ìš©í•˜ì—¬ ê³µê²©ì„ ì‹œë„í•  ìˆ˜ ìžˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜: ì„œë²„ ë° Telnet, FTP, SMTP, DNS ì„œë¹„ìŠ¤ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì„¤ì •ë˜ì–´ ìžˆëŠ” ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: ì„œë²„ ë° Telnet, FTP, SMTP, DNS ì„œë¹„ìŠ¤ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì„¤ì •ë˜ì–´ ìžˆì§€ ì•Šì€ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $result
echo "U-68 ì ê²€ ê²°ê³¼" >> $result

u68_Service_Management=0
u68_safe_check=0
u68=0
u68_check_files=("motd" "inssue.net" "vsftpd.conf" "proftpd.conf" "main.cf" "sendmail.cf" "named.conf") 
u68_safe_check=0
for u68_check_file in "${u68_check_files[@]}";do
    u68_find_file=$(find / -type f -name "$u68_check_file" 2> /dev/null)
    if [ -e "$u68_find_file" ];then
        echo "$u68_find_file íŒŒì¼ì´ ì¡´ìž¬í•©ë‹ˆë‹¤." >> $target
        u68_file_name=$(basename "$u68_find_file")
        case $u68_file_name in
            "motd")
                if [[ $(wc -c < "$u68_find_file") -ge 1 ]];then
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                else
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ì–´ ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    u68_safe_check=$((u68_safe_check+1))
                fi
                ;;
            "inssue.net")
                if [[ $(wc -c < "$u68_find_file") -ge 1 ]];then
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                else
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ì–´ ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    u68_safe_check=$((u68_safe_check+1))
                fi
                ;;
            "vsftpd.conf")
                if grep -v "^\s*#" "$u68_find_file" | grep -iqE "^\s*ftpd_banner\s*=\s*.";then
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                else
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ì–´ ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    u68_safe_check=$((u68_safe_check+1))
                fi
                ;;
            "proftpd.conf")
                if grep -v "^\s*#" "$u68_find_file" | grep -iqE "^\s*ServerIdent\s*on\s*.";then
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                else
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ì–´ ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    u68_safe_check=$((u68_safe_check+1))
                fi                ;;
            "main.cf")
                if grep -v "^\s*#" "$u68_find_file" | grep -iqE "^\s*smtpd_banner\s*=\s*.";then
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                else
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ì–´ ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    u68_safe_check=$((u68_safe_check+1))
                fi 
                ;;
            "sendmail.cf")
                if grep -v "^\s*#" "$u68_find_file" | grep -iqE "^\s*O\s*SmtpGreetingMessage\s*=\s*.";then
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                else
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ì–´ ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    u68_safe_check=$((u68_safe_check+1))
                fi 
                ;;
            "named.conf")
                 if grep -q "logging" "$u68_find_file";then
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                else
                    echo "$u68_file_name íŒŒì¼ ë‚´ì— ë¡œê·¸ì˜¨ ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ì–´ ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
                    u68_safe_check=$((u68_safe_check+1))
                fi 
                ;;
            *)
                echo "í•´ë‹¹ íŒŒì¼ì€ ì¡´ìž¬í•˜ì§€ ì•ŠëŠ” íŒŒì¼ìž…ë‹ˆë‹¤.: $file" >> $target
                ;;
        esac
    fi
done
if [[ $u68_safe_check -ge 1 ]];then
    u68=$((u68+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u68 -ge 1 ]];then
    Low=$((Low+1))
    Service_Management=$((Service_Management+1))
    u68_Service_Management=1
fi
