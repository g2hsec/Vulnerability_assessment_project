cat << EOF
===== [U-65] Set at Service Permissions              =====
=====                  Chaking...........               =====
EOF
echo "--------------------------------------------------------------------------" >> $target
echo "                        U-65 at ì„œë¹„ìŠ¤ ê¶Œí•œ ì„¤ì •             " >> $target
echo "--------------------------------------------------------------------------"  >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "ì ê²€ëª©ì  : ê´€ë¦¬ìžì™¸ at ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë„ë¡ ì„¤ì •í•˜ê³  ìžˆëŠ”ì§€ ì ê²€í•˜ëŠ” ê²ƒì„ ëª©ì ìœ¼ë¡œ í•¨" >> $target
echo "ë³´ì•ˆìœ„í˜‘ : root ì™¸ ì¼ë°˜ì‚¬ìš©ìžì—ê²Œë„ at ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìžˆë„ë¡ í•  ê²½ìš°, ê³ ì˜ ë˜ëŠ” ì‹¤ìˆ˜ë¡œ ë¶ˆë²•ì ì¸ ì˜ˆì•½ íŒŒì¼ ì‹¤í–‰ìœ¼ë¡œ ì‹œìŠ¤í…œ í”¼í•´ë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ ìžˆìŒ" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì–‘í˜¸ ðŸ”˜: at ëª…ë ¹ì–´ ì¼ë°˜ì‚¬ìš©ìž ê¸ˆì§€ ë° at ê´€ë ¨ íŒŒì¼ 640 ì´í•˜ì¸ ê²½ìš°" >> $target
echo "+íŒë‹¨ê¸°ì¤€ ì·¨ì•½ ðŸš«: at ëª…ë ¹ì–´ ì¼ë°˜ì‚¬ìš©ìž ì‚¬ìš©ê°€ëŠ¥í•˜ê±°ë‚˜, at ê´€ë ¨ íŒŒì¼ 640 ì´ìƒì¸ ê²½ìš°" >> $target
echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++" >> $target
echo "" >> $target
echo "-------------" >> $resultw
echo "U-65 ì ê²€ ê²°ê³¼" >> $result

u65_Service_Management=0
u65=0
u65_path_at=$(which at)
u65_Other_at_perm=$(stat -c "%a" "$u65_path_at"  2> /dev/null| rev | cut -c1 | rev)
u65_at_files=("/etc/at.allow" "/etc/at.deny")
u65_safe_check=0
if [ -e "$u65_path_at" ];then
    if ! [[ $u65_Other_at_perm -eq 0 ]];then
        echo "at ëª…ë ¹ì–´ì— ëŒ€í•œ ê¸°íƒ€ ì‚¬ìš©ìž(Other)ì— ëŒ€í•œ ê¶Œí•œì´ ì£¼ì–´ì ¸ ìžˆìŠµë‹ˆë‹¤." >> $target
        u65=$((u65+1))
        u65_safe_check=$((u65_safe_check+1))
    else
        echo "at ëª…ë ¹ì–´ì— ëŒ€í•œ ê¸°íƒ€ ì‚¬ìš©ìž(Other)ì— ëŒ€í•œ ê¶Œí•œì´ ì£¼ì–´ì ¸ ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
        for u65_at_file in "${u65_at_files[@]}";do
            if [ -e "$u65_at_file" ];then
                echo "$u65_at_file ì´ ì¡´ìž¬í•©ë‹ˆë‹¤." >> $target
                u65_at_file_owner=$(stat -c "%a" "$u65_at_file"  2> /dev/null| cut -c1)
                u65_at_file_group=$(stat -c "%a" "$u65_at_file"  2> /dev/null| cut -c2)
                u65_at_file_other=$(stat -c "%a" "$u65_at_file"  2> /dev/null| cut -c3)
                u65_check_suid=$(stat -c "%a" "$u65_at_file"  2> /dev/null| tr -d '\n' | wc -c)
                if [[ $u65_check_suid -ge 4 ]];then
                    echo "$u65_at_file íŒŒì¼ì— SUID ê°€ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤. [ìž˜ëª»ëœ SUID ì„¤ì •]" >> $target
                    u65_safe_check=$((u65_safe_check+1))
                else
                    if [ $u65_at_file_owner -le 6 ];then
                        echo "$u65_at_file íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                        if [ $u65_at_file_group -le 4 ];then
                            echo "$u65_at_file íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 4ì´í•˜ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                            if [ $u65_at_file_other -eq 0 ];then
                                echo "$u65_at_file íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ìž(Other) ê¶Œí•œì´ 0ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                            else
                                echo "$u65_at_file íŒŒì¼ì˜ ê¸°íƒ€ ì‚¬ìš©ìž(Other) ê¶Œí•œì´ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                                u65_safe_check=$((u65_safe_check+1))
                            fi
                        else
                            ehco "$u65_at_file íŒŒì¼ì˜ ì†Œìœ  ê·¸ë£¹ ê¶Œí•œì´ 4ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                            u65_safe_check=$((u65_safe_check+1))
                        fi
                    else
                        echo "$u65_at_file íŒŒì¼ì˜ ì†Œìœ  ê¶Œí•œì´ 6ì´ìƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìžˆìŠµë‹ˆë‹¤." >> $target
                        u65_safe_check=$((u65_safe_check+1)) >> $target
                    fi
                fi
            else
                echo "$u65_at_file ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $target
            fi
        done
    fi
else
    echo "at ì‹¤í–‰íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."
fi

if [[ $u65_safe_check -ge 1 ]];then
    u65=$((u65+1))
    echo "ì ê²€ ê²°ê³¼ : ì·¨ì•½" >> $result
else
    echo "ì ê²€ ê²°ê³¼ : ì–‘í˜¸" >> $result
fi
if [[ $u65 -ge 1 ]];then
    Mid=$((Mid+1))
    Service_Management=$((Service_Management+1))
    u65_Service_Management=1
fi
